import"../chunks/DsnmJJEf.js";import{ag as bi,aL as wi,bp as xi,p as ne,aU as ut,u as _i,f as se,k as h,I as k,aR as Ce,b as W,c as oe,d as J,r as U,aS as st,bm as vt,a as ce,s as ee,t as ue,e as pe,aY as et,bg as Ir,i as Be,F as fe,x as K,bf as ve,J as Ei,aW as St,aF as Dr,aV as Pt,bd as Jn,H as ke,bq as be,aQ as uo,j as ct,aX as Ee,br as ki,$ as fo,E as Ci}from"../chunks/D-t3o9-t.js";import{g as Ni,a as He,C as $n,S as At,s as ie,b as je,c as at,d as Ie,M as Si,e as Rt,i as Pi}from"../chunks/DOuSsRy1.js";import{p as Z,r as Ke,i as he,b as pt,c as eo,s as Ue}from"../chunks/D0IjLCHJ.js";import{s as Ne,g as Tr,j as to,T as qt,k as Ft,t as Oi}from"../chunks/BcRQlmJM.js";import{i as Kt}from"../chunks/C5RtA5t1.js";import{a as xe,b as ho}from"../chunks/olZyHpJb.js";import{i as Mi}from"../chunks/BFOv5WST.js";const Ii=[];function zr(t,e=!1,o=!1){return Ct(t,new Map,"",Ii,null,o)}function Ct(t,e,o,n,s=null,i=!1){if(typeof t=="object"&&t!==null){var r=e.get(t);if(r!==void 0)return r;if(t instanceof Map)return new Map(t);if(t instanceof Set)return new Set(t);if(bi(t)){var l=Array(t.length);e.set(t,l),s!==null&&e.set(s,l);for(var c=0;c<t.length;c+=1){var d=t[c];c in t&&(l[c]=Ct(d,e,o,n,null,i))}return l}if(wi(t)===xi){l={},e.set(t,l),s!==null&&e.set(s,l);for(var a in t)l[a]=Ct(t[a],e,o,n,null,i);return l}if(t instanceof Date)return structuredClone(t);if(typeof t.toJSON=="function"&&!i)return Ct(t.toJSON(),e,o,n,t)}if(t instanceof EventTarget)return t;try{return structuredClone(t)}catch{return t}}var Yt,go;function no(){if(go)return Yt;go=1;var t="\0",e="\0",o="";class n{_isDirected=!0;_isMultigraph=!1;_isCompound=!1;_label;_defaultNodeLabelFn=()=>{};_defaultEdgeLabelFn=()=>{};_nodes={};_in={};_preds={};_out={};_sucs={};_edgeObjs={};_edgeLabels={};_nodeCount=0;_edgeCount=0;_parent;_children;constructor(a){a&&(this._isDirected=Object.hasOwn(a,"directed")?a.directed:!0,this._isMultigraph=Object.hasOwn(a,"multigraph")?a.multigraph:!1,this._isCompound=Object.hasOwn(a,"compound")?a.compound:!1),this._isCompound&&(this._parent={},this._children={},this._children[e]={})}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(a){return this._label=a,this}graph(){return this._label}setDefaultNodeLabel(a){return this._defaultNodeLabelFn=a,typeof a!="function"&&(this._defaultNodeLabelFn=()=>a),this}nodeCount(){return this._nodeCount}nodes(){return Object.keys(this._nodes)}sources(){var a=this;return this.nodes().filter(u=>Object.keys(a._in[u]).length===0)}sinks(){var a=this;return this.nodes().filter(u=>Object.keys(a._out[u]).length===0)}setNodes(a,u){var f=arguments,g=this;return a.forEach(function(b){f.length>1?g.setNode(b,u):g.setNode(b)}),this}setNode(a,u){return Object.hasOwn(this._nodes,a)?(arguments.length>1&&(this._nodes[a]=u),this):(this._nodes[a]=arguments.length>1?u:this._defaultNodeLabelFn(a),this._isCompound&&(this._parent[a]=e,this._children[a]={},this._children[e][a]=!0),this._in[a]={},this._preds[a]={},this._out[a]={},this._sucs[a]={},++this._nodeCount,this)}node(a){return this._nodes[a]}hasNode(a){return Object.hasOwn(this._nodes,a)}removeNode(a){var u=this;if(Object.hasOwn(this._nodes,a)){var f=g=>u.removeEdge(u._edgeObjs[g]);delete this._nodes[a],this._isCompound&&(this._removeFromParentsChildList(a),delete this._parent[a],this.children(a).forEach(function(g){u.setParent(g)}),delete this._children[a]),Object.keys(this._in[a]).forEach(f),delete this._in[a],delete this._preds[a],Object.keys(this._out[a]).forEach(f),delete this._out[a],delete this._sucs[a],--this._nodeCount}return this}setParent(a,u){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(u===void 0)u=e;else{u+="";for(var f=u;f!==void 0;f=this.parent(f))if(f===a)throw new Error("Setting "+u+" as parent of "+a+" would create a cycle");this.setNode(u)}return this.setNode(a),this._removeFromParentsChildList(a),this._parent[a]=u,this._children[u][a]=!0,this}_removeFromParentsChildList(a){delete this._children[this._parent[a]][a]}parent(a){if(this._isCompound){var u=this._parent[a];if(u!==e)return u}}children(a=e){if(this._isCompound){var u=this._children[a];if(u)return Object.keys(u)}else{if(a===e)return this.nodes();if(this.hasNode(a))return[]}}predecessors(a){var u=this._preds[a];if(u)return Object.keys(u)}successors(a){var u=this._sucs[a];if(u)return Object.keys(u)}neighbors(a){var u=this.predecessors(a);if(u){const g=new Set(u);for(var f of this.successors(a))g.add(f);return Array.from(g.values())}}isLeaf(a){var u;return this.isDirected()?u=this.successors(a):u=this.neighbors(a),u.length===0}filterNodes(a){var u=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});u.setGraph(this.graph());var f=this;Object.entries(this._nodes).forEach(function([_,y]){a(_)&&u.setNode(_,y)}),Object.values(this._edgeObjs).forEach(function(_){u.hasNode(_.v)&&u.hasNode(_.w)&&u.setEdge(_,f.edge(_))});var g={};function b(_){var y=f.parent(_);return y===void 0||u.hasNode(y)?(g[_]=y,y):y in g?g[y]:b(y)}return this._isCompound&&u.nodes().forEach(_=>u.setParent(_,b(_))),u}setDefaultEdgeLabel(a){return this._defaultEdgeLabelFn=a,typeof a!="function"&&(this._defaultEdgeLabelFn=()=>a),this}edgeCount(){return this._edgeCount}edges(){return Object.values(this._edgeObjs)}setPath(a,u){var f=this,g=arguments;return a.reduce(function(b,_){return g.length>1?f.setEdge(b,_,u):f.setEdge(b,_),_}),this}setEdge(){var a,u,f,g,b=!1,_=arguments[0];typeof _=="object"&&_!==null&&"v"in _?(a=_.v,u=_.w,f=_.name,arguments.length===2&&(g=arguments[1],b=!0)):(a=_,u=arguments[1],f=arguments[3],arguments.length>2&&(g=arguments[2],b=!0)),a=""+a,u=""+u,f!==void 0&&(f=""+f);var y=r(this._isDirected,a,u,f);if(Object.hasOwn(this._edgeLabels,y))return b&&(this._edgeLabels[y]=g),this;if(f!==void 0&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(a),this.setNode(u),this._edgeLabels[y]=b?g:this._defaultEdgeLabelFn(a,u,f);var w=l(this._isDirected,a,u,f);return a=w.v,u=w.w,Object.freeze(w),this._edgeObjs[y]=w,s(this._preds[u],a),s(this._sucs[a],u),this._in[u][y]=w,this._out[a][y]=w,this._edgeCount++,this}edge(a,u,f){var g=arguments.length===1?c(this._isDirected,arguments[0]):r(this._isDirected,a,u,f);return this._edgeLabels[g]}edgeAsObj(){const a=this.edge(...arguments);return typeof a!="object"?{label:a}:a}hasEdge(a,u,f){var g=arguments.length===1?c(this._isDirected,arguments[0]):r(this._isDirected,a,u,f);return Object.hasOwn(this._edgeLabels,g)}removeEdge(a,u,f){var g=arguments.length===1?c(this._isDirected,arguments[0]):r(this._isDirected,a,u,f),b=this._edgeObjs[g];return b&&(a=b.v,u=b.w,delete this._edgeLabels[g],delete this._edgeObjs[g],i(this._preds[u],a),i(this._sucs[a],u),delete this._in[u][g],delete this._out[a][g],this._edgeCount--),this}inEdges(a,u){var f=this._in[a];if(f){var g=Object.values(f);return u?g.filter(b=>b.v===u):g}}outEdges(a,u){var f=this._out[a];if(f){var g=Object.values(f);return u?g.filter(b=>b.w===u):g}}nodeEdges(a,u){var f=this.inEdges(a,u);if(f)return f.concat(this.outEdges(a,u))}}function s(d,a){d[a]?d[a]++:d[a]=1}function i(d,a){--d[a]||delete d[a]}function r(d,a,u,f){var g=""+a,b=""+u;if(!d&&g>b){var _=g;g=b,b=_}return g+o+b+o+(f===void 0?t:f)}function l(d,a,u,f){var g=""+a,b=""+u;if(!d&&g>b){var _=g;g=b,b=_}var y={v:g,w:b};return f&&(y.name=f),y}function c(d,a){return r(d,a.v,a.w,a.name)}return Yt=n,Yt}var Gt,mo;function Di(){return mo||(mo=1,Gt="2.2.4"),Gt}var Zt,vo;function Ti(){return vo||(vo=1,Zt={Graph:no(),version:Di()}),Zt}var Wt,po;function zi(){if(po)return Wt;po=1;var t=no();Wt={write:e,read:s};function e(i){var r={options:{directed:i.isDirected(),multigraph:i.isMultigraph(),compound:i.isCompound()},nodes:o(i),edges:n(i)};return i.graph()!==void 0&&(r.value=structuredClone(i.graph())),r}function o(i){return i.nodes().map(function(r){var l=i.node(r),c=i.parent(r),d={v:r};return l!==void 0&&(d.value=l),c!==void 0&&(d.parent=c),d})}function n(i){return i.edges().map(function(r){var l=i.edge(r),c={v:r.v,w:r.w};return r.name!==void 0&&(c.name=r.name),l!==void 0&&(c.value=l),c})}function s(i){var r=new t(i.options).setGraph(i.value);return i.nodes.forEach(function(l){r.setNode(l.v,l.value),l.parent&&r.setParent(l.v,l.parent)}),i.edges.forEach(function(l){r.setEdge({v:l.v,w:l.w,name:l.name},l.value)}),r}return Wt}var Xt,yo;function Ai(){if(yo)return Xt;yo=1,Xt=t;function t(e){var o={},n=[],s;function i(r){Object.hasOwn(o,r)||(o[r]=!0,s.push(r),e.successors(r).forEach(i),e.predecessors(r).forEach(i))}return e.nodes().forEach(function(r){s=[],i(r),s.length&&n.push(s)}),n}return Xt}var Ut,bo;function Ar(){if(bo)return Ut;bo=1;class t{_arr=[];_keyIndices={};size(){return this._arr.length}keys(){return this._arr.map(function(o){return o.key})}has(o){return Object.hasOwn(this._keyIndices,o)}priority(o){var n=this._keyIndices[o];if(n!==void 0)return this._arr[n].priority}min(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key}add(o,n){var s=this._keyIndices;if(o=String(o),!Object.hasOwn(s,o)){var i=this._arr,r=i.length;return s[o]=r,i.push({key:o,priority:n}),this._decrease(r),!0}return!1}removeMin(){this._swap(0,this._arr.length-1);var o=this._arr.pop();return delete this._keyIndices[o.key],this._heapify(0),o.key}decrease(o,n){var s=this._keyIndices[o];if(n>this._arr[s].priority)throw new Error("New priority is greater than current priority. Key: "+o+" Old: "+this._arr[s].priority+" New: "+n);this._arr[s].priority=n,this._decrease(s)}_heapify(o){var n=this._arr,s=2*o,i=s+1,r=o;s<n.length&&(r=n[s].priority<n[r].priority?s:r,i<n.length&&(r=n[i].priority<n[r].priority?i:r),r!==o&&(this._swap(o,r),this._heapify(r)))}_decrease(o){for(var n=this._arr,s=n[o].priority,i;o!==0&&(i=o>>1,!(n[i].priority<s));)this._swap(o,i),o=i}_swap(o,n){var s=this._arr,i=this._keyIndices,r=s[o],l=s[n];s[o]=l,s[n]=r,i[l.key]=o,i[r.key]=n}}return Ut=t,Ut}var Qt,wo;function Rr(){if(wo)return Qt;wo=1;var t=Ar();Qt=o;var e=()=>1;function o(s,i,r,l){return n(s,String(i),r||e,l||function(c){return s.outEdges(c)})}function n(s,i,r,l){var c={},d=new t,a,u,f=function(g){var b=g.v!==a?g.v:g.w,_=c[b],y=r(g),w=u.distance+y;if(y<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+g+" Weight: "+y);w<_.distance&&(_.distance=w,_.predecessor=a,d.decrease(b,w))};for(s.nodes().forEach(function(g){var b=g===i?0:Number.POSITIVE_INFINITY;c[g]={distance:b},d.add(g,b)});d.size()>0&&(a=d.removeMin(),u=c[a],u.distance!==Number.POSITIVE_INFINITY);)l(a).forEach(f);return c}return Qt}var Jt,xo;function Ri(){if(xo)return Jt;xo=1;var t=Rr();Jt=e;function e(o,n,s){return o.nodes().reduce(function(i,r){return i[r]=t(o,r,n,s),i},{})}return Jt}var $t,_o;function Lr(){if(_o)return $t;_o=1,$t=t;function t(e){var o=0,n=[],s={},i=[];function r(l){var c=s[l]={onStack:!0,lowlink:o,index:o++};if(n.push(l),e.successors(l).forEach(function(u){Object.hasOwn(s,u)?s[u].onStack&&(c.lowlink=Math.min(c.lowlink,s[u].index)):(r(u),c.lowlink=Math.min(c.lowlink,s[u].lowlink))}),c.lowlink===c.index){var d=[],a;do a=n.pop(),s[a].onStack=!1,d.push(a);while(l!==a);i.push(d)}}return e.nodes().forEach(function(l){Object.hasOwn(s,l)||r(l)}),i}return $t}var en,Eo;function Li(){if(Eo)return en;Eo=1;var t=Lr();en=e;function e(o){return t(o).filter(function(n){return n.length>1||n.length===1&&o.hasEdge(n[0],n[0])})}return en}var tn,ko;function Vi(){if(ko)return tn;ko=1,tn=e;var t=()=>1;function e(n,s,i){return o(n,s||t,i||function(r){return n.outEdges(r)})}function o(n,s,i){var r={},l=n.nodes();return l.forEach(function(c){r[c]={},r[c][c]={distance:0},l.forEach(function(d){c!==d&&(r[c][d]={distance:Number.POSITIVE_INFINITY})}),i(c).forEach(function(d){var a=d.v===c?d.w:d.v,u=s(d);r[c][a]={distance:u,predecessor:c}})}),l.forEach(function(c){var d=r[c];l.forEach(function(a){var u=r[a];l.forEach(function(f){var g=u[c],b=d[f],_=u[f],y=g.distance+b.distance;y<_.distance&&(_.distance=y,_.predecessor=b.predecessor)})})}),r}return tn}var nn,Co;function Vr(){if(Co)return nn;Co=1;function t(o){var n={},s={},i=[];function r(l){if(Object.hasOwn(s,l))throw new e;Object.hasOwn(n,l)||(s[l]=!0,n[l]=!0,o.predecessors(l).forEach(r),delete s[l],i.push(l))}if(o.sinks().forEach(r),Object.keys(n).length!==o.nodeCount())throw new e;return i}class e extends Error{constructor(){super(...arguments)}}return nn=t,t.CycleException=e,nn}var on,No;function Hi(){if(No)return on;No=1;var t=Vr();on=e;function e(o){try{t(o)}catch(n){if(n instanceof t.CycleException)return!1;throw n}return!0}return on}var rn,So;function Hr(){if(So)return rn;So=1,rn=t;function t(s,i,r){Array.isArray(i)||(i=[i]);var l=s.isDirected()?u=>s.successors(u):u=>s.neighbors(u),c=r==="post"?e:o,d=[],a={};return i.forEach(u=>{if(!s.hasNode(u))throw new Error("Graph does not have node: "+u);c(u,l,a,d)}),d}function e(s,i,r,l){for(var c=[[s,!1]];c.length>0;){var d=c.pop();d[1]?l.push(d[0]):Object.hasOwn(r,d[0])||(r[d[0]]=!0,c.push([d[0],!0]),n(i(d[0]),a=>c.push([a,!1])))}}function o(s,i,r,l){for(var c=[s];c.length>0;){var d=c.pop();Object.hasOwn(r,d)||(r[d]=!0,l.push(d),n(i(d),a=>c.push(a)))}}function n(s,i){for(var r=s.length;r--;)i(s[r],r,s);return s}return rn}var sn,Po;function ji(){if(Po)return sn;Po=1;var t=Hr();sn=e;function e(o,n){return t(o,n,"post")}return sn}var an,Oo;function Bi(){if(Oo)return an;Oo=1;var t=Hr();an=e;function e(o,n){return t(o,n,"pre")}return an}var ln,Mo;function qi(){if(Mo)return ln;Mo=1;var t=no(),e=Ar();ln=o;function o(n,s){var i=new t,r={},l=new e,c;function d(u){var f=u.v===c?u.w:u.v,g=l.priority(f);if(g!==void 0){var b=s(u);b<g&&(r[f]=c,l.decrease(f,b))}}if(n.nodeCount()===0)return i;n.nodes().forEach(function(u){l.add(u,Number.POSITIVE_INFINITY),i.setNode(u)}),l.decrease(n.nodes()[0],0);for(var a=!1;l.size()>0;){if(c=l.removeMin(),Object.hasOwn(r,c))i.setEdge(c,r[c]);else{if(a)throw new Error("Input graph is not connected: "+n);a=!0}n.nodeEdges(c).forEach(d)}return i}return ln}var dn,Io;function Fi(){return Io||(Io=1,dn={components:Ai(),dijkstra:Rr(),dijkstraAll:Ri(),findCycles:Li(),floydWarshall:Vi(),isAcyclic:Hi(),postorder:ji(),preorder:Bi(),prim:qi(),tarjan:Lr(),topsort:Vr()}),dn}var cn,Do;function Pe(){if(Do)return cn;Do=1;var t=Ti();return cn={Graph:t.Graph,json:zi(),alg:Fi(),version:t.version},cn}var un,To;function Ki(){if(To)return un;To=1;class t{constructor(){let s={};s._next=s._prev=s,this._sentinel=s}dequeue(){let s=this._sentinel,i=s._prev;if(i!==s)return e(i),i}enqueue(s){let i=this._sentinel;s._prev&&s._next&&e(s),s._next=i._next,i._next._prev=s,i._next=s,s._prev=i}toString(){let s=[],i=this._sentinel,r=i._prev;for(;r!==i;)s.push(JSON.stringify(r,o)),r=r._prev;return"["+s.join(", ")+"]"}}function e(n){n._prev._next=n._next,n._next._prev=n._prev,delete n._next,delete n._prev}function o(n,s){if(n!=="_next"&&n!=="_prev")return s}return un=t,un}var fn,zo;function Yi(){if(zo)return fn;zo=1;let t=Pe().Graph,e=Ki();fn=n;let o=()=>1;function n(d,a){if(d.nodeCount()<=1)return[];let u=r(d,a||o);return s(u.graph,u.buckets,u.zeroIdx).flatMap(g=>d.outEdges(g.v,g.w))}function s(d,a,u){let f=[],g=a[a.length-1],b=a[0],_;for(;d.nodeCount();){for(;_=b.dequeue();)i(d,a,u,_);for(;_=g.dequeue();)i(d,a,u,_);if(d.nodeCount()){for(let y=a.length-2;y>0;--y)if(_=a[y].dequeue(),_){f=f.concat(i(d,a,u,_,!0));break}}}return f}function i(d,a,u,f,g){let b=g?[]:void 0;return d.inEdges(f.v).forEach(_=>{let y=d.edge(_),w=d.node(_.v);g&&b.push({v:_.v,w:_.w}),w.out-=y,l(a,u,w)}),d.outEdges(f.v).forEach(_=>{let y=d.edge(_),w=_.w,p=d.node(w);p.in-=y,l(a,u,p)}),d.removeNode(f.v),b}function r(d,a){let u=new t,f=0,g=0;d.nodes().forEach(y=>{u.setNode(y,{v:y,in:0,out:0})}),d.edges().forEach(y=>{let w=u.edge(y.v,y.w)||0,p=a(y),O=w+p;u.setEdge(y.v,y.w,O),g=Math.max(g,u.node(y.v).out+=p),f=Math.max(f,u.node(y.w).in+=p)});let b=c(g+f+3).map(()=>new e),_=f+1;return u.nodes().forEach(y=>{l(b,_,u.node(y))}),{graph:u,buckets:b,zeroIdx:_}}function l(d,a,u){u.out?u.in?d[u.out-u.in+a].enqueue(u):d[d.length-1].enqueue(u):d[0].enqueue(u)}function c(d){const a=[];for(let u=0;u<d;u++)a.push(u);return a}return fn}var hn,Ao;function me(){if(Ao)return hn;Ao=1;let t=Pe().Graph;hn={addBorderNode:a,addDummyNode:e,applyWithChunking:g,asNonCompoundGraph:n,buildLayerMatrix:l,intersectRect:r,mapValues:S,maxRank:b,normalizeRanks:c,notime:w,partition:_,pick:T,predecessorWeights:i,range:x,removeEmptyRanks:d,simplify:o,successorWeights:s,time:y,uniqueId:O,zipObject:M};function e(E,C,z,R){for(var m=R;E.hasNode(m);)m=O(R);return z.dummy=C,E.setNode(m,z),m}function o(E){let C=new t().setGraph(E.graph());return E.nodes().forEach(z=>C.setNode(z,E.node(z))),E.edges().forEach(z=>{let R=C.edge(z.v,z.w)||{weight:0,minlen:1},m=E.edge(z);C.setEdge(z.v,z.w,{weight:R.weight+m.weight,minlen:Math.max(R.minlen,m.minlen)})}),C}function n(E){let C=new t({multigraph:E.isMultigraph()}).setGraph(E.graph());return E.nodes().forEach(z=>{E.children(z).length||C.setNode(z,E.node(z))}),E.edges().forEach(z=>{C.setEdge(z,E.edge(z))}),C}function s(E){let C=E.nodes().map(z=>{let R={};return E.outEdges(z).forEach(m=>{R[m.w]=(R[m.w]||0)+E.edge(m).weight}),R});return M(E.nodes(),C)}function i(E){let C=E.nodes().map(z=>{let R={};return E.inEdges(z).forEach(m=>{R[m.v]=(R[m.v]||0)+E.edge(m).weight}),R});return M(E.nodes(),C)}function r(E,C){let z=E.x,R=E.y,m=C.x-z,N=C.y-R,v=E.width/2,I=E.height/2;if(!m&&!N)throw new Error("Not possible to find intersection inside of the rectangle");let P,V;return Math.abs(N)*v>Math.abs(m)*I?(N<0&&(I=-I),P=I*m/N,V=I):(m<0&&(v=-v),P=v,V=v*N/m),{x:z+P,y:R+V}}function l(E){let C=x(b(E)+1).map(()=>[]);return E.nodes().forEach(z=>{let R=E.node(z),m=R.rank;m!==void 0&&(C[m][R.order]=z)}),C}function c(E){let C=E.nodes().map(R=>{let m=E.node(R).rank;return m===void 0?Number.MAX_VALUE:m}),z=g(Math.min,C);E.nodes().forEach(R=>{let m=E.node(R);Object.hasOwn(m,"rank")&&(m.rank-=z)})}function d(E){let C=E.nodes().map(v=>E.node(v).rank),z=g(Math.min,C),R=[];E.nodes().forEach(v=>{let I=E.node(v).rank-z;R[I]||(R[I]=[]),R[I].push(v)});let m=0,N=E.graph().nodeRankFactor;Array.from(R).forEach((v,I)=>{v===void 0&&I%N!==0?--m:v!==void 0&&m&&v.forEach(P=>E.node(P).rank+=m)})}function a(E,C,z,R){let m={width:0,height:0};return arguments.length>=4&&(m.rank=z,m.order=R),e(E,"border",m,C)}function u(E,C=f){const z=[];for(let R=0;R<E.length;R+=C){const m=E.slice(R,R+C);z.push(m)}return z}const f=65535;function g(E,C){if(C.length>f){const z=u(C);return E.apply(null,z.map(R=>E.apply(null,R)))}else return E.apply(null,C)}function b(E){const z=E.nodes().map(R=>{let m=E.node(R).rank;return m===void 0?Number.MIN_VALUE:m});return g(Math.max,z)}function _(E,C){let z={lhs:[],rhs:[]};return E.forEach(R=>{C(R)?z.lhs.push(R):z.rhs.push(R)}),z}function y(E,C){let z=Date.now();try{return C()}finally{console.log(E+" time: "+(Date.now()-z)+"ms")}}function w(E,C){return C()}let p=0;function O(E){var C=++p;return E+(""+C)}function x(E,C,z=1){C==null&&(C=E,E=0);let R=N=>N<C;z<0&&(R=N=>C<N);const m=[];for(let N=E;R(N);N+=z)m.push(N);return m}function T(E,C){const z={};for(const R of C)E[R]!==void 0&&(z[R]=E[R]);return z}function S(E,C){let z=C;return typeof C=="string"&&(z=R=>R[C]),Object.entries(E).reduce((R,[m,N])=>(R[m]=z(N,m),R),{})}function M(E,C){return E.reduce((z,R,m)=>(z[R]=C[m],z),{})}return hn}var gn,Ro;function Gi(){if(Ro)return gn;Ro=1;let t=Yi(),e=me().uniqueId;gn={run:o,undo:s};function o(i){(i.graph().acyclicer==="greedy"?t(i,l(i)):n(i)).forEach(c=>{let d=i.edge(c);i.removeEdge(c),d.forwardName=c.name,d.reversed=!0,i.setEdge(c.w,c.v,d,e("rev"))});function l(c){return d=>c.edge(d).weight}}function n(i){let r=[],l={},c={};function d(a){Object.hasOwn(c,a)||(c[a]=!0,l[a]=!0,i.outEdges(a).forEach(u=>{Object.hasOwn(l,u.w)?r.push(u):d(u.w)}),delete l[a])}return i.nodes().forEach(d),r}function s(i){i.edges().forEach(r=>{let l=i.edge(r);if(l.reversed){i.removeEdge(r);let c=l.forwardName;delete l.reversed,delete l.forwardName,i.setEdge(r.w,r.v,l,c)}})}return gn}var mn,Lo;function Zi(){if(Lo)return mn;Lo=1;let t=me();mn={run:e,undo:n};function e(s){s.graph().dummyChains=[],s.edges().forEach(i=>o(s,i))}function o(s,i){let r=i.v,l=s.node(r).rank,c=i.w,d=s.node(c).rank,a=i.name,u=s.edge(i),f=u.labelRank;if(d===l+1)return;s.removeEdge(i);let g,b,_;for(_=0,++l;l<d;++_,++l)u.points=[],b={width:0,height:0,edgeLabel:u,edgeObj:i,rank:l},g=t.addDummyNode(s,"edge",b,"_d"),l===f&&(b.width=u.width,b.height=u.height,b.dummy="edge-label",b.labelpos=u.labelpos),s.setEdge(r,g,{weight:u.weight},a),_===0&&s.graph().dummyChains.push(g),r=g;s.setEdge(r,c,{weight:u.weight},a)}function n(s){s.graph().dummyChains.forEach(i=>{let r=s.node(i),l=r.edgeLabel,c;for(s.setEdge(r.edgeObj,l);r.dummy;)c=s.successors(i)[0],s.removeNode(i),l.points.push({x:r.x,y:r.y}),r.dummy==="edge-label"&&(l.x=r.x,l.y=r.y,l.width=r.width,l.height=r.height),i=c,r=s.node(i)})}return mn}var vn,Vo;function Ot(){if(Vo)return vn;Vo=1;const{applyWithChunking:t}=me();vn={longestPath:e,slack:o};function e(n){var s={};function i(r){var l=n.node(r);if(Object.hasOwn(s,r))return l.rank;s[r]=!0;let c=n.outEdges(r).map(a=>a==null?Number.POSITIVE_INFINITY:i(a.w)-n.edge(a).minlen);var d=t(Math.min,c);return d===Number.POSITIVE_INFINITY&&(d=0),l.rank=d}n.sources().forEach(i)}function o(n,s){return n.node(s.w).rank-n.node(s.v).rank-n.edge(s).minlen}return vn}var pn,Ho;function jr(){if(Ho)return pn;Ho=1;var t=Pe().Graph,e=Ot().slack;pn=o;function o(r){var l=new t({directed:!1}),c=r.nodes()[0],d=r.nodeCount();l.setNode(c,{});for(var a,u;n(l,r)<d;)a=s(l,r),u=l.hasNode(a.v)?e(r,a):-e(r,a),i(l,r,u);return l}function n(r,l){function c(d){l.nodeEdges(d).forEach(a=>{var u=a.v,f=d===u?a.w:u;!r.hasNode(f)&&!e(l,a)&&(r.setNode(f,{}),r.setEdge(d,f,{}),c(f))})}return r.nodes().forEach(c),r.nodeCount()}function s(r,l){return l.edges().reduce((d,a)=>{let u=Number.POSITIVE_INFINITY;return r.hasNode(a.v)!==r.hasNode(a.w)&&(u=e(l,a)),u<d[0]?[u,a]:d},[Number.POSITIVE_INFINITY,null])[1]}function i(r,l,c){r.nodes().forEach(d=>l.node(d).rank+=c)}return pn}var yn,jo;function Wi(){if(jo)return yn;jo=1;var t=jr(),e=Ot().slack,o=Ot().longestPath,n=Pe().alg.preorder,s=Pe().alg.postorder,i=me().simplify;yn=r,r.initLowLimValues=a,r.initCutValues=l,r.calcCutValue=d,r.leaveEdge=f,r.enterEdge=g,r.exchangeEdges=b;function r(p){p=i(p),o(p);var O=t(p);a(O),l(O,p);for(var x,T;x=f(O);)T=g(O,p,x),b(O,p,x,T)}function l(p,O){var x=s(p,p.nodes());x=x.slice(0,x.length-1),x.forEach(T=>c(p,O,T))}function c(p,O,x){var T=p.node(x),S=T.parent;p.edge(x,S).cutvalue=d(p,O,x)}function d(p,O,x){var T=p.node(x),S=T.parent,M=!0,E=O.edge(x,S),C=0;return E||(M=!1,E=O.edge(S,x)),C=E.weight,O.nodeEdges(x).forEach(z=>{var R=z.v===x,m=R?z.w:z.v;if(m!==S){var N=R===M,v=O.edge(z).weight;if(C+=N?v:-v,y(p,x,m)){var I=p.edge(x,m).cutvalue;C+=N?-I:I}}}),C}function a(p,O){arguments.length<2&&(O=p.nodes()[0]),u(p,{},1,O)}function u(p,O,x,T,S){var M=x,E=p.node(T);return O[T]=!0,p.neighbors(T).forEach(C=>{Object.hasOwn(O,C)||(x=u(p,O,x,C,T))}),E.low=M,E.lim=x++,S?E.parent=S:delete E.parent,x}function f(p){return p.edges().find(O=>p.edge(O).cutvalue<0)}function g(p,O,x){var T=x.v,S=x.w;O.hasEdge(T,S)||(T=x.w,S=x.v);var M=p.node(T),E=p.node(S),C=M,z=!1;M.lim>E.lim&&(C=E,z=!0);var R=O.edges().filter(m=>z===w(p,p.node(m.v),C)&&z!==w(p,p.node(m.w),C));return R.reduce((m,N)=>e(O,N)<e(O,m)?N:m)}function b(p,O,x,T){var S=x.v,M=x.w;p.removeEdge(S,M),p.setEdge(T.v,T.w,{}),a(p),l(p,O),_(p,O)}function _(p,O){var x=p.nodes().find(S=>!O.node(S).parent),T=n(p,x);T=T.slice(1),T.forEach(S=>{var M=p.node(S).parent,E=O.edge(S,M),C=!1;E||(E=O.edge(M,S),C=!0),O.node(S).rank=O.node(M).rank+(C?E.minlen:-E.minlen)})}function y(p,O,x){return p.hasEdge(O,x)}function w(p,O,x){return x.low<=O.lim&&O.lim<=x.lim}return yn}var bn,Bo;function Xi(){if(Bo)return bn;Bo=1;var t=Ot(),e=t.longestPath,o=jr(),n=Wi();bn=s;function s(c){var d=c.graph().ranker;if(d instanceof Function)return d(c);switch(c.graph().ranker){case"network-simplex":l(c);break;case"tight-tree":r(c);break;case"longest-path":i(c);break;case"none":break;default:l(c)}}var i=e;function r(c){e(c),o(c)}function l(c){n(c)}return bn}var wn,qo;function Ui(){if(qo)return wn;qo=1,wn=t;function t(n){let s=o(n);n.graph().dummyChains.forEach(i=>{let r=n.node(i),l=r.edgeObj,c=e(n,s,l.v,l.w),d=c.path,a=c.lca,u=0,f=d[u],g=!0;for(;i!==l.w;){if(r=n.node(i),g){for(;(f=d[u])!==a&&n.node(f).maxRank<r.rank;)u++;f===a&&(g=!1)}if(!g){for(;u<d.length-1&&n.node(f=d[u+1]).minRank<=r.rank;)u++;f=d[u]}n.setParent(i,f),i=n.successors(i)[0]}})}function e(n,s,i,r){let l=[],c=[],d=Math.min(s[i].low,s[r].low),a=Math.max(s[i].lim,s[r].lim),u,f;u=i;do u=n.parent(u),l.push(u);while(u&&(s[u].low>d||a>s[u].lim));for(f=u,u=r;(u=n.parent(u))!==f;)c.push(u);return{path:l.concat(c.reverse()),lca:f}}function o(n){let s={},i=0;function r(l){let c=i;n.children(l).forEach(r),s[l]={low:c,lim:i++}}return n.children().forEach(r),s}return wn}var xn,Fo;function Qi(){if(Fo)return xn;Fo=1;let t=me();xn={run:e,cleanup:i};function e(r){let l=t.addDummyNode(r,"root",{},"_root"),c=n(r),d=Object.values(c),a=t.applyWithChunking(Math.max,d)-1,u=2*a+1;r.graph().nestingRoot=l,r.edges().forEach(g=>r.edge(g).minlen*=u);let f=s(r)+1;r.children().forEach(g=>o(r,l,u,f,a,c,g)),r.graph().nodeRankFactor=u}function o(r,l,c,d,a,u,f){let g=r.children(f);if(!g.length){f!==l&&r.setEdge(l,f,{weight:0,minlen:c});return}let b=t.addBorderNode(r,"_bt"),_=t.addBorderNode(r,"_bb"),y=r.node(f);r.setParent(b,f),y.borderTop=b,r.setParent(_,f),y.borderBottom=_,g.forEach(w=>{o(r,l,c,d,a,u,w);let p=r.node(w),O=p.borderTop?p.borderTop:w,x=p.borderBottom?p.borderBottom:w,T=p.borderTop?d:2*d,S=O!==x?1:a-u[f]+1;r.setEdge(b,O,{weight:T,minlen:S,nestingEdge:!0}),r.setEdge(x,_,{weight:T,minlen:S,nestingEdge:!0})}),r.parent(f)||r.setEdge(l,b,{weight:0,minlen:a+u[f]})}function n(r){var l={};function c(d,a){var u=r.children(d);u&&u.length&&u.forEach(f=>c(f,a+1)),l[d]=a}return r.children().forEach(d=>c(d,1)),l}function s(r){return r.edges().reduce((l,c)=>l+r.edge(c).weight,0)}function i(r){var l=r.graph();r.removeNode(l.nestingRoot),delete l.nestingRoot,r.edges().forEach(c=>{var d=r.edge(c);d.nestingEdge&&r.removeEdge(c)})}return xn}var _n,Ko;function Ji(){if(Ko)return _n;Ko=1;let t=me();_n=e;function e(n){function s(i){let r=n.children(i),l=n.node(i);if(r.length&&r.forEach(s),Object.hasOwn(l,"minRank")){l.borderLeft=[],l.borderRight=[];for(let c=l.minRank,d=l.maxRank+1;c<d;++c)o(n,"borderLeft","_bl",i,l,c),o(n,"borderRight","_br",i,l,c)}}n.children().forEach(s)}function o(n,s,i,r,l,c){let d={width:0,height:0,rank:c,borderType:s},a=l[s][c-1],u=t.addDummyNode(n,"border",d,i);l[s][c]=u,n.setParent(u,r),a&&n.setEdge(a,u,{weight:1})}return _n}var En,Yo;function $i(){if(Yo)return En;Yo=1,En={adjust:t,undo:e};function t(c){let d=c.graph().rankdir.toLowerCase();(d==="lr"||d==="rl")&&o(c)}function e(c){let d=c.graph().rankdir.toLowerCase();(d==="bt"||d==="rl")&&s(c),(d==="lr"||d==="rl")&&(r(c),o(c))}function o(c){c.nodes().forEach(d=>n(c.node(d))),c.edges().forEach(d=>n(c.edge(d)))}function n(c){let d=c.width;c.width=c.height,c.height=d}function s(c){c.nodes().forEach(d=>i(c.node(d))),c.edges().forEach(d=>{let a=c.edge(d);a.points.forEach(i),Object.hasOwn(a,"y")&&i(a)})}function i(c){c.y=-c.y}function r(c){c.nodes().forEach(d=>l(c.node(d))),c.edges().forEach(d=>{let a=c.edge(d);a.points.forEach(l),Object.hasOwn(a,"x")&&l(a)})}function l(c){let d=c.x;c.x=c.y,c.y=d}return En}var kn,Go;function es(){if(Go)return kn;Go=1;let t=me();kn=e;function e(o){let n={},s=o.nodes().filter(a=>!o.children(a).length),i=s.map(a=>o.node(a).rank),r=t.applyWithChunking(Math.max,i),l=t.range(r+1).map(()=>[]);function c(a){if(n[a])return;n[a]=!0;let u=o.node(a);l[u.rank].push(a),o.successors(a).forEach(c)}return s.sort((a,u)=>o.node(a).rank-o.node(u).rank).forEach(c),l}return kn}var Cn,Zo;function ts(){if(Zo)return Cn;Zo=1;let t=me().zipObject;Cn=e;function e(n,s){let i=0;for(let r=1;r<s.length;++r)i+=o(n,s[r-1],s[r]);return i}function o(n,s,i){let r=t(i,i.map((f,g)=>g)),l=s.flatMap(f=>n.outEdges(f).map(g=>({pos:r[g.w],weight:n.edge(g).weight})).sort((g,b)=>g.pos-b.pos)),c=1;for(;c<i.length;)c<<=1;let d=2*c-1;c-=1;let a=new Array(d).fill(0),u=0;return l.forEach(f=>{let g=f.pos+c;a[g]+=f.weight;let b=0;for(;g>0;)g%2&&(b+=a[g+1]),g=g-1>>1,a[g]+=f.weight;u+=f.weight*b}),u}return Cn}var Nn,Wo;function ns(){if(Wo)return Nn;Wo=1,Nn=t;function t(e,o=[]){return o.map(n=>{let s=e.inEdges(n);if(s.length){let i=s.reduce((r,l)=>{let c=e.edge(l),d=e.node(l.v);return{sum:r.sum+c.weight*d.order,weight:r.weight+c.weight}},{sum:0,weight:0});return{v:n,barycenter:i.sum/i.weight,weight:i.weight}}else return{v:n}})}return Nn}var Sn,Xo;function os(){if(Xo)return Sn;Xo=1;let t=me();Sn=e;function e(s,i){let r={};s.forEach((c,d)=>{let a=r[c.v]={indegree:0,in:[],out:[],vs:[c.v],i:d};c.barycenter!==void 0&&(a.barycenter=c.barycenter,a.weight=c.weight)}),i.edges().forEach(c=>{let d=r[c.v],a=r[c.w];d!==void 0&&a!==void 0&&(a.indegree++,d.out.push(r[c.w]))});let l=Object.values(r).filter(c=>!c.indegree);return o(l)}function o(s){let i=[];function r(c){return d=>{d.merged||(d.barycenter===void 0||c.barycenter===void 0||d.barycenter>=c.barycenter)&&n(c,d)}}function l(c){return d=>{d.in.push(c),--d.indegree===0&&s.push(d)}}for(;s.length;){let c=s.pop();i.push(c),c.in.reverse().forEach(r(c)),c.out.forEach(l(c))}return i.filter(c=>!c.merged).map(c=>t.pick(c,["vs","i","barycenter","weight"]))}function n(s,i){let r=0,l=0;s.weight&&(r+=s.barycenter*s.weight,l+=s.weight),i.weight&&(r+=i.barycenter*i.weight,l+=i.weight),s.vs=i.vs.concat(s.vs),s.barycenter=r/l,s.weight=l,s.i=Math.min(i.i,s.i),i.merged=!0}return Sn}var Pn,Uo;function rs(){if(Uo)return Pn;Uo=1;let t=me();Pn=e;function e(s,i){let r=t.partition(s,b=>Object.hasOwn(b,"barycenter")),l=r.lhs,c=r.rhs.sort((b,_)=>_.i-b.i),d=[],a=0,u=0,f=0;l.sort(n(!!i)),f=o(d,c,f),l.forEach(b=>{f+=b.vs.length,d.push(b.vs),a+=b.barycenter*b.weight,u+=b.weight,f=o(d,c,f)});let g={vs:d.flat(!0)};return u&&(g.barycenter=a/u,g.weight=u),g}function o(s,i,r){let l;for(;i.length&&(l=i[i.length-1]).i<=r;)i.pop(),s.push(l.vs),r++;return r}function n(s){return(i,r)=>i.barycenter<r.barycenter?-1:i.barycenter>r.barycenter?1:s?r.i-i.i:i.i-r.i}return Pn}var On,Qo;function is(){if(Qo)return On;Qo=1;let t=ns(),e=os(),o=rs();On=n;function n(r,l,c,d){let a=r.children(l),u=r.node(l),f=u?u.borderLeft:void 0,g=u?u.borderRight:void 0,b={};f&&(a=a.filter(p=>p!==f&&p!==g));let _=t(r,a);_.forEach(p=>{if(r.children(p.v).length){let O=n(r,p.v,c,d);b[p.v]=O,Object.hasOwn(O,"barycenter")&&i(p,O)}});let y=e(_,c);s(y,b);let w=o(y,d);if(f&&(w.vs=[f,w.vs,g].flat(!0),r.predecessors(f).length)){let p=r.node(r.predecessors(f)[0]),O=r.node(r.predecessors(g)[0]);Object.hasOwn(w,"barycenter")||(w.barycenter=0,w.weight=0),w.barycenter=(w.barycenter*w.weight+p.order+O.order)/(w.weight+2),w.weight+=2}return w}function s(r,l){r.forEach(c=>{c.vs=c.vs.flatMap(d=>l[d]?l[d].vs:d)})}function i(r,l){r.barycenter!==void 0?(r.barycenter=(r.barycenter*r.weight+l.barycenter*l.weight)/(r.weight+l.weight),r.weight+=l.weight):(r.barycenter=l.barycenter,r.weight=l.weight)}return On}var Mn,Jo;function ss(){if(Jo)return Mn;Jo=1;let t=Pe().Graph,e=me();Mn=o;function o(s,i,r){let l=n(s),c=new t({compound:!0}).setGraph({root:l}).setDefaultNodeLabel(d=>s.node(d));return s.nodes().forEach(d=>{let a=s.node(d),u=s.parent(d);(a.rank===i||a.minRank<=i&&i<=a.maxRank)&&(c.setNode(d),c.setParent(d,u||l),s[r](d).forEach(f=>{let g=f.v===d?f.w:f.v,b=c.edge(g,d),_=b!==void 0?b.weight:0;c.setEdge(g,d,{weight:s.edge(f).weight+_})}),Object.hasOwn(a,"minRank")&&c.setNode(d,{borderLeft:a.borderLeft[i],borderRight:a.borderRight[i]}))}),c}function n(s){for(var i;s.hasNode(i=e.uniqueId("_root")););return i}return Mn}var In,$o;function as(){if($o)return In;$o=1,In=t;function t(e,o,n){let s={},i;n.forEach(r=>{let l=e.parent(r),c,d;for(;l;){if(c=e.parent(l),c?(d=s[c],s[c]=l):(d=i,i=l),d&&d!==l){o.setEdge(d,l);return}l=c}})}return In}var Dn,er;function ls(){if(er)return Dn;er=1;let t=es(),e=ts(),o=is(),n=ss(),s=as(),i=Pe().Graph,r=me();Dn=l;function l(u,f){if(f&&typeof f.customOrder=="function"){f.customOrder(u,l);return}let g=r.maxRank(u),b=c(u,r.range(1,g+1),"inEdges"),_=c(u,r.range(g-1,-1,-1),"outEdges"),y=t(u);if(a(u,y),f&&f.disableOptimalOrderHeuristic)return;let w=Number.POSITIVE_INFINITY,p;for(let O=0,x=0;x<4;++O,++x){d(O%2?b:_,O%4>=2),y=r.buildLayerMatrix(u);let T=e(u,y);T<w&&(x=0,p=Object.assign({},y),w=T)}a(u,p)}function c(u,f,g){return f.map(function(b){return n(u,b,g)})}function d(u,f){let g=new i;u.forEach(function(b){let _=b.graph().root,y=o(b,_,g,f);y.vs.forEach((w,p)=>b.node(w).order=p),s(b,g,y.vs)})}function a(u,f){Object.values(f).forEach(g=>g.forEach((b,_)=>u.node(b).order=_))}return Dn}var Tn,tr;function ds(){if(tr)return Tn;tr=1;let t=Pe().Graph,e=me();Tn={positionX:g,findType1Conflicts:o,findType2Conflicts:n,addConflict:i,hasConflict:r,verticalAlignment:l,horizontalCompaction:c,alignCoordinates:u,findSmallestWidthAlignment:a,balance:f};function o(y,w){let p={};function O(x,T){let S=0,M=0,E=x.length,C=T[T.length-1];return T.forEach((z,R)=>{let m=s(y,z),N=m?y.node(m).order:E;(m||z===C)&&(T.slice(M,R+1).forEach(v=>{y.predecessors(v).forEach(I=>{let P=y.node(I),V=P.order;(V<S||N<V)&&!(P.dummy&&y.node(v).dummy)&&i(p,I,v)})}),M=R+1,S=N)}),T}return w.length&&w.reduce(O),p}function n(y,w){let p={};function O(T,S,M,E,C){let z;e.range(S,M).forEach(R=>{z=T[R],y.node(z).dummy&&y.predecessors(z).forEach(m=>{let N=y.node(m);N.dummy&&(N.order<E||N.order>C)&&i(p,m,z)})})}function x(T,S){let M=-1,E,C=0;return S.forEach((z,R)=>{if(y.node(z).dummy==="border"){let m=y.predecessors(z);m.length&&(E=y.node(m[0]).order,O(S,C,R,M,E),C=R,M=E)}O(S,C,S.length,E,T.length)}),S}return w.length&&w.reduce(x),p}function s(y,w){if(y.node(w).dummy)return y.predecessors(w).find(p=>y.node(p).dummy)}function i(y,w,p){if(w>p){let x=w;w=p,p=x}let O=y[w];O||(y[w]=O={}),O[p]=!0}function r(y,w,p){if(w>p){let O=w;w=p,p=O}return!!y[w]&&Object.hasOwn(y[w],p)}function l(y,w,p,O){let x={},T={},S={};return w.forEach(M=>{M.forEach((E,C)=>{x[E]=E,T[E]=E,S[E]=C})}),w.forEach(M=>{let E=-1;M.forEach(C=>{let z=O(C);if(z.length){z=z.sort((m,N)=>S[m]-S[N]);let R=(z.length-1)/2;for(let m=Math.floor(R),N=Math.ceil(R);m<=N;++m){let v=z[m];T[C]===C&&E<S[v]&&!r(p,C,v)&&(T[v]=C,T[C]=x[C]=x[v],E=S[v])}}})}),{root:x,align:T}}function c(y,w,p,O,x){let T={},S=d(y,w,p,x),M=x?"borderLeft":"borderRight";function E(R,m){let N=S.nodes(),v=N.pop(),I={};for(;v;)I[v]?R(v):(I[v]=!0,N.push(v),N=N.concat(m(v))),v=N.pop()}function C(R){T[R]=S.inEdges(R).reduce((m,N)=>Math.max(m,T[N.v]+S.edge(N)),0)}function z(R){let m=S.outEdges(R).reduce((v,I)=>Math.min(v,T[I.w]-S.edge(I)),Number.POSITIVE_INFINITY),N=y.node(R);m!==Number.POSITIVE_INFINITY&&N.borderType!==M&&(T[R]=Math.max(T[R],m))}return E(C,S.predecessors.bind(S)),E(z,S.successors.bind(S)),Object.keys(O).forEach(R=>T[R]=T[p[R]]),T}function d(y,w,p,O){let x=new t,T=y.graph(),S=b(T.nodesep,T.edgesep,O);return w.forEach(M=>{let E;M.forEach(C=>{let z=p[C];if(x.setNode(z),E){var R=p[E],m=x.edge(R,z);x.setEdge(R,z,Math.max(S(y,C,E),m||0))}E=C})}),x}function a(y,w){return Object.values(w).reduce((p,O)=>{let x=Number.NEGATIVE_INFINITY,T=Number.POSITIVE_INFINITY;Object.entries(O).forEach(([M,E])=>{let C=_(y,M)/2;x=Math.max(E+C,x),T=Math.min(E-C,T)});const S=x-T;return S<p[0]&&(p=[S,O]),p},[Number.POSITIVE_INFINITY,null])[1]}function u(y,w){let p=Object.values(w),O=e.applyWithChunking(Math.min,p),x=e.applyWithChunking(Math.max,p);["u","d"].forEach(T=>{["l","r"].forEach(S=>{let M=T+S,E=y[M];if(E===w)return;let C=Object.values(E),z=O-e.applyWithChunking(Math.min,C);S!=="l"&&(z=x-e.applyWithChunking(Math.max,C)),z&&(y[M]=e.mapValues(E,R=>R+z))})})}function f(y,w){return e.mapValues(y.ul,(p,O)=>{if(w)return y[w.toLowerCase()][O];{let x=Object.values(y).map(T=>T[O]).sort((T,S)=>T-S);return(x[1]+x[2])/2}})}function g(y){let w=e.buildLayerMatrix(y),p=Object.assign(o(y,w),n(y,w)),O={},x;["u","d"].forEach(S=>{x=S==="u"?w:Object.values(w).reverse(),["l","r"].forEach(M=>{M==="r"&&(x=x.map(R=>Object.values(R).reverse()));let E=(S==="u"?y.predecessors:y.successors).bind(y),C=l(y,x,p,E),z=c(y,x,C.root,C.align,M==="r");M==="r"&&(z=e.mapValues(z,R=>-R)),O[S+M]=z})});let T=a(y,O);return u(O,T),f(O,y.graph().align)}function b(y,w,p){return(O,x,T)=>{let S=O.node(x),M=O.node(T),E=0,C;if(E+=S.width/2,Object.hasOwn(S,"labelpos"))switch(S.labelpos.toLowerCase()){case"l":C=-S.width/2;break;case"r":C=S.width/2;break}if(C&&(E+=p?C:-C),C=0,E+=(S.dummy?w:y)/2,E+=(M.dummy?w:y)/2,E+=M.width/2,Object.hasOwn(M,"labelpos"))switch(M.labelpos.toLowerCase()){case"l":C=M.width/2;break;case"r":C=-M.width/2;break}return C&&(E+=p?C:-C),C=0,E}}function _(y,w){return y.node(w).width}return Tn}var zn,nr;function cs(){if(nr)return zn;nr=1;let t=me(),e=ds().positionX;zn=o;function o(s){s=t.asNonCompoundGraph(s),n(s),Object.entries(e(s)).forEach(([i,r])=>s.node(i).x=r)}function n(s){let i=t.buildLayerMatrix(s),r=s.graph().ranksep,l=0;i.forEach(c=>{const d=c.reduce((a,u)=>{const f=s.node(u).height;return a>f?a:f},0);c.forEach(a=>s.node(a).y=l+d/2),l+=d+r})}return zn}var An,or;function us(){if(or)return An;or=1;let t=Gi(),e=Zi(),o=Xi(),n=me().normalizeRanks,s=Ui(),i=me().removeEmptyRanks,r=Qi(),l=Ji(),c=$i(),d=ls(),a=cs(),u=me(),f=Pe().Graph;An=g;function g(D,A){let L=A&&A.debugTiming?u.time:u.notime;L("layout",()=>{let H=L("  buildLayoutGraph",()=>E(D));L("  runLayout",()=>b(H,L,A)),L("  updateInputGraph",()=>_(D,H))})}function b(D,A,L){A("    makeSpaceForEdgeLabels",()=>C(D)),A("    removeSelfEdges",()=>B(D)),A("    acyclic",()=>t.run(D)),A("    nestingGraph.run",()=>r.run(D)),A("    rank",()=>o(u.asNonCompoundGraph(D))),A("    injectEdgeLabelProxies",()=>z(D)),A("    removeEmptyRanks",()=>i(D)),A("    nestingGraph.cleanup",()=>r.cleanup(D)),A("    normalizeRanks",()=>n(D)),A("    assignRankMinMax",()=>R(D)),A("    removeEdgeLabelProxies",()=>m(D)),A("    normalize.run",()=>e.run(D)),A("    parentDummyChains",()=>s(D)),A("    addBorderSegments",()=>l(D)),A("    order",()=>d(D,L)),A("    insertSelfEdges",()=>j(D)),A("    adjustCoordinateSystem",()=>c.adjust(D)),A("    position",()=>a(D)),A("    positionSelfEdges",()=>q(D)),A("    removeBorderNodes",()=>V(D)),A("    normalize.undo",()=>e.undo(D)),A("    fixupEdgeLabelCoords",()=>I(D)),A("    undoCoordinateSystem",()=>c.undo(D)),A("    translateGraph",()=>N(D)),A("    assignNodeIntersects",()=>v(D)),A("    reversePoints",()=>P(D)),A("    acyclic.undo",()=>t.undo(D))}function _(D,A){D.nodes().forEach(L=>{let H=D.node(L),F=A.node(L);H&&(H.x=F.x,H.y=F.y,H.rank=F.rank,A.children(L).length&&(H.width=F.width,H.height=F.height))}),D.edges().forEach(L=>{let H=D.edge(L),F=A.edge(L);H.points=F.points,Object.hasOwn(F,"x")&&(H.x=F.x,H.y=F.y)}),D.graph().width=A.graph().width,D.graph().height=A.graph().height}let y=["nodesep","edgesep","ranksep","marginx","marginy"],w={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},p=["acyclicer","ranker","rankdir","align"],O=["width","height","rank"],x={width:0,height:0},T=["minlen","weight","width","height","labeloffset"],S={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},M=["labelpos"];function E(D){let A=new f({multigraph:!0,compound:!0}),L=X(D.graph());return A.setGraph(Object.assign({},w,Y(L,y),u.pick(L,p))),D.nodes().forEach(H=>{let F=X(D.node(H));const G=Y(F,O);Object.keys(x).forEach(Q=>{G[Q]===void 0&&(G[Q]=x[Q])}),A.setNode(H,G),A.setParent(H,D.parent(H))}),D.edges().forEach(H=>{let F=X(D.edge(H));A.setEdge(H,Object.assign({},S,Y(F,T),u.pick(F,M)))}),A}function C(D){let A=D.graph();A.ranksep/=2,D.edges().forEach(L=>{let H=D.edge(L);H.minlen*=2,H.labelpos.toLowerCase()!=="c"&&(A.rankdir==="TB"||A.rankdir==="BT"?H.width+=H.labeloffset:H.height+=H.labeloffset)})}function z(D){D.edges().forEach(A=>{let L=D.edge(A);if(L.width&&L.height){let H=D.node(A.v),G={rank:(D.node(A.w).rank-H.rank)/2+H.rank,e:A};u.addDummyNode(D,"edge-proxy",G,"_ep")}})}function R(D){let A=0;D.nodes().forEach(L=>{let H=D.node(L);H.borderTop&&(H.minRank=D.node(H.borderTop).rank,H.maxRank=D.node(H.borderBottom).rank,A=Math.max(A,H.maxRank))}),D.graph().maxRank=A}function m(D){D.nodes().forEach(A=>{let L=D.node(A);L.dummy==="edge-proxy"&&(D.edge(L.e).labelRank=L.rank,D.removeNode(A))})}function N(D){let A=Number.POSITIVE_INFINITY,L=0,H=Number.POSITIVE_INFINITY,F=0,G=D.graph(),Q=G.marginx||0,le=G.marginy||0;function ae(re){let te=re.x,ge=re.y,Te=re.width,Ae=re.height;A=Math.min(A,te-Te/2),L=Math.max(L,te+Te/2),H=Math.min(H,ge-Ae/2),F=Math.max(F,ge+Ae/2)}D.nodes().forEach(re=>ae(D.node(re))),D.edges().forEach(re=>{let te=D.edge(re);Object.hasOwn(te,"x")&&ae(te)}),A-=Q,H-=le,D.nodes().forEach(re=>{let te=D.node(re);te.x-=A,te.y-=H}),D.edges().forEach(re=>{let te=D.edge(re);te.points.forEach(ge=>{ge.x-=A,ge.y-=H}),Object.hasOwn(te,"x")&&(te.x-=A),Object.hasOwn(te,"y")&&(te.y-=H)}),G.width=L-A+Q,G.height=F-H+le}function v(D){D.edges().forEach(A=>{let L=D.edge(A),H=D.node(A.v),F=D.node(A.w),G,Q;L.points?(G=L.points[0],Q=L.points[L.points.length-1]):(L.points=[],G=F,Q=H),L.points.unshift(u.intersectRect(H,G)),L.points.push(u.intersectRect(F,Q))})}function I(D){D.edges().forEach(A=>{let L=D.edge(A);if(Object.hasOwn(L,"x"))switch((L.labelpos==="l"||L.labelpos==="r")&&(L.width-=L.labeloffset),L.labelpos){case"l":L.x-=L.width/2+L.labeloffset;break;case"r":L.x+=L.width/2+L.labeloffset;break}})}function P(D){D.edges().forEach(A=>{let L=D.edge(A);L.reversed&&L.points.reverse()})}function V(D){D.nodes().forEach(A=>{if(D.children(A).length){let L=D.node(A),H=D.node(L.borderTop),F=D.node(L.borderBottom),G=D.node(L.borderLeft[L.borderLeft.length-1]),Q=D.node(L.borderRight[L.borderRight.length-1]);L.width=Math.abs(Q.x-G.x),L.height=Math.abs(F.y-H.y),L.x=G.x+L.width/2,L.y=H.y+L.height/2}}),D.nodes().forEach(A=>{D.node(A).dummy==="border"&&D.removeNode(A)})}function B(D){D.edges().forEach(A=>{if(A.v===A.w){var L=D.node(A.v);L.selfEdges||(L.selfEdges=[]),L.selfEdges.push({e:A,label:D.edge(A)}),D.removeEdge(A)}})}function j(D){var A=u.buildLayerMatrix(D);A.forEach(L=>{var H=0;L.forEach((F,G)=>{var Q=D.node(F);Q.order=G+H,(Q.selfEdges||[]).forEach(le=>{u.addDummyNode(D,"selfedge",{width:le.label.width,height:le.label.height,rank:Q.rank,order:G+ ++H,e:le.e,label:le.label},"_se")}),delete Q.selfEdges})})}function q(D){D.nodes().forEach(A=>{var L=D.node(A);if(L.dummy==="selfedge"){var H=D.node(L.e.v),F=H.x+H.width/2,G=H.y,Q=L.x-F,le=H.height/2;D.setEdge(L.e,L.label),D.removeNode(A),L.label.points=[{x:F+2*Q/3,y:G-le},{x:F+5*Q/6,y:G-le},{x:F+Q,y:G},{x:F+5*Q/6,y:G+le},{x:F+2*Q/3,y:G+le}],L.label.x=L.x,L.label.y=L.y}})}function Y(D,A){return u.mapValues(u.pick(D,A),Number)}function X(D){var A={};return D&&Object.entries(D).forEach(([L,H])=>{typeof L=="string"&&(L=L.toLowerCase()),A[L]=H}),A}return An}var Rn,rr;function fs(){if(rr)return Rn;rr=1;let t=me(),e=Pe().Graph;Rn={debugOrdering:o};function o(n){let s=t.buildLayerMatrix(n),i=new e({compound:!0,multigraph:!0}).setGraph({});return n.nodes().forEach(r=>{i.setNode(r,{label:r}),i.setParent(r,"layer"+n.node(r).rank)}),n.edges().forEach(r=>i.setEdge(r.v,r.w,{},r.name)),s.forEach((r,l)=>{let c="layer"+l;i.setNode(c,{rank:"same"}),r.reduce((d,a)=>(i.setEdge(d,a,{style:"invis"}),a))}),i}return Rn}var Ln,ir;function hs(){return ir||(ir=1,Ln="1.1.5"),Ln}var Vn,sr;function gs(){return sr||(sr=1,Vn={graphlib:Pe(),layout:us(),debug:fs(),util:{time:me().time,notime:me().notime},version:hs()}),Vn}var ms=gs();const ar=Ni(ms);function vs(t){let e;for(;e=t.sourceEvent;)t=e;return t}function Me(t,e){if(t=vs(t),e===void 0&&(e=t.currentTarget),e){var o=e.ownerSVGElement||e;if(o.createSVGPoint){var n=o.createSVGPoint();return n.x=t.clientX,n.y=t.clientY,n=n.matrixTransform(e.getScreenCTM().inverse()),[n.x,n.y]}if(e.getBoundingClientRect){var s=e.getBoundingClientRect();return[t.clientX-s.left-e.clientLeft,t.clientY-s.top-e.clientTop]}}return[t.pageX,t.pageY]}const ps={passive:!1},ft={capture:!0,passive:!1};function Hn(t){t.stopImmediatePropagation()}function Je(t){t.preventDefault(),t.stopImmediatePropagation()}function Br(t){var e=t.document.documentElement,o=Ne(t).on("dragstart.drag",Je,ft);"onselectstart"in e?o.on("selectstart.drag",Je,ft):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function qr(t,e){var o=t.document.documentElement,n=Ne(t).on("dragstart.drag",null);e&&(n.on("click.drag",Je,ft),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in o?n.on("selectstart.drag",null):(o.style.MozUserSelect=o.__noselect,delete o.__noselect)}const xt=t=>()=>t;function Gn(t,{sourceEvent:e,subject:o,target:n,identifier:s,active:i,x:r,y:l,dx:c,dy:d,dispatch:a}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:o,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:r,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:d,enumerable:!0,configurable:!0},_:{value:a}})}Gn.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function ys(t){return!t.ctrlKey&&!t.button}function bs(){return this.parentNode}function ws(t,e){return e??{x:t.x,y:t.y}}function xs(){return navigator.maxTouchPoints||"ontouchstart"in this}function _s(){var t=ys,e=bs,o=ws,n=xs,s={},i=Tr("start","drag","end"),r=0,l,c,d,a,u=0;function f(x){x.on("mousedown.drag",g).filter(n).on("touchstart.drag",y).on("touchmove.drag",w,ps).on("touchend.drag touchcancel.drag",p).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(x,T){if(!(a||!t.call(this,x,T))){var S=O(this,e.call(this,x,T),x,T,"mouse");S&&(Ne(x.view).on("mousemove.drag",b,ft).on("mouseup.drag",_,ft),Br(x.view),Hn(x),d=!1,l=x.clientX,c=x.clientY,S("start",x))}}function b(x){if(Je(x),!d){var T=x.clientX-l,S=x.clientY-c;d=T*T+S*S>u}s.mouse("drag",x)}function _(x){Ne(x.view).on("mousemove.drag mouseup.drag",null),qr(x.view,d),Je(x),s.mouse("end",x)}function y(x,T){if(t.call(this,x,T)){var S=x.changedTouches,M=e.call(this,x,T),E=S.length,C,z;for(C=0;C<E;++C)(z=O(this,M,x,T,S[C].identifier,S[C]))&&(Hn(x),z("start",x,S[C]))}}function w(x){var T=x.changedTouches,S=T.length,M,E;for(M=0;M<S;++M)(E=s[T[M].identifier])&&(Je(x),E("drag",x,T[M]))}function p(x){var T=x.changedTouches,S=T.length,M,E;for(a&&clearTimeout(a),a=setTimeout(function(){a=null},500),M=0;M<S;++M)(E=s[T[M].identifier])&&(Hn(x),E("end",x,T[M]))}function O(x,T,S,M,E,C){var z=i.copy(),R=Me(C||S,T),m,N,v;if((v=o.call(x,new Gn("beforestart",{sourceEvent:S,target:f,identifier:E,active:r,x:R[0],y:R[1],dx:0,dy:0,dispatch:z}),M))!=null)return m=v.x-R[0]||0,N=v.y-R[1]||0,function I(P,V,B){var j=R,q;switch(P){case"start":s[E]=I,q=r++;break;case"end":delete s[E],--r;case"drag":R=Me(B||V,T),q=r;break}z.call(P,x,new Gn(P,{sourceEvent:V,subject:v,target:f,identifier:E,active:q,x:R[0]+m,y:R[1]+N,dx:R[0]-j[0],dy:R[1]-j[1],dispatch:z}),M)}}return f.filter=function(x){return arguments.length?(t=typeof x=="function"?x:xt(!!x),f):t},f.container=function(x){return arguments.length?(e=typeof x=="function"?x:xt(x),f):e},f.subject=function(x){return arguments.length?(o=typeof x=="function"?x:xt(x),f):o},f.touchable=function(x){return arguments.length?(n=typeof x=="function"?x:xt(!!x),f):n},f.on=function(){var x=i.on.apply(i,arguments);return x===i?f:x},f.clickDistance=function(x){return arguments.length?(u=(x=+x)*x,f):Math.sqrt(u)},f}var Es=1e-12;function lr(t){return((t=Math.exp(t))+1/t)/2}function ks(t){return((t=Math.exp(t))-1/t)/2}function Cs(t){return((t=Math.exp(2*t))-1)/(t+1)}const Nt=(function t(e,o,n){function s(i,r){var l=i[0],c=i[1],d=i[2],a=r[0],u=r[1],f=r[2],g=a-l,b=u-c,_=g*g+b*b,y,w;if(_<Es)w=Math.log(f/d)/e,y=function(M){return[l+M*g,c+M*b,d*Math.exp(e*M*w)]};else{var p=Math.sqrt(_),O=(f*f-d*d+n*_)/(2*d*o*p),x=(f*f-d*d-n*_)/(2*f*o*p),T=Math.log(Math.sqrt(O*O+1)-O),S=Math.log(Math.sqrt(x*x+1)-x);w=(S-T)/e,y=function(M){var E=M*w,C=lr(T),z=d/(o*p)*(C*Cs(e*E+T)-ks(T));return[l+z*g,c+z*b,d*C/lr(e*E+T)]}}return y.duration=w*1e3*e/Math.SQRT2,y}return s.rho=function(i){var r=Math.max(.001,+i),l=r*r,c=l*l;return t(r,l,c)},s})(Math.SQRT2,2,4),_t=t=>()=>t;function Ns(t,{sourceEvent:e,target:o,transform:n,dispatch:s}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:s}})}function jn(t){t.stopImmediatePropagation()}function dt(t){t.preventDefault(),t.stopImmediatePropagation()}function Ss(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function Ps(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function dr(){return this.__zoom||to}function Os(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Ms(){return navigator.maxTouchPoints||"ontouchstart"in this}function Is(t,e,o){var n=t.invertX(e[0][0])-o[0][0],s=t.invertX(e[1][0])-o[1][0],i=t.invertY(e[0][1])-o[0][1],r=t.invertY(e[1][1])-o[1][1];return t.translate(s>n?(n+s)/2:Math.min(0,n)||Math.max(0,s),r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r))}function Ds(){var t=Ss,e=Ps,o=Is,n=Os,s=Ms,i=[0,1/0],r=[[-1/0,-1/0],[1/0,1/0]],l=250,c=Nt,d=Tr("start","zoom","end"),a,u,f,g=500,b=150,_=0,y=10;function w(v){v.property("__zoom",dr).on("wheel.zoom",E,{passive:!1}).on("mousedown.zoom",C).on("dblclick.zoom",z).filter(s).on("touchstart.zoom",R).on("touchmove.zoom",m).on("touchend.zoom touchcancel.zoom",N).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}w.transform=function(v,I,P,V){var B=v.selection?v.selection():v;B.property("__zoom",dr),v!==B?T(v,I,P,V):B.interrupt().each(function(){S(this,arguments).event(V).start().zoom(null,typeof I=="function"?I.apply(this,arguments):I).end()})},w.scaleBy=function(v,I,P,V){w.scaleTo(v,function(){var B=this.__zoom.k,j=typeof I=="function"?I.apply(this,arguments):I;return B*j},P,V)},w.scaleTo=function(v,I,P,V){w.transform(v,function(){var B=e.apply(this,arguments),j=this.__zoom,q=P==null?x(B):typeof P=="function"?P.apply(this,arguments):P,Y=j.invert(q),X=typeof I=="function"?I.apply(this,arguments):I;return o(O(p(j,X),q,Y),B,r)},P,V)},w.translateBy=function(v,I,P,V){w.transform(v,function(){return o(this.__zoom.translate(typeof I=="function"?I.apply(this,arguments):I,typeof P=="function"?P.apply(this,arguments):P),e.apply(this,arguments),r)},null,V)},w.translateTo=function(v,I,P,V,B){w.transform(v,function(){var j=e.apply(this,arguments),q=this.__zoom,Y=V==null?x(j):typeof V=="function"?V.apply(this,arguments):V;return o(to.translate(Y[0],Y[1]).scale(q.k).translate(typeof I=="function"?-I.apply(this,arguments):-I,typeof P=="function"?-P.apply(this,arguments):-P),j,r)},V,B)};function p(v,I){return I=Math.max(i[0],Math.min(i[1],I)),I===v.k?v:new qt(I,v.x,v.y)}function O(v,I,P){var V=I[0]-P[0]*v.k,B=I[1]-P[1]*v.k;return V===v.x&&B===v.y?v:new qt(v.k,V,B)}function x(v){return[(+v[0][0]+ +v[1][0])/2,(+v[0][1]+ +v[1][1])/2]}function T(v,I,P,V){v.on("start.zoom",function(){S(this,arguments).event(V).start()}).on("interrupt.zoom end.zoom",function(){S(this,arguments).event(V).end()}).tween("zoom",function(){var B=this,j=arguments,q=S(B,j).event(V),Y=e.apply(B,j),X=P==null?x(Y):typeof P=="function"?P.apply(B,j):P,D=Math.max(Y[1][0]-Y[0][0],Y[1][1]-Y[0][1]),A=B.__zoom,L=typeof I=="function"?I.apply(B,j):I,H=c(A.invert(X).concat(D/A.k),L.invert(X).concat(D/L.k));return function(F){if(F===1)F=L;else{var G=H(F),Q=D/G[2];F=new qt(Q,X[0]-G[0]*Q,X[1]-G[1]*Q)}q.zoom(null,F)}})}function S(v,I,P){return!P&&v.__zooming||new M(v,I)}function M(v,I){this.that=v,this.args=I,this.active=0,this.sourceEvent=null,this.extent=e.apply(v,I),this.taps=0}M.prototype={event:function(v){return v&&(this.sourceEvent=v),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(v,I){return this.mouse&&v!=="mouse"&&(this.mouse[1]=I.invert(this.mouse[0])),this.touch0&&v!=="touch"&&(this.touch0[1]=I.invert(this.touch0[0])),this.touch1&&v!=="touch"&&(this.touch1[1]=I.invert(this.touch1[0])),this.that.__zoom=I,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(v){var I=Ne(this.that).datum();d.call(v,this.that,new Ns(v,{sourceEvent:this.sourceEvent,target:w,transform:this.that.__zoom,dispatch:d}),I)}};function E(v,...I){if(!t.apply(this,arguments))return;var P=S(this,I).event(v),V=this.__zoom,B=Math.max(i[0],Math.min(i[1],V.k*Math.pow(2,n.apply(this,arguments)))),j=Me(v);if(P.wheel)(P.mouse[0][0]!==j[0]||P.mouse[0][1]!==j[1])&&(P.mouse[1]=V.invert(P.mouse[0]=j)),clearTimeout(P.wheel);else{if(V.k===B)return;P.mouse=[j,V.invert(j)],Ft(this),P.start()}dt(v),P.wheel=setTimeout(q,b),P.zoom("mouse",o(O(p(V,B),P.mouse[0],P.mouse[1]),P.extent,r));function q(){P.wheel=null,P.end()}}function C(v,...I){if(f||!t.apply(this,arguments))return;var P=v.currentTarget,V=S(this,I,!0).event(v),B=Ne(v.view).on("mousemove.zoom",X,!0).on("mouseup.zoom",D,!0),j=Me(v,P),q=v.clientX,Y=v.clientY;Br(v.view),jn(v),V.mouse=[j,this.__zoom.invert(j)],Ft(this),V.start();function X(A){if(dt(A),!V.moved){var L=A.clientX-q,H=A.clientY-Y;V.moved=L*L+H*H>_}V.event(A).zoom("mouse",o(O(V.that.__zoom,V.mouse[0]=Me(A,P),V.mouse[1]),V.extent,r))}function D(A){B.on("mousemove.zoom mouseup.zoom",null),qr(A.view,V.moved),dt(A),V.event(A).end()}}function z(v,...I){if(t.apply(this,arguments)){var P=this.__zoom,V=Me(v.changedTouches?v.changedTouches[0]:v,this),B=P.invert(V),j=P.k*(v.shiftKey?.5:2),q=o(O(p(P,j),V,B),e.apply(this,I),r);dt(v),l>0?Ne(this).transition().duration(l).call(T,q,V,v):Ne(this).call(w.transform,q,V,v)}}function R(v,...I){if(t.apply(this,arguments)){var P=v.touches,V=P.length,B=S(this,I,v.changedTouches.length===V).event(v),j,q,Y,X;for(jn(v),q=0;q<V;++q)Y=P[q],X=Me(Y,this),X=[X,this.__zoom.invert(X),Y.identifier],B.touch0?!B.touch1&&B.touch0[2]!==X[2]&&(B.touch1=X,B.taps=0):(B.touch0=X,j=!0,B.taps=1+!!a);a&&(a=clearTimeout(a)),j&&(B.taps<2&&(u=X[0],a=setTimeout(function(){a=null},g)),Ft(this),B.start())}}function m(v,...I){if(this.__zooming){var P=S(this,I).event(v),V=v.changedTouches,B=V.length,j,q,Y,X;for(dt(v),j=0;j<B;++j)q=V[j],Y=Me(q,this),P.touch0&&P.touch0[2]===q.identifier?P.touch0[0]=Y:P.touch1&&P.touch1[2]===q.identifier&&(P.touch1[0]=Y);if(q=P.that.__zoom,P.touch1){var D=P.touch0[0],A=P.touch0[1],L=P.touch1[0],H=P.touch1[1],F=(F=L[0]-D[0])*F+(F=L[1]-D[1])*F,G=(G=H[0]-A[0])*G+(G=H[1]-A[1])*G;q=p(q,Math.sqrt(F/G)),Y=[(D[0]+L[0])/2,(D[1]+L[1])/2],X=[(A[0]+H[0])/2,(A[1]+H[1])/2]}else if(P.touch0)Y=P.touch0[0],X=P.touch0[1];else return;P.zoom("touch",o(O(q,Y,X),P.extent,r))}}function N(v,...I){if(this.__zooming){var P=S(this,I).event(v),V=v.changedTouches,B=V.length,j,q;for(jn(v),f&&clearTimeout(f),f=setTimeout(function(){f=null},g),j=0;j<B;++j)q=V[j],P.touch0&&P.touch0[2]===q.identifier?delete P.touch0:P.touch1&&P.touch1[2]===q.identifier&&delete P.touch1;if(P.touch1&&!P.touch0&&(P.touch0=P.touch1,delete P.touch1),P.touch0)P.touch0[1]=this.__zoom.invert(P.touch0[0]);else if(P.end(),P.taps===2&&(q=Me(q,this),Math.hypot(u[0]-q[0],u[1]-q[1])<y)){var Y=Ne(this).on("dblclick.zoom");Y&&Y.apply(this,arguments)}}}return w.wheelDelta=function(v){return arguments.length?(n=typeof v=="function"?v:_t(+v),w):n},w.filter=function(v){return arguments.length?(t=typeof v=="function"?v:_t(!!v),w):t},w.touchable=function(v){return arguments.length?(s=typeof v=="function"?v:_t(!!v),w):s},w.extent=function(v){return arguments.length?(e=typeof v=="function"?v:_t([[+v[0][0],+v[0][1]],[+v[1][0],+v[1][1]]]),w):e},w.scaleExtent=function(v){return arguments.length?(i[0]=+v[0],i[1]=+v[1],w):[i[0],i[1]]},w.translateExtent=function(v){return arguments.length?(r[0][0]=+v[0][0],r[1][0]=+v[1][0],r[0][1]=+v[0][1],r[1][1]=+v[1][1],w):[[r[0][0],r[0][1]],[r[1][0],r[1][1]]]},w.constrain=function(v){return arguments.length?(o=v,w):o},w.duration=function(v){return arguments.length?(l=+v,w):l},w.interpolate=function(v){return arguments.length?(c=v,w):c},w.on=function(){var v=d.on.apply(d,arguments);return v===d?w:v},w.clickDistance=function(v){return arguments.length?(_=(v=+v)*v,w):Math.sqrt(_)},w.tapDistance=function(v){return arguments.length?(y=+v,w):y},w}const ht={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:t=>`Node type "${t}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:t=>`The old edge with id=${t} does not exist.`,error009:t=>`Marker type "${t}" doesn't exist.`,error008:(t,{id:e,sourceHandle:o,targetHandle:n})=>`Couldn't create edge for ${t} handle id: "${t==="source"?o:n}", edge id: ${e}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:t=>`Edge type "${t}" not found. Using fallback type "default".`,error012:t=>`Node with id "${t}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(t="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${t}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},Zn=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Fr=["Enter"," ","Escape"],Ts={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:t,x:e,y:o})=>`Moved selected node ${t}. New position, x: ${e}, y: ${o}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var tt;(function(t){t.Strict="strict",t.Loose="loose"})(tt||(tt={}));var $e;(function(t){t.Free="free",t.Vertical="vertical",t.Horizontal="horizontal"})($e||($e={}));var Mt;(function(t){t.Partial="partial",t.Full="full"})(Mt||(Mt={}));const Wn={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var Le;(function(t){t.Bezier="default",t.Straight="straight",t.Step="step",t.SmoothStep="smoothstep",t.SimpleBezier="simplebezier"})(Le||(Le={}));var nt;(function(t){t.Arrow="arrow",t.ArrowClosed="arrowclosed"})(nt||(nt={}));var $;(function(t){t.Left="left",t.Top="top",t.Right="right",t.Bottom="bottom"})($||($={}));const cr={[$.Left]:$.Right,[$.Right]:$.Left,[$.Top]:$.Bottom,[$.Bottom]:$.Top};function zs(t,e){if(!t&&!e)return!0;if(!t||!e||t.size!==e.size)return!1;if(!t.size&&!e.size)return!0;for(const o of t.keys())if(!e.has(o))return!1;return!0}function ur(t,e,o){if(!o)return;const n=[];t.forEach((s,i)=>{e?.has(i)||n.push(s)}),n.length&&o(n)}function As(t){return t===null?null:t?"valid":"invalid"}const Kr=t=>"id"in t&&"source"in t&&"target"in t,Rs=t=>"id"in t&&"position"in t&&!("source"in t)&&!("target"in t),oo=t=>"id"in t&&"internals"in t&&!("source"in t)&&!("target"in t),yt=(t,e=[0,0])=>{const{width:o,height:n}=Ye(t),s=t.origin??e,i=o*s[0],r=n*s[1];return{x:t.position.x-i,y:t.position.y-r}},Ls=(t,e={nodeOrigin:[0,0]})=>{if(t.length===0)return{x:0,y:0,width:0,height:0};const o=t.reduce((n,s)=>{const i=typeof s=="string";let r=!e.nodeLookup&&!i?s:void 0;e.nodeLookup&&(r=i?e.nodeLookup.get(s):oo(s)?s:e.nodeLookup.get(s.id));const l=r?It(r,e.nodeOrigin):{x:0,y:0,x2:0,y2:0};return Vt(n,l)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Ht(o)},Lt=(t,e={})=>{let o={x:1/0,y:1/0,x2:-1/0,y2:-1/0},n=!1;return t.forEach(s=>{(e.filter===void 0||e.filter(s))&&(o=Vt(o,It(s)),n=!0)}),n?Ht(o):{x:0,y:0,width:0,height:0}},ro=(t,e,[o,n,s]=[0,0,1],i=!1,r=!1)=>{const l={...wt(e,[o,n,s]),width:e.width/s,height:e.height/s},c=[];for(const d of t.values()){const{measured:a,selectable:u=!0,hidden:f=!1}=d;if(r&&!u||f)continue;const g=a.width??d.width??d.initialWidth??null,b=a.height??d.height??d.initialHeight??null,_=gt(l,rt(d)),y=(g??0)*(b??0),w=i&&_>0;(!d.internals.handleBounds||w||_>=y||d.dragging)&&c.push(d)}return c},Vs=(t,e)=>{const o=new Set;return t.forEach(n=>{o.add(n.id)}),e.filter(n=>o.has(n.source)||o.has(n.target))};function Hs(t,e){const o=new Map,n=e?.nodes?new Set(e.nodes.map(s=>s.id)):null;return t.forEach(s=>{s.measured.width&&s.measured.height&&(e?.includeHiddenNodes||!s.hidden)&&(!n||n.has(s.id))&&o.set(s.id,s)}),o}async function js({nodes:t,width:e,height:o,panZoom:n,minZoom:s,maxZoom:i},r){if(t.size===0)return Promise.resolve(!0);const l=Hs(t,r),c=Lt(l),d=io(c,e,o,r?.minZoom??s,r?.maxZoom??i,r?.padding??.1);return await n.setViewport(d,{duration:r?.duration,ease:r?.ease,interpolate:r?.interpolate}),Promise.resolve(!0)}function Yr({nodeId:t,nextPosition:e,nodeLookup:o,nodeOrigin:n=[0,0],nodeExtent:s,onError:i}){const r=o.get(t),l=r.parentId?o.get(r.parentId):void 0,{x:c,y:d}=l?l.internals.positionAbsolute:{x:0,y:0},a=r.origin??n;let u=r.extent||s;if(r.extent==="parent"&&!r.expandParent)if(!l)i?.("005",ht.error005());else{const g=l.measured.width,b=l.measured.height;g&&b&&(u=[[c,d],[c+g,d+b]])}else l&&it(r.extent)&&(u=[[r.extent[0][0]+c,r.extent[0][1]+d],[r.extent[1][0]+c,r.extent[1][1]+d]]);const f=it(u)?qe(e,u,r.measured):e;return(r.measured.width===void 0||r.measured.height===void 0)&&i?.("015",ht.error015()),{position:{x:f.x-c+(r.measured.width??0)*a[0],y:f.y-d+(r.measured.height??0)*a[1]},positionAbsolute:f}}async function Bs({nodesToRemove:t=[],edgesToRemove:e=[],nodes:o,edges:n,onBeforeDelete:s}){const i=new Set(t.map(f=>f.id)),r=[];for(const f of o){if(f.deletable===!1)continue;const g=i.has(f.id),b=!g&&f.parentId&&r.find(_=>_.id===f.parentId);(g||b)&&r.push(f)}const l=new Set(e.map(f=>f.id)),c=n.filter(f=>f.deletable!==!1),a=Vs(r,c);for(const f of c)l.has(f.id)&&!a.find(b=>b.id===f.id)&&a.push(f);if(!s)return{edges:a,nodes:r};const u=await s({nodes:r,edges:a});return typeof u=="boolean"?u?{edges:a,nodes:r}:{edges:[],nodes:[]}:u}const ot=(t,e=0,o=1)=>Math.min(Math.max(t,e),o),qe=(t={x:0,y:0},e,o)=>({x:ot(t.x,e[0][0],e[1][0]-(o?.width??0)),y:ot(t.y,e[0][1],e[1][1]-(o?.height??0))});function Gr(t,e,o){const{width:n,height:s}=Ye(o),{x:i,y:r}=o.internals.positionAbsolute;return qe(t,[[i,r],[i+n,r+s]],e)}const fr=(t,e,o)=>t<e?ot(Math.abs(t-e),1,e)/e:t>o?-ot(Math.abs(t-o),1,e)/e:0,Zr=(t,e,o=15,n=40)=>{const s=fr(t.x,n,e.width-n)*o,i=fr(t.y,n,e.height-n)*o;return[s,i]},Vt=(t,e)=>({x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x2,e.x2),y2:Math.max(t.y2,e.y2)}),Xn=({x:t,y:e,width:o,height:n})=>({x:t,y:e,x2:t+o,y2:e+n}),Ht=({x:t,y:e,x2:o,y2:n})=>({x:t,y:e,width:o-t,height:n-e}),rt=(t,e=[0,0])=>{const{x:o,y:n}=oo(t)?t.internals.positionAbsolute:yt(t,e);return{x:o,y:n,width:t.measured?.width??t.width??t.initialWidth??0,height:t.measured?.height??t.height??t.initialHeight??0}},It=(t,e=[0,0])=>{const{x:o,y:n}=oo(t)?t.internals.positionAbsolute:yt(t,e);return{x:o,y:n,x2:o+(t.measured?.width??t.width??t.initialWidth??0),y2:n+(t.measured?.height??t.height??t.initialHeight??0)}},qs=(t,e)=>Ht(Vt(Xn(t),Xn(e))),gt=(t,e)=>{const o=Math.max(0,Math.min(t.x+t.width,e.x+e.width)-Math.max(t.x,e.x)),n=Math.max(0,Math.min(t.y+t.height,e.y+e.height)-Math.max(t.y,e.y));return Math.ceil(o*n)},hr=t=>ze(t.width)&&ze(t.height)&&ze(t.x)&&ze(t.y),ze=t=>!isNaN(t)&&isFinite(t),Fs=(t,e)=>{},bt=(t,e=[1,1])=>({x:e[0]*Math.round(t.x/e[0]),y:e[1]*Math.round(t.y/e[1])}),wt=({x:t,y:e},[o,n,s],i=!1,r=[1,1])=>{const l={x:(t-o)/s,y:(e-n)/s};return i?bt(l,r):l},Dt=({x:t,y:e},[o,n,s])=>({x:t*s+o,y:e*s+n});function Xe(t,e){if(typeof t=="number")return Math.floor((e-e/(1+t))*.5);if(typeof t=="string"&&t.endsWith("px")){const o=parseFloat(t);if(!Number.isNaN(o))return Math.floor(o)}if(typeof t=="string"&&t.endsWith("%")){const o=parseFloat(t);if(!Number.isNaN(o))return Math.floor(e*o*.01)}return console.error(`[React Flow] The padding value "${t}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function Ks(t,e,o){if(typeof t=="string"||typeof t=="number"){const n=Xe(t,o),s=Xe(t,e);return{top:n,right:s,bottom:n,left:s,x:s*2,y:n*2}}if(typeof t=="object"){const n=Xe(t.top??t.y??0,o),s=Xe(t.bottom??t.y??0,o),i=Xe(t.left??t.x??0,e),r=Xe(t.right??t.x??0,e);return{top:n,right:r,bottom:s,left:i,x:i+r,y:n+s}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function Ys(t,e,o,n,s,i){const{x:r,y:l}=Dt(t,[e,o,n]),{x:c,y:d}=Dt({x:t.x+t.width,y:t.y+t.height},[e,o,n]),a=s-c,u=i-d;return{left:Math.floor(r),top:Math.floor(l),right:Math.floor(a),bottom:Math.floor(u)}}const io=(t,e,o,n,s,i)=>{const r=Ks(i,e,o),l=(e-r.x)/t.width,c=(o-r.y)/t.height,d=Math.min(l,c),a=ot(d,n,s),u=t.x+t.width/2,f=t.y+t.height/2,g=e/2-u*a,b=o/2-f*a,_=Ys(t,g,b,a,e,o),y={left:Math.min(_.left-r.left,0),top:Math.min(_.top-r.top,0),right:Math.min(_.right-r.right,0),bottom:Math.min(_.bottom-r.bottom,0)};return{x:g-y.left+y.right,y:b-y.top+y.bottom,zoom:a}},Tt=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function it(t){return t!=null&&t!=="parent"}function Ye(t){return{width:t.measured?.width??t.width??t.initialWidth??0,height:t.measured?.height??t.height??t.initialHeight??0}}function Gs(t){return(t.measured?.width??t.width??t.initialWidth)!==void 0&&(t.measured?.height??t.height??t.initialHeight)!==void 0}function Zs(t,e={width:0,height:0},o,n,s){const i={...t},r=n.get(o);if(r){const l=r.origin||s;i.x+=r.internals.positionAbsolute.x-(e.width??0)*l[0],i.y+=r.internals.positionAbsolute.y-(e.height??0)*l[1]}return i}function Ws(t){return{...Ts,...t||{}}}function Bn(t,{snapGrid:e=[0,0],snapToGrid:o=!1,transform:n,containerBounds:s}){const{x:i,y:r}=Se(t),l=wt({x:i-(s?.left??0),y:r-(s?.top??0)},n),{x:c,y:d}=o?bt(l,e):l;return{xSnapped:c,ySnapped:d,...l}}const Wr=t=>({width:t.offsetWidth,height:t.offsetHeight}),Xr=t=>t?.getRootNode?.()||window?.document,Xs=["INPUT","SELECT","TEXTAREA"];function Ur(t){const e=t.composedPath?.()?.[0]||t.target;return e?.nodeType!==1?!1:Xs.includes(e.nodeName)||e.hasAttribute("contenteditable")||!!e.closest(".nokey")}const Qr=t=>"clientX"in t,Se=(t,e)=>{const o=Qr(t),n=o?t.clientX:t.touches?.[0].clientX,s=o?t.clientY:t.touches?.[0].clientY;return{x:n-(e?.left??0),y:s-(e?.top??0)}},gr=(t,e,o,n,s)=>{const i=e.querySelectorAll(`.${t}`);return!i||!i.length?null:Array.from(i).map(r=>{const l=r.getBoundingClientRect();return{id:r.getAttribute("data-handleid"),type:t,nodeId:s,position:r.getAttribute("data-handlepos"),x:(l.left-o.left)/n,y:(l.top-o.top)/n,...Wr(r)}})};function Us({sourceX:t,sourceY:e,targetX:o,targetY:n,sourceControlX:s,sourceControlY:i,targetControlX:r,targetControlY:l}){const c=t*.125+s*.375+r*.375+o*.125,d=e*.125+i*.375+l*.375+n*.125,a=Math.abs(c-t),u=Math.abs(d-e);return[c,d,a,u]}function Et(t,e){return t>=0?.5*t:e*25*Math.sqrt(-t)}function mr({pos:t,x1:e,y1:o,x2:n,y2:s,c:i}){switch(t){case $.Left:return[e-Et(e-n,i),o];case $.Right:return[e+Et(n-e,i),o];case $.Top:return[e,o-Et(o-s,i)];case $.Bottom:return[e,o+Et(s-o,i)]}}function Jr({sourceX:t,sourceY:e,sourcePosition:o=$.Bottom,targetX:n,targetY:s,targetPosition:i=$.Top,curvature:r=.25}){const[l,c]=mr({pos:o,x1:t,y1:e,x2:n,y2:s,c:r}),[d,a]=mr({pos:i,x1:n,y1:s,x2:t,y2:e,c:r}),[u,f,g,b]=Us({sourceX:t,sourceY:e,targetX:n,targetY:s,sourceControlX:l,sourceControlY:c,targetControlX:d,targetControlY:a});return[`M${t},${e} C${l},${c} ${d},${a} ${n},${s}`,u,f,g,b]}function $r({sourceX:t,sourceY:e,targetX:o,targetY:n}){const s=Math.abs(o-t)/2,i=o<t?o+s:o-s,r=Math.abs(n-e)/2,l=n<e?n+r:n-r;return[i,l,s,r]}function Qs({sourceNode:t,targetNode:e,selected:o=!1,zIndex:n,elevateOnSelect:s=!1}){if(n!==void 0)return n;const i=s&&o?1e3:0,r=Math.max(t.parentId||s&&t.selected?t.internals.z:0,e.parentId||s&&e.selected?e.internals.z:0);return i+r}function Js({sourceNode:t,targetNode:e,width:o,height:n,transform:s}){const i=Vt(It(t),It(e));i.x===i.x2&&(i.x2+=1),i.y===i.y2&&(i.y2+=1);const r={x:-s[0]/s[2],y:-s[1]/s[2],width:o/s[2],height:n/s[2]};return gt(r,Ht(i))>0}const $s=({source:t,sourceHandle:e,target:o,targetHandle:n})=>`xy-edge__${t}${e||""}-${o}${n||""}`,ea=(t,e)=>e.some(o=>o.source===t.source&&o.target===t.target&&(o.sourceHandle===t.sourceHandle||!o.sourceHandle&&!t.sourceHandle)&&(o.targetHandle===t.targetHandle||!o.targetHandle&&!t.targetHandle)),ta=(t,e)=>{if(!t.source||!t.target)return e;let o;return Kr(t)?o={...t}:o={...t,id:$s(t)},ea(o,e)?e:(o.sourceHandle===null&&delete o.sourceHandle,o.targetHandle===null&&delete o.targetHandle,e.concat(o))};function ei({sourceX:t,sourceY:e,targetX:o,targetY:n}){const[s,i,r,l]=$r({sourceX:t,sourceY:e,targetX:o,targetY:n});return[`M ${t},${e}L ${o},${n}`,s,i,r,l]}const vr={[$.Left]:{x:-1,y:0},[$.Right]:{x:1,y:0},[$.Top]:{x:0,y:-1},[$.Bottom]:{x:0,y:1}},na=({source:t,sourcePosition:e=$.Bottom,target:o})=>e===$.Left||e===$.Right?t.x<o.x?{x:1,y:0}:{x:-1,y:0}:t.y<o.y?{x:0,y:1}:{x:0,y:-1},pr=(t,e)=>Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));function oa({source:t,sourcePosition:e=$.Bottom,target:o,targetPosition:n=$.Top,center:s,offset:i,stepPosition:r}){const l=vr[e],c=vr[n],d={x:t.x+l.x*i,y:t.y+l.y*i},a={x:o.x+c.x*i,y:o.y+c.y*i},u=na({source:d,sourcePosition:e,target:a}),f=u.x!==0?"x":"y",g=u[f];let b=[],_,y;const w={x:0,y:0},p={x:0,y:0},[,,O,x]=$r({sourceX:t.x,sourceY:t.y,targetX:o.x,targetY:o.y});if(l[f]*c[f]===-1){f==="x"?(_=s.x??d.x+(a.x-d.x)*r,y=s.y??(d.y+a.y)/2):(_=s.x??(d.x+a.x)/2,y=s.y??d.y+(a.y-d.y)*r);const S=[{x:_,y:d.y},{x:_,y:a.y}],M=[{x:d.x,y},{x:a.x,y}];l[f]===g?b=f==="x"?S:M:b=f==="x"?M:S}else{const S=[{x:d.x,y:a.y}],M=[{x:a.x,y:d.y}];if(f==="x"?b=l.x===g?M:S:b=l.y===g?S:M,e===n){const m=Math.abs(t[f]-o[f]);if(m<=i){const N=Math.min(i-1,i-m);l[f]===g?w[f]=(d[f]>t[f]?-1:1)*N:p[f]=(a[f]>o[f]?-1:1)*N}}if(e!==n){const m=f==="x"?"y":"x",N=l[f]===c[m],v=d[m]>a[m],I=d[m]<a[m];(l[f]===1&&(!N&&v||N&&I)||l[f]!==1&&(!N&&I||N&&v))&&(b=f==="x"?S:M)}const E={x:d.x+w.x,y:d.y+w.y},C={x:a.x+p.x,y:a.y+p.y},z=Math.max(Math.abs(E.x-b[0].x),Math.abs(C.x-b[0].x)),R=Math.max(Math.abs(E.y-b[0].y),Math.abs(C.y-b[0].y));z>=R?(_=(E.x+C.x)/2,y=b[0].y):(_=b[0].x,y=(E.y+C.y)/2)}return[[t,{x:d.x+w.x,y:d.y+w.y},...b,{x:a.x+p.x,y:a.y+p.y},o],_,y,O,x]}function ra(t,e,o,n){const s=Math.min(pr(t,e)/2,pr(e,o)/2,n),{x:i,y:r}=e;if(t.x===i&&i===o.x||t.y===r&&r===o.y)return`L${i} ${r}`;if(t.y===r){const d=t.x<o.x?-1:1,a=t.y<o.y?1:-1;return`L ${i+s*d},${r}Q ${i},${r} ${i},${r+s*a}`}const l=t.x<o.x?1:-1,c=t.y<o.y?-1:1;return`L ${i},${r+s*c}Q ${i},${r} ${i+s*l},${r}`}function so({sourceX:t,sourceY:e,sourcePosition:o=$.Bottom,targetX:n,targetY:s,targetPosition:i=$.Top,borderRadius:r=5,centerX:l,centerY:c,offset:d=20,stepPosition:a=.5}){const[u,f,g,b,_]=oa({source:{x:t,y:e},sourcePosition:o,target:{x:n,y:s},targetPosition:i,center:{x:l,y:c},offset:d,stepPosition:a});return[u.reduce((w,p,O)=>{let x="";return O>0&&O<u.length-1?x=ra(u[O-1],p,u[O+1],r):x=`${O===0?"M":"L"}${p.x} ${p.y}`,w+=x,w},""),f,g,b,_]}function yr(t){return t&&!!(t.internals.handleBounds||t.handles?.length)&&!!(t.measured.width||t.width||t.initialWidth)}function ia(t){const{sourceNode:e,targetNode:o}=t;if(!yr(e)||!yr(o))return null;const n=e.internals.handleBounds||br(e.handles),s=o.internals.handleBounds||br(o.handles),i=wr(n?.source??[],t.sourceHandle),r=wr(t.connectionMode===tt.Strict?s?.target??[]:(s?.target??[]).concat(s?.source??[]),t.targetHandle);if(!i||!r)return t.onError?.("008",ht.error008(i?"target":"source",{id:t.id,sourceHandle:t.sourceHandle,targetHandle:t.targetHandle})),null;const l=i?.position||$.Bottom,c=r?.position||$.Top,d=mt(e,i,l),a=mt(o,r,c);return{sourceX:d.x,sourceY:d.y,targetX:a.x,targetY:a.y,sourcePosition:l,targetPosition:c}}function br(t){if(!t)return null;const e=[],o=[];for(const n of t)n.width=n.width??1,n.height=n.height??1,n.type==="source"?e.push(n):n.type==="target"&&o.push(n);return{source:e,target:o}}function mt(t,e,o=$.Left,n=!1){const s=(e?.x??0)+t.internals.positionAbsolute.x,i=(e?.y??0)+t.internals.positionAbsolute.y,{width:r,height:l}=e??Ye(t);if(n)return{x:s+r/2,y:i+l/2};switch(e?.position??o){case $.Top:return{x:s+r/2,y:i};case $.Right:return{x:s+r,y:i+l/2};case $.Bottom:return{x:s+r/2,y:i+l};case $.Left:return{x:s,y:i+l/2}}}function wr(t,e){return t&&(e?t.find(o=>o.id===e):t[0])||null}function Un(t,e){return t?typeof t=="string"?t:`${e?`${e}__`:""}${Object.keys(t).sort().map(n=>`${n}=${t[n]}`).join("&")}`:""}function sa(t,{id:e,defaultColor:o,defaultMarkerStart:n,defaultMarkerEnd:s}){const i=new Set;return t.reduce((r,l)=>([l.markerStart||n,l.markerEnd||s].forEach(c=>{if(c&&typeof c=="object"){const d=Un(c,e);i.has(d)||(r.push({id:d,color:c.color||o,...c}),i.add(d))}}),r),[]).sort((r,l)=>r.id.localeCompare(l.id))}const ti=1e3,aa=10,ao={nodeOrigin:[0,0],nodeExtent:Zn,elevateNodesOnSelect:!0,defaults:{}},la={...ao,checkEquality:!0};function lo(t,e){const o={...t};for(const n in e)e[n]!==void 0&&(o[n]=e[n]);return o}function da(t,e,o){const n=lo(ao,o);for(const s of t.values())if(s.parentId)co(s,t,e,n);else{const i=yt(s,n.nodeOrigin),r=it(s.extent)?s.extent:n.nodeExtent,l=qe(i,r,Ye(s));s.internals.positionAbsolute=l}}function ca(t,e){if(!t.handles)return t.measured?e?.internals.handleBounds:void 0;const o=[],n=[];for(const s of t.handles){const i={id:s.id,width:s.width??1,height:s.height??1,nodeId:t.id,x:s.x,y:s.y,position:s.position,type:s.type};s.type==="source"?o.push(i):s.type==="target"&&n.push(i)}return{source:o,target:n}}function ua(t,e,o,n){const s=lo(la,n);let i={i:-1},r=t.length>0;const l=new Map(e),c=s?.elevateNodesOnSelect?ti:0;e.clear(),o.clear();for(const d of t){let a=l.get(d.id);if(s.checkEquality&&d===a?.internals.userNode)e.set(d.id,a);else{const u=yt(d,s.nodeOrigin),f=it(d.extent)?d.extent:s.nodeExtent,g=qe(u,f,Ye(d));a={...s.defaults,...d,measured:{width:d.measured?.width,height:d.measured?.height},internals:{positionAbsolute:g,handleBounds:ca(d,a),z:ni(d,c),userNode:d}},e.set(d.id,a)}(a.measured===void 0||a.measured.width===void 0||a.measured.height===void 0)&&!a.hidden&&(r=!1),d.parentId&&co(a,e,o,n,i)}return r}function fa(t,e){if(!t.parentId)return;const o=e.get(t.parentId);o?o.set(t.id,t):e.set(t.parentId,new Map([[t.id,t]]))}function co(t,e,o,n,s){const{elevateNodesOnSelect:i,nodeOrigin:r,nodeExtent:l}=lo(ao,n),c=t.parentId,d=e.get(c);if(!d){console.warn(`Parent node ${c} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}fa(t,o),s&&!d.parentId&&d.internals.rootParentIndex===void 0&&(d.internals.rootParentIndex=++s.i,d.internals.z=d.internals.z+s.i*aa),s&&d.internals.rootParentIndex!==void 0&&(s.i=d.internals.rootParentIndex);const a=i?ti:0,{x:u,y:f,z:g}=ha(t,d,r,l,a),{positionAbsolute:b}=t.internals,_=u!==b.x||f!==b.y;(_||g!==t.internals.z)&&e.set(t.id,{...t,internals:{...t.internals,positionAbsolute:_?{x:u,y:f}:b,z:g}})}function ni(t,e){return(ze(t.zIndex)?t.zIndex:0)+(t.selected?e:0)}function ha(t,e,o,n,s){const{x:i,y:r}=e.internals.positionAbsolute,l=Ye(t),c=yt(t,o),d=it(t.extent)?qe(c,t.extent,l):c;let a=qe({x:i+d.x,y:r+d.y},n,l);t.extent==="parent"&&(a=Gr(a,l,e));const u=ni(t,s),f=e.internals.z??0;return{x:a.x,y:a.y,z:f>=u?f+1:u}}function ga(t,e,o,n=[0,0]){const s=[],i=new Map;for(const r of t){const l=e.get(r.parentId);if(!l)continue;const c=i.get(r.parentId)?.expandedRect??rt(l),d=qs(c,r.rect);i.set(r.parentId,{expandedRect:d,parent:l})}return i.size>0&&i.forEach(({expandedRect:r,parent:l},c)=>{const d=l.internals.positionAbsolute,a=Ye(l),u=l.origin??n,f=r.x<d.x?Math.round(Math.abs(d.x-r.x)):0,g=r.y<d.y?Math.round(Math.abs(d.y-r.y)):0,b=Math.max(a.width,Math.round(r.width)),_=Math.max(a.height,Math.round(r.height)),y=(b-a.width)*u[0],w=(_-a.height)*u[1];(f>0||g>0||y||w)&&(s.push({id:c,type:"position",position:{x:l.position.x-f+y,y:l.position.y-g+w}}),o.get(c)?.forEach(p=>{t.some(O=>O.id===p.id)||s.push({id:p.id,type:"position",position:{x:p.position.x+f,y:p.position.y+g}})})),(a.width<r.width||a.height<r.height||f||g)&&s.push({id:c,type:"dimensions",setAttributes:!0,dimensions:{width:b+(f?u[0]*f-y:0),height:_+(g?u[1]*g-w:0)}})}),s}function ma(t,e,o,n,s,i){const r=n?.querySelector(".xyflow__viewport");let l=!1;if(!r)return{changes:[],updatedInternals:l};const c=[],d=window.getComputedStyle(r),{m22:a}=new window.DOMMatrixReadOnly(d.transform),u=[];for(const f of t.values()){const g=e.get(f.id);if(!g)continue;if(g.hidden){e.set(g.id,{...g,internals:{...g.internals,handleBounds:void 0}}),l=!0;continue}const b=Wr(f.nodeElement),_=g.measured.width!==b.width||g.measured.height!==b.height;if(!!(b.width&&b.height&&(_||!g.internals.handleBounds||f.force))){const w=f.nodeElement.getBoundingClientRect(),p=it(g.extent)?g.extent:i;let{positionAbsolute:O}=g.internals;g.parentId&&g.extent==="parent"?O=Gr(O,b,e.get(g.parentId)):p&&(O=qe(O,p,b));const x={...g,measured:b,internals:{...g.internals,positionAbsolute:O,handleBounds:{source:gr("source",f.nodeElement,w,a,g.id),target:gr("target",f.nodeElement,w,a,g.id)}}};e.set(g.id,x),g.parentId&&co(x,e,o,{nodeOrigin:s}),l=!0,_&&(c.push({id:g.id,type:"dimensions",dimensions:b}),g.expandParent&&g.parentId&&u.push({id:g.id,parentId:g.parentId,rect:rt(x,s)}))}}if(u.length>0){const f=ga(u,e,o,s);c.push(...f)}return{changes:c,updatedInternals:l}}async function va({delta:t,panZoom:e,transform:o,translateExtent:n,width:s,height:i}){if(!e||!t.x&&!t.y)return Promise.resolve(!1);const r=await e.setViewportConstrained({x:o[0]+t.x,y:o[1]+t.y,zoom:o[2]},[[0,0],[s,i]],n),l=!!r&&(r.x!==o[0]||r.y!==o[1]||r.k!==o[2]);return Promise.resolve(l)}function xr(t,e,o,n,s,i){let r=s;const l=n.get(r)||new Map;n.set(r,l.set(o,e)),r=`${s}-${t}`;const c=n.get(r)||new Map;if(n.set(r,c.set(o,e)),i){r=`${s}-${t}-${i}`;const d=n.get(r)||new Map;n.set(r,d.set(o,e))}}function pa(t,e,o){t.clear(),e.clear();for(const n of o){const{source:s,target:i,sourceHandle:r=null,targetHandle:l=null}=n,c={edgeId:n.id,source:s,target:i,sourceHandle:r,targetHandle:l},d=`${s}-${r}--${i}-${l}`,a=`${i}-${l}--${s}-${r}`;xr("source",c,a,t,s,r),xr("target",c,d,t,i,l),e.set(n.id,n)}}function oi(t,e){if(!t.parentId)return!1;const o=e.get(t.parentId);return o?o.selected?!0:oi(o,e):!1}function _r(t,e,o){let n=t;do{if(n?.matches?.(e))return!0;if(n===o)return!1;n=n?.parentElement}while(n);return!1}function ya(t,e,o,n){const s=new Map;for(const[i,r]of t)if((r.selected||r.id===n)&&(!r.parentId||!oi(r,t))&&(r.draggable||e&&typeof r.draggable>"u")){const l=t.get(i);l&&s.set(i,{id:i,position:l.position||{x:0,y:0},distance:{x:o.x-l.internals.positionAbsolute.x,y:o.y-l.internals.positionAbsolute.y},extent:l.extent,parentId:l.parentId,origin:l.origin,expandParent:l.expandParent,internals:{positionAbsolute:l.internals.positionAbsolute||{x:0,y:0}},measured:{width:l.measured.width??0,height:l.measured.height??0}})}return s}function qn({nodeId:t,dragItems:e,nodeLookup:o,dragging:n=!0}){const s=[];for(const[r,l]of e){const c=o.get(r)?.internals.userNode;c&&s.push({...c,position:l.position,dragging:n})}if(!t)return[s[0],s];const i=o.get(t)?.internals.userNode;return[i?{...i,position:e.get(t)?.position||i.position,dragging:n}:s[0],s]}function ba({dragItems:t,snapGrid:e,x:o,y:n}){const s=t.values().next().value;if(!s)return null;const i={x:o-s.distance.x,y:n-s.distance.y},r=bt(i,e);return{x:r.x-i.x,y:r.y-i.y}}function wa({onNodeMouseDown:t,getStoreItems:e,onDragStart:o,onDrag:n,onDragStop:s}){let i={x:null,y:null},r=0,l=new Map,c=!1,d={x:0,y:0},a=null,u=!1,f=null,g=!1,b=!1,_=null;function y({noDragClassName:p,handleSelector:O,domNode:x,isSelectable:T,nodeId:S,nodeClickDistance:M=0}){f=Ne(x);function E({x:m,y:N}){const{nodeLookup:v,nodeExtent:I,snapGrid:P,snapToGrid:V,nodeOrigin:B,onNodeDrag:j,onSelectionDrag:q,onError:Y,updateNodePositions:X}=e();i={x:m,y:N};let D=!1;const A=l.size>1,L=A&&I?Xn(Lt(l)):null,H=A&&V?ba({dragItems:l,snapGrid:P,x:m,y:N}):null;for(const[F,G]of l){if(!v.has(F))continue;let Q={x:m-G.distance.x,y:N-G.distance.y};V&&(Q=H?{x:Math.round(Q.x+H.x),y:Math.round(Q.y+H.y)}:bt(Q,P));let le=null;if(A&&I&&!G.extent&&L){const{positionAbsolute:te}=G.internals,ge=te.x-L.x+I[0][0],Te=te.x+G.measured.width-L.x2+I[1][0],Ae=te.y-L.y+I[0][1],Ze=te.y+G.measured.height-L.y2+I[1][1];le=[[ge,Ae],[Te,Ze]]}const{position:ae,positionAbsolute:re}=Yr({nodeId:F,nextPosition:Q,nodeLookup:v,nodeExtent:le||I,nodeOrigin:B,onError:Y});D=D||G.position.x!==ae.x||G.position.y!==ae.y,G.position=ae,G.internals.positionAbsolute=re}if(b=b||D,!!D&&(X(l,!0),_&&(n||j||!S&&q))){const[F,G]=qn({nodeId:S,dragItems:l,nodeLookup:v});n?.(_,l,F,G),j?.(_,F,G),S||q?.(_,G)}}async function C(){if(!a)return;const{transform:m,panBy:N,autoPanSpeed:v,autoPanOnNodeDrag:I}=e();if(!I){c=!1,cancelAnimationFrame(r);return}const[P,V]=Zr(d,a,v);(P!==0||V!==0)&&(i.x=(i.x??0)-P/m[2],i.y=(i.y??0)-V/m[2],await N({x:P,y:V})&&E(i)),r=requestAnimationFrame(C)}function z(m){const{nodeLookup:N,multiSelectionActive:v,nodesDraggable:I,transform:P,snapGrid:V,snapToGrid:B,selectNodesOnDrag:j,onNodeDragStart:q,onSelectionDragStart:Y,unselectNodesAndEdges:X}=e();u=!0,(!j||!T)&&!v&&S&&(N.get(S)?.selected||X()),T&&j&&S&&t?.(S);const D=Bn(m.sourceEvent,{transform:P,snapGrid:V,snapToGrid:B,containerBounds:a});if(i=D,l=ya(N,I,D,S),l.size>0&&(o||q||!S&&Y)){const[A,L]=qn({nodeId:S,dragItems:l,nodeLookup:N});o?.(m.sourceEvent,l,A,L),q?.(m.sourceEvent,A,L),S||Y?.(m.sourceEvent,L)}}const R=_s().clickDistance(M).on("start",m=>{const{domNode:N,nodeDragThreshold:v,transform:I,snapGrid:P,snapToGrid:V}=e();a=N?.getBoundingClientRect()||null,g=!1,b=!1,_=m.sourceEvent,v===0&&z(m),i=Bn(m.sourceEvent,{transform:I,snapGrid:P,snapToGrid:V,containerBounds:a}),d=Se(m.sourceEvent,a)}).on("drag",m=>{const{autoPanOnNodeDrag:N,transform:v,snapGrid:I,snapToGrid:P,nodeDragThreshold:V,nodeLookup:B}=e(),j=Bn(m.sourceEvent,{transform:v,snapGrid:I,snapToGrid:P,containerBounds:a});if(_=m.sourceEvent,(m.sourceEvent.type==="touchmove"&&m.sourceEvent.touches.length>1||S&&!B.has(S))&&(g=!0),!g){if(!c&&N&&u&&(c=!0,C()),!u){const q=Se(m.sourceEvent,a),Y=q.x-d.x,X=q.y-d.y;Math.sqrt(Y*Y+X*X)>V&&z(m)}(i.x!==j.xSnapped||i.y!==j.ySnapped)&&l&&u&&(d=Se(m.sourceEvent,a),E(j))}}).on("end",m=>{if(!(!u||g)&&(c=!1,u=!1,cancelAnimationFrame(r),l.size>0)){const{nodeLookup:N,updateNodePositions:v,onNodeDragStop:I,onSelectionDragStop:P}=e();if(b&&(v(l,!1),b=!1),s||I||!S&&P){const[V,B]=qn({nodeId:S,dragItems:l,nodeLookup:N,dragging:!1});s?.(m.sourceEvent,l,V,B),I?.(m.sourceEvent,V,B),S||P?.(m.sourceEvent,B)}}}).filter(m=>{const N=m.target;return!m.button&&(!p||!_r(N,`.${p}`,x))&&(!O||_r(N,O,x))});f.call(R)}function w(){f?.on(".drag",null)}return{update:y,destroy:w}}function xa(t,e,o){const n=[],s={x:t.x-o,y:t.y-o,width:o*2,height:o*2};for(const i of e.values())gt(s,rt(i))>0&&n.push(i);return n}const _a=250;function Ea(t,e,o,n){let s=[],i=1/0;const r=xa(t,o,e+_a);for(const l of r){const c=[...l.internals.handleBounds?.source??[],...l.internals.handleBounds?.target??[]];for(const d of c){if(n.nodeId===d.nodeId&&n.type===d.type&&n.id===d.id)continue;const{x:a,y:u}=mt(l,d,d.position,!0),f=Math.sqrt(Math.pow(a-t.x,2)+Math.pow(u-t.y,2));f>e||(f<i?(s=[{...d,x:a,y:u}],i=f):f===i&&s.push({...d,x:a,y:u}))}}if(!s.length)return null;if(s.length>1){const l=n.type==="source"?"target":"source";return s.find(c=>c.type===l)??s[0]}return s[0]}function ri(t,e,o,n,s,i=!1){const r=n.get(t);if(!r)return null;const l=s==="strict"?r.internals.handleBounds?.[e]:[...r.internals.handleBounds?.source??[],...r.internals.handleBounds?.target??[]],c=(o?l?.find(d=>d.id===o):l?.[0])??null;return c&&i?{...c,...mt(r,c,c.position,!0)}:c}function ii(t,e){return t||(e?.classList.contains("target")?"target":e?.classList.contains("source")?"source":null)}function ka(t,e){let o=null;return e?o=!0:t&&!e&&(o=!1),o}const si=()=>!0;function Ca(t,{connectionMode:e,connectionRadius:o,handleId:n,nodeId:s,edgeUpdaterType:i,isTarget:r,domNode:l,nodeLookup:c,lib:d,autoPanOnConnect:a,flowId:u,panBy:f,cancelConnection:g,onConnectStart:b,onConnect:_,onConnectEnd:y,isValidConnection:w=si,onReconnectEnd:p,updateConnection:O,getTransform:x,getFromHandle:T,autoPanSpeed:S,dragThreshold:M=1,handleDomNode:E}){const C=Xr(t.target);let z=0,R;const{x:m,y:N}=Se(t),v=ii(i,E),I=l?.getBoundingClientRect();let P=!1;if(!I||!v)return;const V=ri(s,v,n,c,e);if(!V)return;let B=Se(t,I),j=!1,q=null,Y=!1,X=null;function D(){if(!a||!I)return;const[ae,re]=Zr(B,I,S);f({x:ae,y:re}),z=requestAnimationFrame(D)}const A={...V,nodeId:s,type:v,position:V.position},L=c.get(s);let F={inProgress:!0,isValid:null,from:mt(L,A,$.Left,!0),fromHandle:A,fromPosition:A.position,fromNode:L,to:B,toHandle:null,toPosition:cr[A.position],toNode:null};function G(){P=!0,O(F),b?.(t,{nodeId:s,handleId:n,handleType:v})}M===0&&G();function Q(ae){if(!P){const{x:Te,y:Ae}=Se(ae),Ze=Te-m,de=Ae-N;if(!(Ze*Ze+de*de>M*M))return;G()}if(!T()||!A){le(ae);return}const re=x();B=Se(ae,I),R=Ea(wt(B,re,!1,[1,1]),o,c,A),j||(D(),j=!0);const te=ai(ae,{handle:R,connectionMode:e,fromNodeId:s,fromHandleId:n,fromType:r?"target":"source",isValidConnection:w,doc:C,lib:d,flowId:u,nodeLookup:c});X=te.handleDomNode,q=te.connection,Y=ka(!!R,te.isValid);const ge={...F,isValid:Y,to:te.toHandle&&Y?Dt({x:te.toHandle.x,y:te.toHandle.y},re):B,toHandle:te.toHandle,toPosition:Y&&te.toHandle?te.toHandle.position:cr[A.position],toNode:te.toHandle?c.get(te.toHandle.nodeId):null};Y&&R&&F.toHandle&&ge.toHandle&&F.toHandle.type===ge.toHandle.type&&F.toHandle.nodeId===ge.toHandle.nodeId&&F.toHandle.id===ge.toHandle.id&&F.to.x===ge.to.x&&F.to.y===ge.to.y||(O(ge),F=ge)}function le(ae){if(!("touches"in ae&&ae.touches.length>0)){if(P){(R||X)&&q&&Y&&_?.(q);const{inProgress:re,...te}=F,ge={...te,toPosition:F.toHandle?F.toPosition:null};y?.(ae,ge),i&&p?.(ae,ge)}g(),cancelAnimationFrame(z),j=!1,Y=!1,q=null,X=null,C.removeEventListener("mousemove",Q),C.removeEventListener("mouseup",le),C.removeEventListener("touchmove",Q),C.removeEventListener("touchend",le)}}C.addEventListener("mousemove",Q),C.addEventListener("mouseup",le),C.addEventListener("touchmove",Q),C.addEventListener("touchend",le)}function ai(t,{handle:e,connectionMode:o,fromNodeId:n,fromHandleId:s,fromType:i,doc:r,lib:l,flowId:c,isValidConnection:d=si,nodeLookup:a}){const u=i==="target",f=e?r.querySelector(`.${l}-flow__handle[data-id="${c}-${e?.nodeId}-${e?.id}-${e?.type}"]`):null,{x:g,y:b}=Se(t),_=r.elementFromPoint(g,b),y=_?.classList.contains(`${l}-flow__handle`)?_:f,w={handleDomNode:y,isValid:!1,connection:null,toHandle:null};if(y){const p=ii(void 0,y),O=y.getAttribute("data-nodeid"),x=y.getAttribute("data-handleid"),T=y.classList.contains("connectable"),S=y.classList.contains("connectableend");if(!O||!p)return w;const M={source:u?O:n,sourceHandle:u?x:s,target:u?n:O,targetHandle:u?s:x};w.connection=M;const C=T&&S&&(o===tt.Strict?u&&p==="source"||!u&&p==="target":O!==n||x!==s);w.isValid=C&&d(M),w.toHandle=ri(O,p,x,a,o,!0)}return w}const Er={onPointerDown:Ca,isValid:ai},jt=t=>({x:t.x,y:t.y,zoom:t.k}),Fn=({x:t,y:e,zoom:o})=>to.translate(t,e).scale(o),Qe=(t,e)=>t.target.closest(`.${e}`),li=(t,e)=>e===2&&Array.isArray(t)&&t.includes(2),Na=t=>((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2,Kn=(t,e=0,o=Na,n=()=>{})=>{const s=typeof e=="number"&&e>0;return s||n(),s?t.transition().duration(e).ease(o).on("end",n):t},di=t=>{const e=t.ctrlKey&&Tt()?10:1;return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*e};function Sa({zoomPanValues:t,noWheelClassName:e,d3Selection:o,d3Zoom:n,panOnScrollMode:s,panOnScrollSpeed:i,zoomOnPinch:r,onPanZoomStart:l,onPanZoom:c,onPanZoomEnd:d}){return a=>{if(Qe(a,e))return a.ctrlKey&&a.preventDefault(),!1;a.preventDefault(),a.stopImmediatePropagation();const u=o.property("__zoom").k||1;if(a.ctrlKey&&r){const y=Me(a),w=di(a),p=u*Math.pow(2,w);n.scaleTo(o,p,y,a);return}const f=a.deltaMode===1?20:1;let g=s===$e.Vertical?0:a.deltaX*f,b=s===$e.Horizontal?0:a.deltaY*f;!Tt()&&a.shiftKey&&s!==$e.Vertical&&(g=a.deltaY*f,b=0),n.translateBy(o,-(g/u)*i,-(b/u)*i,{internal:!0});const _=jt(o.property("__zoom"));clearTimeout(t.panScrollTimeout),t.isPanScrolling?(c?.(a,_),t.panScrollTimeout=setTimeout(()=>{d?.(a,_),t.isPanScrolling=!1},150)):(t.isPanScrolling=!0,l?.(a,_))}}function Pa({noWheelClassName:t,preventScrolling:e,d3ZoomHandler:o}){return function(n,s){const i=n.type==="wheel",r=!e&&i&&!n.ctrlKey,l=Qe(n,t);if(n.ctrlKey&&i&&l&&n.preventDefault(),r||l)return null;n.preventDefault(),o.call(this,n,s)}}function Oa({zoomPanValues:t,onDraggingChange:e,onPanZoomStart:o}){return n=>{if(n.sourceEvent?.internal)return;const s=jt(n.transform);t.mouseButton=n.sourceEvent?.button||0,t.isZoomingOrPanning=!0,t.prevViewport=s,n.sourceEvent?.type==="mousedown"&&e(!0),o&&o?.(n.sourceEvent,s)}}function Ma({zoomPanValues:t,panOnDrag:e,onPaneContextMenu:o,onTransformChange:n,onPanZoom:s}){return i=>{t.usedRightMouseButton=!!(o&&li(e,t.mouseButton??0)),i.sourceEvent?.sync||n([i.transform.x,i.transform.y,i.transform.k]),s&&!i.sourceEvent?.internal&&s?.(i.sourceEvent,jt(i.transform))}}function Ia({zoomPanValues:t,panOnDrag:e,panOnScroll:o,onDraggingChange:n,onPanZoomEnd:s,onPaneContextMenu:i}){return r=>{if(!r.sourceEvent?.internal&&(t.isZoomingOrPanning=!1,i&&li(e,t.mouseButton??0)&&!t.usedRightMouseButton&&r.sourceEvent&&i(r.sourceEvent),t.usedRightMouseButton=!1,n(!1),s)){const l=jt(r.transform);t.prevViewport=l,clearTimeout(t.timerId),t.timerId=setTimeout(()=>{s?.(r.sourceEvent,l)},o?150:0)}}}function Da({zoomActivationKeyPressed:t,zoomOnScroll:e,zoomOnPinch:o,panOnDrag:n,panOnScroll:s,zoomOnDoubleClick:i,userSelectionActive:r,noWheelClassName:l,noPanClassName:c,lib:d,connectionInProgress:a}){return u=>{const f=t||e,g=o&&u.ctrlKey,b=u.type==="wheel";if(u.button===1&&u.type==="mousedown"&&(Qe(u,`${d}-flow__node`)||Qe(u,`${d}-flow__edge`)))return!0;if(!n&&!f&&!s&&!i&&!o||r||a&&!b||Qe(u,l)&&b||Qe(u,c)&&(!b||s&&b&&!t)||!o&&u.ctrlKey&&b)return!1;if(!o&&u.type==="touchstart"&&u.touches?.length>1)return u.preventDefault(),!1;if(!f&&!s&&!g&&b||!n&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(n)&&!n.includes(u.button)&&u.type==="mousedown")return!1;const _=Array.isArray(n)&&n.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||b)&&_}}function Ta({domNode:t,minZoom:e,maxZoom:o,paneClickDistance:n,translateExtent:s,viewport:i,onPanZoom:r,onPanZoomStart:l,onPanZoomEnd:c,onDraggingChange:d}){const a={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},u=t.getBoundingClientRect(),f=Ds().clickDistance(!ze(n)||n<0?0:n).scaleExtent([e,o]).translateExtent(s),g=Ne(t).call(f);O({x:i.x,y:i.y,zoom:ot(i.zoom,e,o)},[[0,0],[u.width,u.height]],s);const b=g.on("wheel.zoom"),_=g.on("dblclick.zoom");f.wheelDelta(di);function y(m,N){return g?new Promise(v=>{f?.interpolate(N?.interpolate==="linear"?Kt:Nt).transform(Kn(g,N?.duration,N?.ease,()=>v(!0)),m)}):Promise.resolve(!1)}function w({noWheelClassName:m,noPanClassName:N,onPaneContextMenu:v,userSelectionActive:I,panOnScroll:P,panOnDrag:V,panOnScrollMode:B,panOnScrollSpeed:j,preventScrolling:q,zoomOnPinch:Y,zoomOnScroll:X,zoomOnDoubleClick:D,zoomActivationKeyPressed:A,lib:L,onTransformChange:H,connectionInProgress:F}){I&&!a.isZoomingOrPanning&&p();const Q=P&&!A&&!I?Sa({zoomPanValues:a,noWheelClassName:m,d3Selection:g,d3Zoom:f,panOnScrollMode:B,panOnScrollSpeed:j,zoomOnPinch:Y,onPanZoomStart:l,onPanZoom:r,onPanZoomEnd:c}):Pa({noWheelClassName:m,preventScrolling:q,d3ZoomHandler:b});if(g.on("wheel.zoom",Q,{passive:!1}),!I){const ae=Oa({zoomPanValues:a,onDraggingChange:d,onPanZoomStart:l});f.on("start",ae);const re=Ma({zoomPanValues:a,panOnDrag:V,onPaneContextMenu:!!v,onPanZoom:r,onTransformChange:H});f.on("zoom",re);const te=Ia({zoomPanValues:a,panOnDrag:V,panOnScroll:P,onPaneContextMenu:v,onPanZoomEnd:c,onDraggingChange:d});f.on("end",te)}const le=Da({zoomActivationKeyPressed:A,panOnDrag:V,zoomOnScroll:X,panOnScroll:P,zoomOnDoubleClick:D,zoomOnPinch:Y,userSelectionActive:I,noPanClassName:N,noWheelClassName:m,lib:L,connectionInProgress:F});f.filter(le),D?g.on("dblclick.zoom",_):g.on("dblclick.zoom",null)}function p(){f.on("zoom",null)}async function O(m,N,v){const I=Fn(m),P=f?.constrain()(I,N,v);return P&&await y(P),new Promise(V=>V(P))}async function x(m,N){const v=Fn(m);return await y(v,N),new Promise(I=>I(v))}function T(m){if(g){const N=Fn(m),v=g.property("__zoom");(v.k!==m.zoom||v.x!==m.x||v.y!==m.y)&&f?.transform(g,N,null,{sync:!0})}}function S(){const m=g?Oi(g.node()):{x:0,y:0,k:1};return{x:m.x,y:m.y,zoom:m.k}}function M(m,N){return g?new Promise(v=>{f?.interpolate(N?.interpolate==="linear"?Kt:Nt).scaleTo(Kn(g,N?.duration,N?.ease,()=>v(!0)),m)}):Promise.resolve(!1)}function E(m,N){return g?new Promise(v=>{f?.interpolate(N?.interpolate==="linear"?Kt:Nt).scaleBy(Kn(g,N?.duration,N?.ease,()=>v(!0)),m)}):Promise.resolve(!1)}function C(m){f?.scaleExtent(m)}function z(m){f?.translateExtent(m)}function R(m){const N=!ze(m)||m<0?0:m;f?.clickDistance(N)}return{update:w,destroy:p,setViewport:x,setViewportConstrained:O,getViewport:S,scaleTo:M,scaleBy:E,setScaleExtent:C,setTranslateExtent:z,syncViewport:T,setClickDistance:R}}var kr;(function(t){t.Line="line",t.Handle="handle"})(kr||(kr={}));var za=se("<div><!></div>");function Fe(t,e){ne(e,!0);let o=Z(e,"id",3,null),n=Z(e,"type",3,"source"),s=Z(e,"position",19,()=>$.Top),i=Z(e,"isConnectableStart",3,!0),r=Z(e,"isConnectableEnd",3,!0),l=Ke(e,["$$slots","$$events","$$legacy","id","type","position","style","class","isConnectable","isConnectableStart","isConnectableEnd","isValidConnection","onconnect","ondisconnect","children"]);const c=ut("svelteflow__node_id"),d=ut("svelteflow__node_connectable");let a=k(()=>n()==="target"),u=k(()=>e.isConnectable!==void 0?e.isConnectable:d.value),f=Ge(),g=k(()=>f.ariaLabelConfig),b=null;_i(()=>{if(e.onconnect||e.ondisconnect){f.edges;let m=f.connectionLookup.get(`${c}-${n()}${o()?`-${o()}`:""}`);if(b&&!zs(m,b)){const N=m??new Map;ur(b,N,e.ondisconnect),ur(N,b,e.onconnect)}b=new Map(m)}});let _=k(()=>{if(!f.connection.inProgress)return[!1,!1,!1,!1,null];const{fromHandle:m,toHandle:N,isValid:v}=f.connection,I=m&&m.nodeId===c&&m.type===n()&&m.id===o(),P=N&&N.nodeId===c&&N.type===n()&&N.id===o(),V=f.connectionMode===tt.Strict?m?.type!==n():c!==m?.nodeId||o()!==m?.id;return[!0,I,P,V,P&&v]}),y=k(()=>vt(h(_),5)),w=k(()=>h(y)[0]),p=k(()=>h(y)[1]),O=k(()=>h(y)[2]),x=k(()=>h(y)[3]),T=k(()=>h(y)[4]);function S(m){const N=f.onbeforeconnect?f.onbeforeconnect(m):m;N&&(f.addEdge(N),f.onconnect?.(m))}function M(m){const N=Qr(m);m.currentTarget&&(N&&m.button===0||!N)&&Er.onPointerDown(m,{handleId:o(),nodeId:c,isTarget:h(a),connectionRadius:f.connectionRadius,domNode:f.domNode,nodeLookup:f.nodeLookup,connectionMode:f.connectionMode,lib:"svelte",autoPanOnConnect:f.autoPanOnConnect,autoPanSpeed:f.autoPanSpeed,flowId:f.flowId,isValidConnection:e.isValidConnection??f.isValidConnection,updateConnection:f.updateConnection,cancelConnection:f.cancelConnection,panBy:f.panBy,onConnect:S,onConnectStart:(v,I)=>{f.onconnectstart?.(v,{nodeId:I.nodeId,handleId:I.handleId,handleType:I.handleType})},onConnectEnd:(v,I)=>{f.onconnectend?.(v,I)},getTransform:()=>[f.viewport.x,f.viewport.y,f.viewport.zoom],getFromHandle:()=>f.connection.fromHandle,dragThreshold:f.connectionDragThreshold,handleDomNode:m.currentTarget})}function E(m){if(!c||!f.clickConnectStartHandle&&!i())return;if(!f.clickConnectStartHandle){f.onclickconnectstart?.(m,{nodeId:c,handleId:o(),handleType:n()}),f.clickConnectStartHandle={nodeId:c,type:n(),id:o()};return}const N=Xr(m.target),v=e.isValidConnection??f.isValidConnection,{connectionMode:I,clickConnectStartHandle:P,flowId:V,nodeLookup:B}=f,{connection:j,isValid:q}=Er.isValid(m,{handle:{nodeId:c,id:o(),type:n()},connectionMode:I,fromNodeId:P.nodeId,fromHandleId:P.id??null,fromType:P.type,isValidConnection:v,flowId:V,doc:N,lib:"svelte",nodeLookup:B});q&&j&&S(j);const Y=structuredClone(zr(f.connection));delete Y.inProgress,Y.toPosition=Y.toHandle?Y.toHandle.position:null,f.onclickconnectend?.(m,Y),f.clickConnectStartHandle=null}var C=za(),z=()=>{};He(C,m=>({"data-handleid":o(),"data-nodeid":c,"data-handlepos":s(),"data-id":`${f.flowId??""}-${c??""}-${o()??"null"??""}-${n()??""}`,class:["svelte-flow__handle",`svelte-flow__handle-${s()}`,f.noDragClass,f.noPanClass,s(),e.class],onmousedown:M,ontouchstart:M,onclick:f.clickConnect?E:void 0,onkeypress:z,style:e.style,role:"button","aria-label":h(g)["handle.ariaLabel"],tabindex:"-1",...l,[$n]:m}),[()=>({valid:h(T),connectingto:h(O),connectingfrom:h(p),source:!h(a),target:h(a),connectablestart:i(),connectableend:r(),connectable:h(u),connectionindicator:h(u)&&(!h(w)||h(x))&&(h(w)||f.clickConnectStartHandle?r():i())})]);var R=J(C);Ce(R,()=>e.children??st),U(C),W(t,C),oe()}var Aa=se("<!> <!>",1);function ci(t,e){ne(e,!0);let o=Z(e,"targetPosition",19,()=>$.Top),n=Z(e,"sourcePosition",19,()=>$.Bottom);var s=Aa(),i=ce(s);Fe(i,{type:"target",get position(){return o()}});var r=ee(i),l=ee(r);Fe(l,{type:"source",get position(){return n()}}),ue(()=>pe(r,` ${e.data?.label??""} `)),W(t,s),oe()}var Ra=se(" <!>",1);function La(t,e){ne(e,!0);let o=Z(e,"data",19,()=>({label:"Node"})),n=Z(e,"sourcePosition",19,()=>$.Bottom);et();var s=Ra(),i=ce(s),r=ee(i);Fe(r,{type:"source",get position(){return n()}}),ue(()=>pe(i,`${o()?.label??""} `)),W(t,s),oe()}var Va=se(" <!>",1);function Ha(t,e){ne(e,!0);let o=Z(e,"data",19,()=>({label:"Node"})),n=Z(e,"targetPosition",19,()=>$.Top);et();var s=Va(),i=ce(s),r=ee(i);Fe(r,{type:"target",get position(){return n()}}),ue(()=>pe(i,`${o()?.label??""} `)),W(t,s),oe()}function ja(t,e){}function Yn(t,e,o){if(!o||!e)return;const n=o==="root"?e:e.querySelector(`.svelte-flow__${o}`);n&&n.appendChild(t)}function Ba(t,e){const o=k(Ge),n=k(()=>h(o).domNode);let s;return h(n)?Yn(t,h(n),e):s=Ir(()=>{Be(()=>{Yn(t,h(n),e),s?.()})}),{async update(i){Yn(t,h(n),i)},destroy(){t.parentNode&&t.parentNode.removeChild(t),s?.()}}}function qa(){let t=fe(typeof window>"u");if(h(t)){const e=Ir(()=>{Be(()=>{K(t,!1),e?.()})})}return{get value(){return h(t)}}}const Cr=t=>Rs(t),Fa=t=>Kr(t);function De(t){return t===void 0?void 0:`${t}px`}const zt={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var Ka=se("<div><!></div>");function Ya(t,e){ne(e,!0);let o=Z(e,"x",3,0),n=Z(e,"y",3,0),s=Z(e,"selectEdgeOnClick",3,!1),i=Z(e,"transparent",3,!1),r=Ke(e,["$$slots","$$events","$$legacy","x","y","width","height","selectEdgeOnClick","transparent","class","children"]);const l=Ge(),c=ut("svelteflow__edge_id");let d=k(()=>l.visible.edges.get(c)?.zIndex);var a=Ka(),u=()=>{s()&&c&&l.handleEdgeSelection(c)};He(a,g=>({class:["svelte-flow__edge-label",{transparent:i()},e.class],tabindex:"-1",onclick:u,...r,[At]:g}),[()=>({display:qa().value?"none":void 0,cursor:s()?"pointer":void 0,transform:`translate(-50%, -50%) translate(${o()??""}px,${n()??""}px)`,"pointer-events":"all",width:De(e.width),height:De(e.height),"z-index":h(d)})],void 0,"svelte-1wi9q07");var f=J(a);Ce(f,()=>e.children??st),U(a),xe(a,(g,b)=>Ba?.(g,b),()=>"edge-labels"),W(t,a),oe()}var Ga=ve("<path></path>"),Za=ve('<path fill="none"></path><!><!>',1);function Bt(t,e){let o=Z(e,"interactionWidth",3,20),n=Ke(e,["$$slots","$$events","$$legacy","id","path","label","labelX","labelY","labelStyle","markerStart","markerEnd","style","interactionWidth","class"]);var s=Za(),i=ce(s),r=ee(i);{var l=a=>{var u=Ga();He(u,()=>({d:e.path,"stroke-opacity":0,"stroke-width":o(),fill:"none",class:"svelte-flow__edge-interaction",...n})),W(a,u)};he(r,a=>{o()>0&&a(l)})}var c=ee(r);{var d=a=>{Ya(a,{get x(){return e.labelX},get y(){return e.labelY},get style(){return e.labelStyle},selectEdgeOnClick:!0,children:(u,f)=>{et();var g=Ei();ue(()=>pe(g,e.label)),W(u,g)},$$slots:{default:!0}})};he(c,a=>{e.label&&a(d)})}ue(()=>{ie(i,"id",e.id),ie(i,"d",e.path),je(i,0,at(["svelte-flow__edge-path",e.class])),ie(i,"marker-start",e.markerStart),ie(i,"marker-end",e.markerEnd),Ie(i,e.style)}),W(t,s)}function ui(t,e){ne(e,!0);let o=k(()=>Jr({sourceX:e.sourceX,sourceY:e.sourceY,targetX:e.targetX,targetY:e.targetY,sourcePosition:e.sourcePosition,targetPosition:e.targetPosition,curvature:e.pathOptions?.curvature})),n=k(()=>vt(h(o),3)),s=k(()=>h(n)[0]),i=k(()=>h(n)[1]),r=k(()=>h(n)[2]);Bt(t,{get id(){return e.id},get path(){return h(s)},get labelX(){return h(i)},get labelY(){return h(r)},get label(){return e.label},get labelStyle(){return e.labelStyle},get markerStart(){return e.markerStart},get markerEnd(){return e.markerEnd},get interactionWidth(){return e.interactionWidth},get style(){return e.style}}),oe()}function Wa(t,e){ne(e,!0);let o=k(()=>so({sourceX:e.sourceX,sourceY:e.sourceY,targetX:e.targetX,targetY:e.targetY,sourcePosition:e.sourcePosition,targetPosition:e.targetPosition})),n=k(()=>vt(h(o),3)),s=k(()=>h(n)[0]),i=k(()=>h(n)[1]),r=k(()=>h(n)[2]);Bt(t,{get path(){return h(s)},get labelX(){return h(i)},get labelY(){return h(r)},get label(){return e.label},get labelStyle(){return e.labelStyle},get markerStart(){return e.markerStart},get markerEnd(){return e.markerEnd},get interactionWidth(){return e.interactionWidth},get style(){return e.style}}),oe()}function Xa(t,e){ne(e,!0);let o=k(()=>ei({sourceX:e.sourceX,sourceY:e.sourceY,targetX:e.targetX,targetY:e.targetY})),n=k(()=>vt(h(o),3)),s=k(()=>h(n)[0]),i=k(()=>h(n)[1]),r=k(()=>h(n)[2]);Bt(t,{get path(){return h(s)},get labelX(){return h(i)},get labelY(){return h(r)},get label(){return e.label},get labelStyle(){return e.labelStyle},get markerStart(){return e.markerStart},get markerEnd(){return e.markerEnd},get interactionWidth(){return e.interactionWidth},get style(){return e.style}}),oe()}function Ua(t,e){ne(e,!0);let o=k(()=>so({sourceX:e.sourceX,sourceY:e.sourceY,targetX:e.targetX,targetY:e.targetY,sourcePosition:e.sourcePosition,targetPosition:e.targetPosition,borderRadius:0})),n=k(()=>vt(h(o),3)),s=k(()=>h(n)[0]),i=k(()=>h(n)[1]),r=k(()=>h(n)[2]);Bt(t,{get path(){return h(s)},get labelX(){return h(i)},get labelY(){return h(r)},get label(){return e.label},get labelStyle(){return e.labelStyle},get markerStart(){return e.markerStart},get markerEnd(){return e.markerEnd},get interactionWidth(){return e.interactionWidth},get style(){return e.style}}),oe()}function Qa(t,e,o,n){const s=new Map;return ro(t,{x:0,y:0,width:o,height:n},e,!0).forEach(i=>{s.set(i.id,i)}),s}function Nr(t){const{edges:e,defaultEdgeOptions:o,nodeLookup:n,previousEdges:s,connectionMode:i,onerror:r,onlyRenderVisible:l,elevateEdgesOnSelect:c}=t,d=new Map;for(const a of e){const u=n.get(a.source),f=n.get(a.target);if(!u||!f)continue;if(l){const{visibleNodes:_,transform:y,width:w,height:p}=t;if(Js({sourceNode:u,targetNode:f,width:w,height:p,transform:y}))_.set(u.id,u),_.set(f.id,f);else continue}const g=s.get(a.id);if(g&&a===g.edge&&u==g.sourceNode&&f==g.targetNode){d.set(a.id,g);continue}const b=ia({id:a.id,sourceNode:u,targetNode:f,sourceHandle:a.sourceHandle||null,targetHandle:a.targetHandle||null,connectionMode:i,onError:r});b&&d.set(a.id,{...o,...a,...b,zIndex:Qs({selected:a.selected,zIndex:a.zIndex??o.zIndex,sourceNode:u,targetNode:f,elevateOnSelect:c}),sourceNode:u,targetNode:f,edge:a})}return d}const fi={input:La,output:Ha,default:ci,group:ja},hi={straight:Xa,smoothstep:Wa,default:ui,step:Ua};function Ja(t,e,o,n,s,i){if(e&&!o&&n&&s){const r=Lt(i,{filter:l=>!!((l.width||l.initialWidth)&&(l.height||l.initialHeight))});return io(r,n,s,.5,2,.1)}else return o??{x:0,y:0,zoom:1}}function $a(t){class e{#e=k(()=>t.props.id??"1");get flowId(){return h(this.#e)}set flowId(n){K(this.#e,n)}#t=fe(null);get domNode(){return h(this.#t)}set domNode(n){K(this.#t,n)}#n=fe(null);get panZoom(){return h(this.#n)}set panZoom(n){K(this.#n,n)}#o=fe(t.width??0);get width(){return h(this.#o)}set width(n){K(this.#o,n)}#r=fe(t.height??0);get height(){return h(this.#r)}set height(n){K(this.#r,n)}#i=k(()=>{const n=ua(t.nodes,this.nodeLookup,this.parentLookup,{nodeExtent:this.nodeExtent,nodeOrigin:this.nodeOrigin,elevateNodesOnSelect:t.props.elevateNodesOnSelect??!0,checkEquality:!0});return this.fitViewQueued&&n&&(this.fitViewOptions?.duration?this.resolveFitView():queueMicrotask(()=>{this.resolveFitView()})),n});get nodesInitialized(){return h(this.#i)}set nodesInitialized(n){K(this.#i,n)}#s=k(()=>this.panZoom!==null);get viewportInitialized(){return h(this.#s)}set viewportInitialized(n){K(this.#s,n)}#a=k(()=>(pa(this.connectionLookup,this.edgeLookup,t.edges),t.edges));get _edges(){return h(this.#a)}set _edges(n){K(this.#a,n)}get nodes(){return this.nodesInitialized,t.nodes}set nodes(n){t.nodes=n}get edges(){return this._edges}set edges(n){t.edges=n}_prevSelectedNodes=[];_prevSelectedNodeIds=new Set;#l=k(()=>{const n=this._prevSelectedNodeIds.size,s=new Set,i=this.nodes.filter(r=>(r.selected&&(s.add(r.id),this._prevSelectedNodeIds.delete(r.id)),r.selected));return(n!==s.size||this._prevSelectedNodeIds.size>0)&&(this._prevSelectedNodes=i),this._prevSelectedNodeIds=s,this._prevSelectedNodes});get selectedNodes(){return h(this.#l)}set selectedNodes(n){K(this.#l,n)}_prevSelectedEdges=[];_prevSelectedEdgeIds=new Set;#d=k(()=>{const n=this._prevSelectedEdgeIds.size,s=new Set,i=this.edges.filter(r=>(r.selected&&(s.add(r.id),this._prevSelectedEdgeIds.delete(r.id)),r.selected));return(n!==s.size||this._prevSelectedEdgeIds.size>0)&&(this._prevSelectedEdges=i),this._prevSelectedEdgeIds=s,this._prevSelectedEdges});get selectedEdges(){return h(this.#d)}set selectedEdges(n){K(this.#d,n)}selectionChangeHandlers=new Map;nodeLookup=new Map;parentLookup=new Map;connectionLookup=new Map;edgeLookup=new Map;_prevVisibleEdges=new Map;#c=k(()=>{const{nodes:n,_edges:s,_prevVisibleEdges:i,nodeLookup:r,connectionMode:l,onerror:c,onlyRenderVisibleElements:d,defaultEdgeOptions:a}=this;let u,f;const g={edges:s,defaultEdgeOptions:a,previousEdges:i,nodeLookup:r,connectionMode:l,elevateEdgesOnSelect:t.props.elevateEdgesOnSelect??!0,onerror:c};if(d){const{viewport:b,width:_,height:y}=this,w=[b.x,b.y,b.zoom];u=Qa(r,w,_,y),f=Nr({...g,onlyRenderVisible:!0,visibleNodes:u,transform:w,width:_,height:y})}else u=this.nodeLookup,f=Nr(g);return{nodes:u,edges:f}});get visible(){return h(this.#c)}set visible(n){K(this.#c,n)}#u=k(()=>t.props.nodesDraggable??!0);get nodesDraggable(){return h(this.#u)}set nodesDraggable(n){K(this.#u,n)}#f=k(()=>t.props.nodesConnectable??!0);get nodesConnectable(){return h(this.#f)}set nodesConnectable(n){K(this.#f,n)}#h=k(()=>t.props.elementsSelectable??!0);get elementsSelectable(){return h(this.#h)}set elementsSelectable(n){K(this.#h,n)}#g=k(()=>t.props.nodesFocusable??!0);get nodesFocusable(){return h(this.#g)}set nodesFocusable(n){K(this.#g,n)}#m=k(()=>t.props.edgesFocusable??!0);get edgesFocusable(){return h(this.#m)}set edgesFocusable(n){K(this.#m,n)}#v=k(()=>t.props.disableKeyboardA11y??!1);get disableKeyboardA11y(){return h(this.#v)}set disableKeyboardA11y(n){K(this.#v,n)}#p=k(()=>t.props.minZoom??.5);get minZoom(){return h(this.#p)}set minZoom(n){K(this.#p,n)}#y=k(()=>t.props.maxZoom??2);get maxZoom(){return h(this.#y)}set maxZoom(n){K(this.#y,n)}#b=k(()=>t.props.nodeOrigin??[0,0]);get nodeOrigin(){return h(this.#b)}set nodeOrigin(n){K(this.#b,n)}#w=k(()=>t.props.nodeExtent??Zn);get nodeExtent(){return h(this.#w)}set nodeExtent(n){K(this.#w,n)}#x=k(()=>t.props.translateExtent??Zn);get translateExtent(){return h(this.#x)}set translateExtent(n){K(this.#x,n)}#_=k(()=>t.props.defaultEdgeOptions??{});get defaultEdgeOptions(){return h(this.#_)}set defaultEdgeOptions(n){K(this.#_,n)}#E=k(()=>t.props.nodeDragThreshold??1);get nodeDragThreshold(){return h(this.#E)}set nodeDragThreshold(n){K(this.#E,n)}#k=k(()=>t.props.autoPanOnNodeDrag??!0);get autoPanOnNodeDrag(){return h(this.#k)}set autoPanOnNodeDrag(n){K(this.#k,n)}#C=k(()=>t.props.autoPanOnConnect??!0);get autoPanOnConnect(){return h(this.#C)}set autoPanOnConnect(n){K(this.#C,n)}#N=k(()=>t.props.autoPanOnNodeFocus??!0);get autoPanOnNodeFocus(){return h(this.#N)}set autoPanOnNodeFocus(n){K(this.#N,n)}#S=k(()=>t.props.autoPanSpeed??15);get autoPanSpeed(){return h(this.#S)}set autoPanSpeed(n){K(this.#S,n)}#P=k(()=>t.props.connectionDragThreshold??1);get connectionDragThreshold(){return h(this.#P)}set connectionDragThreshold(n){K(this.#P,n)}fitViewQueued=t.props.fitView??!1;fitViewOptions=t.props.fitViewOptions;fitViewResolver=null;#O=k(()=>t.props.snapGrid??null);get snapGrid(){return h(this.#O)}set snapGrid(n){K(this.#O,n)}#M=fe(!1);get dragging(){return h(this.#M)}set dragging(n){K(this.#M,n)}#I=fe(null);get selectionRect(){return h(this.#I)}set selectionRect(n){K(this.#I,n)}#D=fe(!1);get selectionKeyPressed(){return h(this.#D)}set selectionKeyPressed(n){K(this.#D,n)}#T=fe(!1);get multiselectionKeyPressed(){return h(this.#T)}set multiselectionKeyPressed(n){K(this.#T,n)}#z=fe(!1);get deleteKeyPressed(){return h(this.#z)}set deleteKeyPressed(n){K(this.#z,n)}#A=fe(!1);get panActivationKeyPressed(){return h(this.#A)}set panActivationKeyPressed(n){K(this.#A,n)}#R=fe(!1);get zoomActivationKeyPressed(){return h(this.#R)}set zoomActivationKeyPressed(n){K(this.#R,n)}#L=fe(null);get selectionRectMode(){return h(this.#L)}set selectionRectMode(n){K(this.#L,n)}#V=fe("");get ariaLiveMessage(){return h(this.#V)}set ariaLiveMessage(n){K(this.#V,n)}#H=k(()=>t.props.selectionMode??Mt.Partial);get selectionMode(){return h(this.#H)}set selectionMode(n){K(this.#H,n)}#j=k(()=>({...fi,...t.props.nodeTypes}));get nodeTypes(){return h(this.#j)}set nodeTypes(n){K(this.#j,n)}#B=k(()=>({...hi,...t.props.edgeTypes}));get edgeTypes(){return h(this.#B)}set edgeTypes(n){K(this.#B,n)}#q=k(()=>t.props.noPanClass??"nopan");get noPanClass(){return h(this.#q)}set noPanClass(n){K(this.#q,n)}#F=k(()=>t.props.noDragClass??"nodrag");get noDragClass(){return h(this.#F)}set noDragClass(n){K(this.#F,n)}#K=k(()=>t.props.noWheelClass??"nowheel");get noWheelClass(){return h(this.#K)}set noWheelClass(n){K(this.#K,n)}#Y=k(()=>Ws(t.props.ariaLabelConfig));get ariaLabelConfig(){return h(this.#Y)}set ariaLabelConfig(n){K(this.#Y,n)}#G=fe(Ja(this.nodesInitialized,t.props.fitView,t.props.initialViewport,this.width,this.height,this.nodeLookup));get _viewport(){return h(this.#G)}set _viewport(n){K(this.#G,n)}get viewport(){return t.viewport??this._viewport}set viewport(n){t.viewport&&(t.viewport=n),this._viewport=n}#Z=fe(Wn);get _connection(){return h(this.#Z)}set _connection(n){K(this.#Z,n)}#W=k(()=>this._connection.inProgress?{...this._connection,to:wt(this._connection.to,[this.viewport.x,this.viewport.y,this.viewport.zoom])}:this._connection);get connection(){return h(this.#W)}set connection(n){K(this.#W,n)}#X=k(()=>t.props.connectionMode??tt.Strict);get connectionMode(){return h(this.#X)}set connectionMode(n){K(this.#X,n)}#U=k(()=>t.props.connectionRadius??20);get connectionRadius(){return h(this.#U)}set connectionRadius(n){K(this.#U,n)}#Q=k(()=>t.props.isValidConnection??(()=>!0));get isValidConnection(){return h(this.#Q)}set isValidConnection(n){K(this.#Q,n)}#J=k(()=>t.props.selectNodesOnDrag??!0);get selectNodesOnDrag(){return h(this.#J)}set selectNodesOnDrag(n){K(this.#J,n)}#$=k(()=>t.props.defaultMarkerColor===void 0?"#b1b1b7":t.props.defaultMarkerColor);get defaultMarkerColor(){return h(this.#$)}set defaultMarkerColor(n){K(this.#$,n)}#ee=k(()=>sa(t.edges,{defaultColor:this.defaultMarkerColor,id:this.flowId,defaultMarkerStart:this.defaultEdgeOptions.markerStart,defaultMarkerEnd:this.defaultEdgeOptions.markerEnd}));get markers(){return h(this.#ee)}set markers(n){K(this.#ee,n)}#te=k(()=>t.props.onlyRenderVisibleElements??!1);get onlyRenderVisibleElements(){return h(this.#te)}set onlyRenderVisibleElements(n){K(this.#te,n)}#ne=k(()=>t.props.onflowerror??Fs);get onerror(){return h(this.#ne)}set onerror(n){K(this.#ne,n)}#oe=k(()=>t.props.ondelete);get ondelete(){return h(this.#oe)}set ondelete(n){K(this.#oe,n)}#re=k(()=>t.props.onbeforedelete);get onbeforedelete(){return h(this.#re)}set onbeforedelete(n){K(this.#re,n)}#ie=k(()=>t.props.onbeforeconnect);get onbeforeconnect(){return h(this.#ie)}set onbeforeconnect(n){K(this.#ie,n)}#se=k(()=>t.props.onconnect);get onconnect(){return h(this.#se)}set onconnect(n){K(this.#se,n)}#ae=k(()=>t.props.onconnectstart);get onconnectstart(){return h(this.#ae)}set onconnectstart(n){K(this.#ae,n)}#le=k(()=>t.props.onconnectend);get onconnectend(){return h(this.#le)}set onconnectend(n){K(this.#le,n)}#de=k(()=>t.props.onbeforereconnect);get onbeforereconnect(){return h(this.#de)}set onbeforereconnect(n){K(this.#de,n)}#ce=k(()=>t.props.onreconnect);get onreconnect(){return h(this.#ce)}set onreconnect(n){K(this.#ce,n)}#ue=k(()=>t.props.onreconnectstart);get onreconnectstart(){return h(this.#ue)}set onreconnectstart(n){K(this.#ue,n)}#fe=k(()=>t.props.onreconnectend);get onreconnectend(){return h(this.#fe)}set onreconnectend(n){K(this.#fe,n)}#he=k(()=>t.props.clickConnect??!0);get clickConnect(){return h(this.#he)}set clickConnect(n){K(this.#he,n)}#ge=k(()=>t.props.onclickconnectstart);get onclickconnectstart(){return h(this.#ge)}set onclickconnectstart(n){K(this.#ge,n)}#me=k(()=>t.props.onclickconnectend);get onclickconnectend(){return h(this.#me)}set onclickconnectend(n){K(this.#me,n)}#ve=fe(null);get clickConnectStartHandle(){return h(this.#ve)}set clickConnectStartHandle(n){K(this.#ve,n)}#pe=k(()=>t.props.onselectiondrag);get onselectiondrag(){return h(this.#pe)}set onselectiondrag(n){K(this.#pe,n)}#ye=k(()=>t.props.onselectiondragstart);get onselectiondragstart(){return h(this.#ye)}set onselectiondragstart(n){K(this.#ye,n)}#be=k(()=>t.props.onselectiondragstop);get onselectiondragstop(){return h(this.#be)}set onselectiondragstop(n){K(this.#be,n)}resolveFitView=async()=>{this.panZoom&&(await js({nodes:this.nodeLookup,width:this.width,height:this.height,panZoom:this.panZoom,minZoom:this.minZoom,maxZoom:this.maxZoom},this.fitViewOptions),this.fitViewResolver?.resolve(!0),this.fitViewQueued=!1,this.fitViewOptions=void 0,this.fitViewResolver=null)};_prefersDark=new Si("(prefers-color-scheme: dark)",t.props.colorModeSSR==="dark");#we=k(()=>t.props.colorMode==="system"?this._prefersDark.current?"dark":"light":t.props.colorMode??"light");get colorMode(){return h(this.#we)}set colorMode(n){K(this.#we,n)}constructor(){}resetStoreValues(){this.dragging=!1,this.selectionRect=null,this.selectionRectMode=null,this.selectionKeyPressed=!1,this.multiselectionKeyPressed=!1,this.deleteKeyPressed=!1,this.panActivationKeyPressed=!1,this.zoomActivationKeyPressed=!1,this._connection=Wn,this.clickConnectStartHandle=null,this.viewport=t.props.initialViewport??{x:0,y:0,zoom:1},this.ariaLiveMessage=""}}return new e}function Ge(){const t=ut(Qn);if(!t)throw new Error("To call useStore outside of <SvelteFlow /> you need to wrap your component in a <SvelteFlowProvider />");return t.getStore()}const Qn=Symbol();function el(t){const e=$a(t);function o(m){e.nodeTypes={...fi,...m}}function n(m){e.edgeTypes={...hi,...m}}function s(m){e.edges=ta(m,e.edges)}const i=(m,N=!1)=>{e.nodes=e.nodes.map(v=>{const I=m.get(v.id);return I?{...v,position:I.position,dragging:N}:v})};function r(m){const{changes:N,updatedInternals:v}=ma(m,e.nodeLookup,e.parentLookup,e.domNode,e.nodeOrigin);if(!v)return;da(e.nodeLookup,e.parentLookup,{nodeOrigin:e.nodeOrigin,nodeExtent:e.nodeExtent}),e.fitViewQueued&&e.resolveFitView();const I=new Map;for(const P of N){const V=e.nodeLookup.get(P.id)?.internals.userNode;if(!V)continue;const B={...V};switch(P.type){case"dimensions":{const j={...B.measured,...P.dimensions};P.setAttributes&&(B.width=P.dimensions?.width??B.width,B.height=P.dimensions?.height??B.height),B.measured=j;break}case"position":B.position=P.position??B.position;break}I.set(P.id,B)}e.nodes=e.nodes.map(P=>I.get(P.id)??P)}function l(m){const N=e.fitViewResolver??Promise.withResolvers();return e.fitViewQueued=!0,e.fitViewOptions=m,e.fitViewResolver=N,e.nodes=[...e.nodes],N.promise}async function c(m,N,v){const I=typeof v?.zoom<"u"?v.zoom:e.maxZoom,P=e.panZoom;return P?(await P.setViewport({x:e.width/2-m*I,y:e.height/2-N*I,zoom:I},{duration:v?.duration,ease:v?.ease,interpolate:v?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)}function d(m,N){const v=e.panZoom;return v?v.scaleBy(m,N):Promise.resolve(!1)}function a(m){return d(1.2,m)}function u(m){return d(1/1.2,m)}function f(m){const N=e.panZoom;N&&(N.setScaleExtent([m,e.maxZoom]),e.minZoom=m)}function g(m){const N=e.panZoom;N&&(N.setScaleExtent([e.minZoom,m]),e.maxZoom=m)}function b(m){const N=e.panZoom;N&&(N.setTranslateExtent(m),e.translateExtent=m)}function _(m){e.panZoom?.setClickDistance(m)}function y(m,N=null){let v=!1;const I=m.map(P=>(N?N.has(P.id):!0)&&P.selected?(v=!0,{...P,selected:!1}):P);return[v,I]}function w(m){const N=m?.nodes?new Set(m.nodes.map(j=>j.id)):null,[v,I]=y(e.nodes,N);v&&(e.nodes=I);const P=m?.edges?new Set(m.edges.map(j=>j.id)):null,[V,B]=y(e.edges,P);V&&(e.edges=B)}function p(m){const N=e.multiselectionKeyPressed;e.nodes=e.nodes.map(v=>{const I=m.includes(v.id),P=N&&v.selected||I;return!!v.selected!==P?{...v,selected:P}:v}),N||w({nodes:[]})}function O(m){const N=e.multiselectionKeyPressed;e.edges=e.edges.map(v=>{const I=m.includes(v.id),P=N&&v.selected||I;return!!v.selected!==P?{...v,selected:P}:v}),N||w({edges:[]})}function x(m,N,v){const I=e.nodeLookup.get(m);if(!I){console.warn("012",ht.error012(m));return}e.selectionRect=null,e.selectionRectMode=null,I.selected?(N||I.selected&&e.multiselectionKeyPressed)&&(w({nodes:[I],edges:[]}),requestAnimationFrame(()=>v?.blur())):p([m])}function T(m){const N=e.edgeLookup.get(m);if(!N){console.warn("012",ht.error012(m));return}(N.selectable||e.elementsSelectable&&typeof N.selectable>"u")&&(e.selectionRect=null,e.selectionRectMode=null,N.selected?N.selected&&e.multiselectionKeyPressed&&w({nodes:[],edges:[N]}):O([m]))}function S(m,N){const{nodeExtent:v,snapGrid:I,nodeOrigin:P,nodeLookup:V,nodesDraggable:B,onerror:j}=e,q=new Map,Y=I?.[0]??5,X=I?.[1]??5,D=m.x*Y*N,A=m.y*X*N;for(const L of V.values()){if(!(L.selected&&(L.draggable||B&&typeof L.draggable>"u")))continue;let F={x:L.internals.positionAbsolute.x+D,y:L.internals.positionAbsolute.y+A};I&&(F=bt(F,I));const{position:G,positionAbsolute:Q}=Yr({nodeId:L.id,nextPosition:F,nodeLookup:V,nodeExtent:v,nodeOrigin:P,onError:j});L.position=G,L.internals.positionAbsolute=Q,q.set(L.id,L)}i(q)}function M(m){return va({delta:m,panZoom:e.panZoom,transform:[e.viewport.x,e.viewport.y,e.viewport.zoom],translateExtent:e.translateExtent,width:e.width,height:e.height})}const E=m=>{e._connection={...m}};function C(){e._connection=Wn}function z(){e.resetStoreValues(),w()}return Object.assign(e,{setNodeTypes:o,setEdgeTypes:n,addEdge:s,updateNodePositions:i,updateNodeInternals:r,zoomIn:a,zoomOut:u,fitView:l,setCenter:c,setMinZoom:f,setMaxZoom:g,setTranslateExtent:b,setPaneClickDistance:_,unselectNodesAndEdges:w,addSelectedNodes:p,addSelectedEdges:O,handleNodeSelection:x,handleEdgeSelection:T,moveSelectedNodes:S,panBy:M,updateConnection:E,cancelConnection:C,reset:z})}function tl(t,e){const{minZoom:o,maxZoom:n,initialViewport:s,onPanZoomStart:i,onPanZoom:r,onPanZoomEnd:l,translateExtent:c,paneClickDistance:d,setPanZoomInstance:a,onDraggingChange:u,onTransformChange:f}=e,g=Ta({domNode:t,minZoom:o,maxZoom:n,translateExtent:c,viewport:s,paneClickDistance:d,onPanZoom:r,onPanZoomStart:i,onPanZoomEnd:l,onDraggingChange:u}),b=g.getViewport();return(s.x!==b.x||s.y!==b.y||s.zoom!==b.zoom)&&f([b.x,b.y,b.zoom]),a(g),g.update(e),{update(_){g.update(_)}}}var nl=se('<div class="svelte-flow__zoom svelte-flow__container"><!></div>');function ol(t,e){ne(e,!0);let o=Z(e,"store",15),n=k(()=>o().panActivationKeyPressed||e.panOnDrag),s=k(()=>o().panActivationKeyPressed||e.panOnScroll);const{viewport:i}=o();let r=!1;Be(()=>{!r&&o().viewportInitialized&&(e.oninit?.(),r=!0)});var l=nl(),c=J(l);Ce(c,()=>e.children),U(l),xe(l,(d,a)=>tl?.(d,a),()=>({viewport:o().viewport,minZoom:o().minZoom,maxZoom:o().maxZoom,initialViewport:i,onDraggingChange:d=>{o(o().dragging=d,!0)},setPanZoomInstance:d=>{o(o().panZoom=d,!0)},onPanZoomStart:e.onmovestart,onPanZoom:e.onmove,onPanZoomEnd:e.onmoveend,zoomOnScroll:e.zoomOnScroll,zoomOnDoubleClick:e.zoomOnDoubleClick,zoomOnPinch:e.zoomOnPinch,panOnScroll:h(s),panOnDrag:h(n),panOnScrollSpeed:e.panOnScrollSpeed,panOnScrollMode:e.panOnScrollMode,zoomActivationKeyPressed:o().zoomActivationKeyPressed,preventScrolling:typeof e.preventScrolling=="boolean"?e.preventScrolling:!0,noPanClassName:o().noPanClass,noWheelClassName:o().noWheelClass,userSelectionActive:!!o().selectionRect,translateExtent:o().translateExtent,lib:"svelte",paneClickDistance:e.paneClickDistance,onTransformChange:d=>{o(o().viewport={x:d[0],y:d[1],zoom:d[2]},!0)},connectionInProgress:o().connection.inProgress})),W(t,l),oe()}function Sr(t,e){return o=>{o.target===e&&t?.(o)}}function Pr(t){return e=>{const o=t.has(e.id);return!!e.selected!==o?{...e,selected:o}:e}}function Or(t,e){if(t.size!==e.size)return!1;for(const o of t)if(!e.has(o))return!1;return!0}var rl=se("<div><!></div>");function il(t,e){ne(e,!0);let o=Z(e,"store",15),n=Z(e,"panOnDrag",3,!0),s,i=null,r=new Set,l=new Set,c=k(()=>o().panActivationKeyPressed||n()),d=k(()=>o().selectionKeyPressed||o().selectionRect||e.selectionOnDrag&&h(c)!==!0),a=k(()=>o().elementsSelectable&&(h(d)||o().selectionRectMode==="user")),u=!1;function f(M){if(u||o().connection.inProgress){u=!1;return}e.onpaneclick?.({event:M}),o().unselectNodesAndEdges(),o(o().selectionRectMode=null,!0)}function g(M){i=s?.getBoundingClientRect();const E=M.target!==s&&!!M.target.closest(".nokey"),C=e.selectionOnDrag&&s===M.target||!e.selectionOnDrag||o().selectionKeyPressed;if(!o().elementsSelectable||!h(d)||M.button!==0||!i||E||!C||!M.isPrimary)return;M.stopPropagation(),M.preventDefault(),M.target?.setPointerCapture?.(M.pointerId);const{x:z,y:R}=Se(M,i);o().unselectNodesAndEdges(),o(o().selectionRect={width:0,height:0,startX:z,startY:R,x:z,y:R},!0),e.onselectionstart?.(M)}function b(M){if(!h(d)||!i||!o().selectionRect)return;u=!0;const E=Se(M,i),{startX:C=0,startY:z=0}=o().selectionRect,R={...o().selectionRect,x:E.x<C?E.x:C,y:E.y<z?E.y:z,width:Math.abs(E.x-C),height:Math.abs(E.y-z)},m=r,N=l;r=new Set(ro(o().nodeLookup,R,[o().viewport.x,o().viewport.y,o().viewport.zoom],o().selectionMode===Mt.Partial,!0).map(I=>I.id));const v=o().defaultEdgeOptions.selectable??!0;l=new Set;for(const I of r){const P=o().connectionLookup.get(I);if(P)for(const{edgeId:V}of P.values()){const B=o().edgeLookup.get(V);B&&(B.selectable??v)&&l.add(V)}}Or(m,r)||o(o().nodes=o().nodes.map(Pr(r)),!0),Or(N,l)||o(o().edges=o().edges.map(Pr(l)),!0),o(o().selectionRectMode="user",!0),o(o().selectionRect=R,!0)}function _(M){M.button===0&&(M.target?.releasePointerCapture?.(M.pointerId),!h(d)&&o().selectionRectMode==="user"&&M.target===s&&f?.(M),o(o().selectionRect=null,!0),r.size>0&&o(o().selectionRectMode="nodes",!0),o().selectionKeyPressed&&(u=!1),e.onselectionend?.(M))}const y=M=>{if(Array.isArray(h(c))&&h(c).includes(2)){M.preventDefault();return}e.onpanecontextmenu?.({event:M})},w=M=>{(e.selectionOnDrag&&s===M.target||!e.selectionOnDrag||o().selectionKeyPressed)&&M.stopPropagation()};var p=rl();let O;var x=k(()=>h(a)?void 0:Sr(f,s));p.__click=function(...M){h(x)?.apply(this,M)},p.__pointermove=function(...M){(h(a)?b:void 0)?.apply(this,M)},p.__pointerup=function(...M){(h(a)?_:void 0)?.apply(this,M)};var T=k(()=>Sr(y,s));p.__contextmenu=function(...M){h(T)?.apply(this,M)};var S=J(p);Ce(S,()=>e.children),U(p),pt(p,M=>s=M,()=>s),ue(M=>O=je(p,1,"svelte-flow__pane svelte-flow__container",null,O,M),[()=>({draggable:n()===!0||Array.isArray(n())&&n().includes(0),dragging:o().dragging,selection:h(d)})]),St("pointerdown",p,function(...M){(h(a)?g:void 0)?.apply(this,M)},!0),St("click",p,function(...M){(h(a)?w:void 0)?.apply(this,M)},!0),W(t,p),oe()}Dr(["click","pointermove","pointerup","contextmenu"]);var sl=se('<div class="svelte-flow__viewport xyflow__viewport svelte-flow__container"><!></div>');function al(t,e){ne(e,!0);var o=sl();let n;var s=J(o);Ce(s,()=>e.children),U(o),ue(i=>n=Ie(o,"",n,i),[()=>({transform:`translate(${e.store.viewport.x??""}px, ${e.store.viewport.y??""}px) scale(${e.store.viewport.zoom??""})`})]),W(t,o),oe()}function gi(t,e){const{store:o,onDrag:n,onDragStart:s,onDragStop:i,onNodeMouseDown:r}=e,l=wa({onDrag:n,onDragStart:s,onDragStop:i,onNodeMouseDown:r,getStoreItems:()=>{const{snapGrid:d,viewport:a}=o;return{nodes:o.nodes,nodeLookup:o.nodeLookup,edges:o.edges,nodeExtent:o.nodeExtent,snapGrid:d||[0,0],snapToGrid:!!d,nodeOrigin:o.nodeOrigin,multiSelectionActive:o.multiselectionKeyPressed,domNode:o.domNode,transform:[a.x,a.y,a.zoom],autoPanOnNodeDrag:o.autoPanOnNodeDrag,nodesDraggable:o.nodesDraggable,selectNodesOnDrag:o.selectNodesOnDrag,nodeDragThreshold:o.nodeDragThreshold,unselectNodesAndEdges:o.unselectNodesAndEdges,updateNodePositions:o.updateNodePositions,onSelectionDrag:o.onselectiondrag,onSelectionDragStart:o.onselectiondragstart,onSelectionDragStop:o.onselectiondragstop,panBy:o.panBy}}});function c(d,a){if(a.disabled){l.destroy();return}l.update({domNode:d,noDragClassName:a.noDragClass,handleSelector:a.handleSelector,nodeId:a.nodeId,isSelectable:a.isSelectable,nodeClickDistance:a.nodeClickDistance})}return c(t,e),{update(d){c(t,d)},destroy(){l.destroy()}}}var ll=se('<div aria-live="assertive" aria-atomic="true" class="a11y-live-msg svelte-gvaja3"> </div>'),dl=se('<div class="a11y-hidden svelte-gvaja3"> </div> <div class="a11y-hidden svelte-gvaja3"> </div> <!>',1);function cl(t,e){ne(e,!0);var o=dl(),n=ce(o),s=J(n,!0);U(n);var i=ee(n,2),r=J(i,!0);U(i);var l=ee(i,2);{var c=d=>{var a=ll(),u=J(a,!0);U(a),ue(()=>{ie(a,"id",`${ul}-${e.store.flowId}`),pe(u,e.store.ariaLiveMessage)}),W(d,a)};he(l,d=>{e.store.disableKeyboardA11y||d(c)})}ue(()=>{ie(n,"id",`${mi}-${e.store.flowId}`),pe(s,e.store.disableKeyboardA11y?e.store.ariaLabelConfig["node.a11yDescription.default"]:e.store.ariaLabelConfig["node.a11yDescription.keyboardDisabled"]),ie(i,"id",`${vi}-${e.store.flowId}`),pe(r,e.store.ariaLabelConfig["edge.a11yDescription.default"])}),W(t,o),oe()}const mi="svelte-flow__node-desc",vi="svelte-flow__edge-desc",ul="svelte-flow__aria-live";var fl=se("<div><!></div>");function hl(t,e){ne(e,!0);let o=Z(e,"store",15),n=k(()=>be(e.node.data,()=>({}),!0)),s=k(()=>be(e.node.selected,!1)),i=k(()=>e.node.draggable),r=k(()=>e.node.selectable),l=k(()=>be(e.node.deletable,!0)),c=k(()=>e.node.connectable),d=k(()=>e.node.focusable),a=k(()=>be(e.node.hidden,!1)),u=k(()=>be(e.node.dragging,!1)),f=k(()=>be(e.node.style,"")),g=k(()=>e.node.class),b=k(()=>be(e.node.type,"default")),_=k(()=>e.node.parentId),y=k(()=>e.node.sourcePosition),w=k(()=>e.node.targetPosition),p=k(()=>be(e.node.measured,()=>({width:0,height:0}),!0).width),O=k(()=>be(e.node.measured,()=>({width:0,height:0}),!0).height),x=k(()=>e.node.initialWidth),T=k(()=>e.node.initialHeight),S=k(()=>e.node.width),M=k(()=>e.node.height),E=k(()=>e.node.dragHandle),C=k(()=>be(e.node.internals.z,0)),z=k(()=>e.node.internals.positionAbsolute.x),R=k(()=>e.node.internals.positionAbsolute.y),m=k(()=>e.node.internals.userNode),{id:N}=e.node,v=k(()=>h(i)??o().nodesDraggable),I=k(()=>h(r)??o().elementsSelectable),P=k(()=>h(c)??o().nodesConnectable),V=k(()=>Gs(e.node)),B=k(()=>!!e.node.internals.handleBounds),j=k(()=>h(V)&&h(B)),q=k(()=>h(d)??o().nodesFocusable);function Y(de){return o().parentLookup.has(de)}let X=k(()=>Y(N)),D=fe(null),A=null,L=h(b),H=h(y),F=h(w),G=k(()=>o().nodeTypes[h(b)]??ci),Q=k(()=>o().ariaLabelConfig);Pt("svelteflow__node_connectable",{get value(){return h(P)}}),Pt("svelteflow__node_id",N);let ae=k(()=>{const de=h(p)===void 0?h(S)??h(x):h(S),ye=h(O)===void 0?h(M)??h(T):h(M);if(!(de===void 0&&ye===void 0&&h(f)===void 0))return`${h(f)};${de?`width:${De(de)};`:""}${ye?`height:${De(ye)};`:""}`});Be(()=>{(h(b)!==L||h(y)!==H||h(w)!==F)&&h(D)!==null&&requestAnimationFrame(()=>{h(D)!==null&&o().updateNodeInternals(new Map([[N,{id:N,nodeElement:h(D),force:!0}]]))}),L=h(b),H=h(y),F=h(w)}),Be(()=>{e.resizeObserver&&(!h(j)||h(D)!==A)&&(A&&e.resizeObserver.unobserve(A),h(D)&&e.resizeObserver.observe(h(D)),A=h(D))}),Jn(()=>{A&&e.resizeObserver?.unobserve(A)});function re(de){h(I)&&(!o().selectNodesOnDrag||!h(v)||o().nodeDragThreshold>0)&&o().handleNodeSelection(N),e.onnodeclick?.({node:h(m),event:de})}function te(de){if(!(Ur(de)||o().disableKeyboardA11y))if(Fr.includes(de.key)&&h(I)){const ye=de.key==="Escape";o().handleNodeSelection(N,ye,h(D))}else h(v)&&e.node.selected&&Object.prototype.hasOwnProperty.call(zt,de.key)&&(de.preventDefault(),o(o().ariaLiveMessage=h(Q)["node.a11yDescription.ariaLiveMessage"]({direction:de.key.replace("Arrow","").toLowerCase(),x:~~e.node.internals.positionAbsolute.x,y:~~e.node.internals.positionAbsolute.y}),!0),o().moveSelectedNodes(zt[de.key],de.shiftKey?4:1))}const ge=()=>{if(o().disableKeyboardA11y||!o().autoPanOnNodeFocus||!h(D)?.matches(":focus-visible"))return;const{width:de,height:ye,viewport:We}=o();ro(new Map([[N,e.node]]),{x:0,y:0,width:de,height:ye},[We.x,We.y,We.zoom],!0).length>0||o().setCenter(e.node.position.x+(e.node.measured.width??0)/2,e.node.position.y+(e.node.measured.height??0)/2,{zoom:We.zoom})};var Te=ke(),Ae=ce(Te);{var Ze=de=>{var ye=fl();He(ye,(we,Re)=>({"data-id":N,class:["svelte-flow__node",`svelte-flow__node-${h(b)}`,h(g)],style:h(ae),onclick:re,onpointerenter:e.onnodepointerenter?_e=>e.onnodepointerenter({node:h(m),event:_e}):void 0,onpointerleave:e.onnodepointerleave?_e=>e.onnodepointerleave({node:h(m),event:_e}):void 0,onpointermove:e.onnodepointermove?_e=>e.onnodepointermove({node:h(m),event:_e}):void 0,oncontextmenu:e.onnodecontextmenu?_e=>e.onnodecontextmenu({node:h(m),event:_e}):void 0,onkeydown:h(q)?te:void 0,onfocus:h(q)?ge:void 0,tabIndex:h(q)?0:void 0,role:e.node.ariaRole??(h(q)?"group":void 0),"aria-roledescription":"node","aria-describedby":o().disableKeyboardA11y?void 0:`${mi}-${o().flowId}`,...e.node.domAttributes,[$n]:we,[At]:Re}),[()=>({dragging:h(u),selected:h(s),draggable:h(v),connectable:h(P),selectable:h(I),nopan:h(v),parent:h(X)}),()=>({"z-index":h(C),transform:`translate(${h(z)??""}px, ${h(R)??""}px)`,visibility:h(V)?"visible":"hidden"})]);var We=J(ye);eo(We,()=>h(G),(we,Re)=>{Re(we,{get data(){return h(n)},get id(){return N},get selected(){return h(s)},get selectable(){return h(I)},get deletable(){return h(l)},get sourcePosition(){return h(y)},get targetPosition(){return h(w)},get zIndex(){return h(C)},get dragging(){return h(u)},get draggable(){return h(v)},get dragHandle(){return h(E)},get parentId(){return h(_)},get type(){return h(b)},get isConnectable(){return h(P)},get positionAbsoluteX(){return h(z)},get positionAbsoluteY(){return h(R)},get width(){return h(S)},get height(){return h(M)}})}),U(ye),xe(ye,(we,Re)=>gi?.(we,Re),()=>({nodeId:N,isSelectable:h(I),disabled:!h(v),handleSelector:h(E),noDragClass:o().noDragClass,nodeClickDistance:e.nodeClickDistance,onNodeMouseDown:o().handleNodeSelection,onDrag:(we,Re,_e,lt)=>{e.onnodedrag?.({event:we,targetNode:_e,nodes:lt})},onDragStart:(we,Re,_e,lt)=>{e.onnodedragstart?.({event:we,targetNode:_e,nodes:lt})},onDragStop:(we,Re,_e,lt)=>{e.onnodedragstop?.({event:we,targetNode:_e,nodes:lt})},store:o()})),pt(ye,we=>K(D,we),()=>h(D)),W(de,ye)};he(Ae,de=>{h(a)||de(Ze)})}W(t,Te),oe()}var gl=se('<div class="svelte-flow__nodes"></div>');function ml(t,e){ne(e,!0);let o=Z(e,"store",15);const n=typeof ResizeObserver>"u"?null:new ResizeObserver(i=>{const r=new Map;i.forEach(l=>{const c=l.target.getAttribute("data-id");r.set(c,{id:c,nodeElement:l.target,force:!0})}),o().updateNodeInternals(r)});Jn(()=>{n?.disconnect()});var s=gl();Rt(s,21,()=>o().visible.nodes.values(),i=>i.id,(i,r)=>{hl(i,{get node(){return h(r)},get resizeObserver(){return n},get nodeClickDistance(){return e.nodeClickDistance},get onnodeclick(){return e.onnodeclick},get onnodepointerenter(){return e.onnodepointerenter},get onnodepointermove(){return e.onnodepointermove},get onnodepointerleave(){return e.onnodepointerleave},get onnodedrag(){return e.onnodedrag},get onnodedragstart(){return e.onnodedragstart},get onnodedragstop(){return e.onnodedragstop},get onnodecontextmenu(){return e.onnodecontextmenu},get store(){return o()},set store(l){o(l)}})}),U(s),W(t,s),oe()}var vl=ve('<svg class="svelte-flow__edge-wrapper"><g><!></g></svg>');function pl(t,e){ne(e,!0);let o=k(()=>e.edge.source),n=k(()=>e.edge.target),s=k(()=>e.edge.sourceX),i=k(()=>e.edge.sourceY),r=k(()=>e.edge.targetX),l=k(()=>e.edge.targetY),c=k(()=>e.edge.sourcePosition),d=k(()=>e.edge.targetPosition),a=k(()=>be(e.edge.animated,!1)),u=k(()=>be(e.edge.selected,!1)),f=k(()=>e.edge.label),g=k(()=>e.edge.labelStyle),b=k(()=>be(e.edge.data,()=>({}),!0)),_=k(()=>e.edge.style),y=k(()=>e.edge.interactionWidth),w=k(()=>be(e.edge.type,"default")),p=k(()=>e.edge.sourceHandle),O=k(()=>e.edge.targetHandle),x=k(()=>e.edge.markerStart),T=k(()=>e.edge.markerEnd),S=k(()=>e.edge.selectable),M=k(()=>e.edge.focusable),E=k(()=>be(e.edge.deletable,!0)),C=k(()=>e.edge.hidden),z=k(()=>e.edge.zIndex),R=k(()=>e.edge.class),m=k(()=>e.edge.ariaLabel),N=null;const{id:v}=e.edge;Pt("svelteflow__edge_id",v);let I=k(()=>h(S)??e.store.elementsSelectable),P=k(()=>h(M)??e.store.edgesFocusable),V=k(()=>e.store.edgeTypes[h(w)]??ui),B=k(()=>h(x)?`url('#${Un(h(x),e.store.flowId)}')`:void 0),j=k(()=>h(T)?`url('#${Un(h(T),e.store.flowId)}')`:void 0);function q(H){const F=e.store.edgeLookup.get(v);F&&(h(I)&&e.store.handleEdgeSelection(v),e.onedgeclick?.({event:H,edge:F}))}function Y(H,F){const G=e.store.edgeLookup.get(v);G&&F({event:H,edge:G})}function X(H){if(!e.store.disableKeyboardA11y&&Fr.includes(H.key)&&h(I)){const{unselectNodesAndEdges:F,addSelectedEdges:G}=e.store;H.key==="Escape"?(N?.blur(),F({edges:[e.edge]})):G([v])}}var D=ke(),A=ce(D);{var L=H=>{var F=vl();let G;var Q=J(F);He(Q,ae=>({class:["svelte-flow__edge",h(R)],"data-id":v,onclick:q,oncontextmenu:e.onedgecontextmenu?re=>{Y(re,e.onedgecontextmenu)}:void 0,onpointerenter:e.onedgepointerenter?re=>{Y(re,e.onedgepointerenter)}:void 0,onpointerleave:e.onedgepointerleave?re=>{Y(re,e.onedgepointerleave)}:void 0,"aria-label":h(m)===null?void 0:h(m)?h(m):`Edge from ${h(o)} to ${h(n)}`,"aria-describedby":h(P)?`${vi}-${e.store.flowId}`:void 0,role:e.edge.ariaRole??(h(P)?"group":"img"),"aria-roledescription":"edge",onkeydown:h(P)?X:void 0,tabindex:h(P)?0:void 0,...e.edge.domAttributes,[$n]:ae}),[()=>({animated:h(a),selected:h(u),selectable:h(I)})]);var le=J(Q);eo(le,()=>h(V),(ae,re)=>{re(ae,{get id(){return v},get source(){return h(o)},get target(){return h(n)},get sourceX(){return h(s)},get sourceY(){return h(i)},get targetX(){return h(r)},get targetY(){return h(l)},get sourcePosition(){return h(c)},get targetPosition(){return h(d)},get animated(){return h(a)},get selected(){return h(u)},get label(){return h(f)},get labelStyle(){return h(g)},get data(){return h(b)},get style(){return h(_)},get interactionWidth(){return h(y)},get selectable(){return h(I)},get deletable(){return h(E)},get type(){return h(w)},get sourceHandleId(){return h(p)},get targetHandleId(){return h(O)},get markerStart(){return h(B)},get markerEnd(){return h(j)}})}),U(Q),pt(Q,ae=>N=ae,()=>N),U(F),ue(ae=>G=Ie(F,"",G,ae),[()=>({"z-index":h(z)})]),W(H,F)};he(A,H=>{h(C)||H(L)})}W(t,D),oe()}var yl=ve("<defs></defs>");function bl(t,e){ne(e,!1);const o=Ge();Mi();var n=yl();Rt(n,5,()=>o.markers,s=>s.id,(s,i)=>{El(s,Ue(()=>h(i)))}),U(n),W(t,n),oe()}var wl=ve('<polyline class="arrow" fill="none" stroke-linecap="round" stroke-linejoin="round" points="-5,-4 0,0 -5,4"></polyline>'),xl=ve('<polyline class="arrowclosed" stroke-linecap="round" stroke-linejoin="round" points="-5,-4 0,0 -5,4 -5,-4"></polyline>'),_l=ve('<marker class="svelte-flow__arrowhead" viewBox="-10 -10 20 20" refX="0" refY="0"><!></marker>');function El(t,e){ne(e,!0);let o=Z(e,"width",3,12.5),n=Z(e,"height",3,12.5),s=Z(e,"markerUnits",3,"strokeWidth"),i=Z(e,"orient",3,"auto-start-reverse"),r=Z(e,"color",3,"none");var l=_l(),c=J(l);{var d=u=>{var f=wl();let g;ue(b=>{ie(f,"stroke-width",e.strokeWidth),g=Ie(f,"",g,b)},[()=>({stroke:r()})]),W(u,f)},a=u=>{var f=ke(),g=ce(f);{var b=_=>{var y=xl();let w;ue(p=>{ie(y,"stroke-width",e.strokeWidth),w=Ie(y,"",w,p)},[()=>({stroke:r(),fill:r()})]),W(_,y)};he(g,_=>{e.type===nt.ArrowClosed&&_(b)},!0)}W(u,f)};he(c,u=>{e.type===nt.Arrow?u(d):u(a,!1)})}U(l),ue(()=>{ie(l,"id",e.id),ie(l,"markerWidth",`${o()}`),ie(l,"markerHeight",`${n()}`),ie(l,"markerUnits",s()),ie(l,"orient",i())}),W(t,l),oe()}var kl=se('<div class="svelte-flow__edges"><svg class="svelte-flow__marker"><!></svg> <!></div>');function Cl(t,e){ne(e,!0);let o=Z(e,"store",15);var n=kl(),s=J(n),i=J(s);bl(i,{}),U(s);var r=ee(s,2);Rt(r,17,()=>o().visible.edges.values(),l=>l.id,(l,c)=>{pl(l,{get edge(){return h(c)},get onedgeclick(){return e.onedgeclick},get onedgecontextmenu(){return e.onedgecontextmenu},get onedgepointerenter(){return e.onedgepointerenter},get onedgepointerleave(){return e.onedgepointerleave},get store(){return o()},set store(d){o(d)}})}),U(n),W(t,n),oe()}var Nl=se('<div class="svelte-flow__selection svelte-y6l0nj"></div>');function pi(t,e){ne(e,!0);let o=Z(e,"x",3,0),n=Z(e,"y",3,0),s=Z(e,"width",3,0),i=Z(e,"height",3,0),r=Z(e,"isVisible",3,!0);var l=ke(),c=ce(l);{var d=a=>{var u=Nl();let f;ue(g=>f=Ie(u,"",f,g),[()=>({width:typeof s()=="string"?s():De(s()),height:typeof i()=="string"?i():De(i()),transform:`translate(${o()}px, ${n()}px)`})]),W(a,u)};he(c,a=>{r()&&a(d)})}W(t,l),oe()}function Sl(t,e){const o=e.store.nodes.filter(n=>n.selected);e.onselectioncontextmenu?.({nodes:o,event:t})}function Pl(t,e){const o=e.store.nodes.filter(n=>n.selected);e.onselectionclick?.({nodes:o,event:t})}var Ol=se("<div><!></div>");function Ml(t,e){ne(e,!0);let o=fe(void 0);Be(()=>{e.store.disableKeyboardA11y||h(o)?.focus({preventScroll:!0})});let n=k(()=>e.store.selectionRectMode==="nodes"?(e.store.nodes,Lt(e.store.nodeLookup,{filter:c=>!!c.selected})):null);function s(c){Object.prototype.hasOwnProperty.call(zt,c.key)&&(c.preventDefault(),e.store.moveSelectedNodes(zt[c.key],c.shiftKey?4:1))}var i=ke(),r=ce(i);{var l=c=>{var d=Ol();d.__contextmenu=[Sl,e],d.__click=[Pl,e],d.__keydown=function(...f){(e.store.disableKeyboardA11y?void 0:s)?.apply(this,f)};let a;var u=J(d);pi(u,{width:"100%",height:"100%",x:0,y:0}),U(d),xe(d,(f,g)=>gi?.(f,g),()=>({disabled:!1,store:e.store,onDrag:(f,g,b,_)=>{e.onnodedrag?.({event:f,targetNode:null,nodes:_})},onDragStart:(f,g,b,_)=>{e.onnodedragstart?.({event:f,targetNode:null,nodes:_})},onDragStop:(f,g,b,_)=>{e.onnodedragstop?.({event:f,targetNode:null,nodes:_})}})),pt(d,f=>K(o,f),()=>h(o)),ue(f=>{je(d,1,at(["svelte-flow__selection-wrapper",e.store.noPanClass]),"svelte-13vgx7"),ie(d,"role",e.store.disableKeyboardA11y?void 0:"button"),ie(d,"tabindex",e.store.disableKeyboardA11y?void 0:-1),a=Ie(d,"",a,f)},[()=>({width:De(h(n).width),height:De(h(n).height),transform:`translate(${h(n).x??""}px, ${h(n).y??""}px)`})]),W(c,d)};he(r,c=>{e.store.selectionRectMode==="nodes"&&h(n)&&ze(h(n).x)&&ze(h(n).y)&&c(l)})}W(t,i),oe()}Dr(["contextmenu","click","keydown"]);function Il(t){switch(t){case"ctrl":return 8;case"shift":return 4;case"alt":return 2;case"meta":return 1}}function Oe(t,e){let{enabled:o=!0,trigger:n,type:s="keydown"}=e;function i(l){const c=Array.isArray(n)?n:[n],d=[l.metaKey,l.altKey,l.shiftKey,l.ctrlKey].reduce((a,u,f)=>u?a|1<<f:a,0);for(const a of c){const u={preventDefault:!1,enabled:!0,...a},{modifier:f,key:g,callback:b,preventDefault:_,enabled:y}=u;if(y){if(l.key!==g)continue;if(f===null||f===!1){if(d!==0)continue}else if(f!==void 0&&f?.[0]?.length>0){const p=Array.isArray(f)?f:[f];let O=!1;for(const x of p)if((Array.isArray(x)?x:[x]).reduce((S,M)=>S|Il(M),0)===d){O=!0;break}if(!O)continue}_&&l.preventDefault();const w={node:t,trigger:u,originalEvent:l};t.dispatchEvent(new CustomEvent("shortcut",{detail:w})),b?.(w)}}}let r;return o&&(r=uo(t,s,i)),{update:l=>{const{enabled:c=!0,type:d="keydown"}=l;o&&(!c||s!==d)?r?.():!o&&c&&(r=uo(t,d,i)),o=c,s=d,n=l.trigger},destroy:()=>{r?.()}}}function Dl(){const t=k(Ge),e=i=>{const r=Cr(i)?i:h(t).nodeLookup.get(i.id),l=r.parentId?Zs(r.position,r.measured,r.parentId,h(t).nodeLookup,h(t).nodeOrigin):r.position,c={...r,position:l,width:r.measured?.width??r.width,height:r.measured?.height??r.height};return rt(c)};function o(i,r,l={replace:!1}){h(t).nodes=ct(()=>h(t).nodes).map(c=>{if(c.id===i){const d=typeof r=="function"?r(c):r;return l?.replace&&Cr(d)?d:{...c,...d}}return c})}function n(i,r,l={replace:!1}){h(t).edges=ct(()=>h(t).edges).map(c=>{if(c.id===i){const d=typeof r=="function"?r(c):r;return l.replace&&Fa(d)?d:{...c,...d}}return c})}const s=i=>h(t).nodeLookup.get(i);return{zoomIn:h(t).zoomIn,zoomOut:h(t).zoomOut,getInternalNode:s,getNode:i=>s(i)?.internals.userNode,getNodes:i=>i===void 0?h(t).nodes:Mr(h(t).nodeLookup,i),getEdge:i=>h(t).edgeLookup.get(i),getEdges:i=>i===void 0?h(t).edges:Mr(h(t).edgeLookup,i),setZoom:(i,r)=>{const l=h(t).panZoom;return l?l.scaleTo(i,{duration:r?.duration}):Promise.resolve(!1)},getZoom:()=>h(t).viewport.zoom,setViewport:async(i,r)=>{const l=h(t).viewport;return h(t).panZoom?(await h(t).panZoom.setViewport({x:i.x??l.x,y:i.y??l.y,zoom:i.zoom??l.zoom},r),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>zr(h(t).viewport),setCenter:async(i,r,l)=>h(t).setCenter(i,r,l),fitView:i=>h(t).fitView(i),fitBounds:async(i,r)=>{if(!h(t).panZoom)return Promise.resolve(!1);const l=io(i,h(t).width,h(t).height,h(t).minZoom,h(t).maxZoom,r?.padding??.1);return await h(t).panZoom.setViewport(l,{duration:r?.duration,ease:r?.ease,interpolate:r?.interpolate}),Promise.resolve(!0)},getIntersectingNodes:(i,r=!0,l)=>{const c=hr(i),d=c?i:e(i);return d?(l||h(t).nodes).filter(a=>{const u=h(t).nodeLookup.get(a.id);if(!u||!c&&a.id===i.id)return!1;const f=rt(u),g=gt(f,d);return r&&g>0||g>=f.width*f.height||g>=d.width*d.height}):[]},isNodeIntersecting:(i,r,l=!0)=>{const d=hr(i)?i:e(i);if(!d)return!1;const a=gt(d,r);return l&&a>0||a>=r.width*r.height||a>=d.width*d.height},deleteElements:async({nodes:i=[],edges:r=[]})=>{const{nodes:l,edges:c}=await Bs({nodesToRemove:i,edgesToRemove:r,nodes:h(t).nodes,edges:h(t).edges,onBeforeDelete:h(t).onbeforedelete});return l&&(h(t).nodes=ct(()=>h(t).nodes).filter(d=>!l.some(({id:a})=>a===d.id))),c&&(h(t).edges=ct(()=>h(t).edges).filter(d=>!c.some(({id:a})=>a===d.id))),(l.length>0||c.length>0)&&h(t).ondelete?.({nodes:l,edges:c}),{deletedNodes:l,deletedEdges:c}},screenToFlowPosition:(i,r={snapToGrid:!0})=>{if(!h(t).domNode)return i;const l=r.snapToGrid?h(t).snapGrid:!1,{x:c,y:d,zoom:a}=h(t).viewport,{x:u,y:f}=h(t).domNode.getBoundingClientRect(),g={x:i.x-u,y:i.y-f};return wt(g,[c,d,a],l!==null,l||[1,1])},flowToScreenPosition:i=>{if(!h(t).domNode)return i;const{x:r,y:l,zoom:c}=h(t).viewport,{x:d,y:a}=h(t).domNode.getBoundingClientRect(),u=Dt(i,[r,l,c]);return{x:u.x+d,y:u.y+a}},toObject:()=>structuredClone({nodes:[...h(t).nodes],edges:[...h(t).edges],viewport:{...h(t).viewport}}),updateNode:o,updateNodeData:(i,r,l)=>{const c=h(t).nodeLookup.get(i)?.internals.userNode;if(!c)return;const d=typeof r=="function"?r(c):r;o(i,a=>({...a,data:l?.replace?d:{...a.data,...d}}))},updateEdge:n,getNodesBounds:i=>Ls(i,{nodeLookup:h(t).nodeLookup,nodeOrigin:h(t).nodeOrigin}),getHandleConnections:({type:i,id:r,nodeId:l})=>Array.from(h(t).connectionLookup.get(`${l}-${i}-${r??null}`)?.values()??[])}}function Mr(t,e){const o=[];for(const n of e){const s=t.get(n);if(s){const i="internals"in s?s.internals?.userNode:s;o.push(i)}}return o}function Tl(t,e){ne(e,!0);let o=Z(e,"store",15),n=Z(e,"selectionKey",3,"Shift"),s=Z(e,"multiSelectionKey",19,()=>Tt()?"Meta":"Control"),i=Z(e,"deleteKey",3,"Backspace"),r=Z(e,"panActivationKey",3," "),l=Z(e,"zoomActivationKey",19,()=>Tt()?"Meta":"Control"),{deleteElements:c}=Dl();function d(_){return _!==null&&typeof _=="object"}function a(_){return d(_)?_.modifier||[]:[]}function u(_){return _==null?"":d(_)?_.key:_}function f(_,y){return(Array.isArray(_)?_:[_]).map(p=>{const O=u(p);return{key:O,modifier:a(p),enabled:O!==null,callback:y}})}function g(){o(o().selectionRect=null,!0),o(o().selectionKeyPressed=!1,!0),o(o().multiselectionKeyPressed=!1,!0),o(o().deleteKeyPressed=!1,!0),o(o().panActivationKeyPressed=!1,!0),o(o().zoomActivationKeyPressed=!1,!0)}function b(){const _=o().nodes.filter(w=>w.selected),y=o().edges.filter(w=>w.selected);c({nodes:_,edges:y})}St("blur",Ee,g),St("contextmenu",Ee,g),xe(Ee,(_,y)=>Oe?.(_,y),()=>({trigger:f(n(),()=>o(o().selectionKeyPressed=!0,!0)),type:"keydown"})),xe(Ee,(_,y)=>Oe?.(_,y),()=>({trigger:f(n(),()=>o(o().selectionKeyPressed=!1,!0)),type:"keyup"})),xe(Ee,(_,y)=>Oe?.(_,y),()=>({trigger:f(s(),()=>{o(o().multiselectionKeyPressed=!0,!0)}),type:"keydown"})),xe(Ee,(_,y)=>Oe?.(_,y),()=>({trigger:f(s(),()=>o(o().multiselectionKeyPressed=!1,!0)),type:"keyup"})),xe(Ee,(_,y)=>Oe?.(_,y),()=>({trigger:f(i(),_=>{!(_.originalEvent.ctrlKey||_.originalEvent.metaKey||_.originalEvent.shiftKey)&&!Ur(_.originalEvent)&&(o(o().deleteKeyPressed=!0,!0),b())}),type:"keydown"})),xe(Ee,(_,y)=>Oe?.(_,y),()=>({trigger:f(i(),()=>o(o().deleteKeyPressed=!1,!0)),type:"keyup"})),xe(Ee,(_,y)=>Oe?.(_,y),()=>({trigger:f(r(),()=>o(o().panActivationKeyPressed=!0,!0)),type:"keydown"})),xe(Ee,(_,y)=>Oe?.(_,y),()=>({trigger:f(r(),()=>o(o().panActivationKeyPressed=!1,!0)),type:"keyup"})),xe(Ee,(_,y)=>Oe?.(_,y),()=>({trigger:f(l(),()=>o(o().zoomActivationKeyPressed=!0,!0)),type:"keydown"})),xe(Ee,(_,y)=>Oe?.(_,y),()=>({trigger:f(l(),()=>o(o().zoomActivationKeyPressed=!1,!0)),type:"keyup"})),oe()}var zl=ve('<path fill="none" class="svelte-flow__connection-path"></path>'),Al=ve('<svg class="svelte-flow__connectionline"><g><!></g></svg>');function Rl(t,e){ne(e,!0);let o=k(()=>{if(!e.store.connection.inProgress)return"";const r={sourceX:e.store.connection.from.x,sourceY:e.store.connection.from.y,sourcePosition:e.store.connection.fromPosition,targetX:e.store.connection.to.x,targetY:e.store.connection.to.y,targetPosition:e.store.connection.toPosition};switch(e.type){case Le.Bezier:{const[l]=Jr(r);return l}case Le.Straight:{const[l]=ei(r);return l}case Le.Step:case Le.SmoothStep:{const[l]=so({...r,borderRadius:e.type===Le.Step?0:void 0});return l}}});var n=ke(),s=ce(n);{var i=r=>{var l=Al(),c=J(l),d=J(c);{var a=f=>{var g=ke(),b=ce(g);eo(b,()=>e.LineComponent,(_,y)=>{y(_,{})}),W(f,g)},u=f=>{var g=zl();ue(()=>{ie(g,"d",h(o)),Ie(g,e.style)}),W(f,g)};he(d,f=>{e.LineComponent?f(a):f(u,!1)})}U(c),U(l),ue(f=>{ie(l,"width",e.store.width),ie(l,"height",e.store.height),Ie(l,e.containerStyle),je(c,0,f)},[()=>at(["svelte-flow__connection",As(e.store.connection.isValid)])]),W(r,l)};he(s,r=>{e.store.connection.inProgress&&r(i)})}W(t,n),oe()}var Ll=se("<div><!></div>");function yi(t,e){ne(e,!0);let o=Z(e,"position",3,"top-right"),n=Ke(e,["$$slots","$$events","$$legacy","position","style","class","children"]),s=k(()=>`${o()}`.split("-"));var i=Ll();He(i,l=>({class:l,style:e.style,...n}),[()=>["svelte-flow__panel",e.class,...h(s)]]);var r=J(i);Ce(r,()=>e.children??st),U(i),W(t,i),oe()}var Vl=se('<a href="https://svelteflow.dev" target="_blank" rel="noopener noreferrer" aria-label="Svelte Flow attribution">Svelte Flow</a>');function Hl(t,e){ne(e,!0);let o=Z(e,"position",3,"bottom-right");var n=ke(),s=ce(n);{var i=r=>{yi(r,{get position(){return o()},class:"svelte-flow__attribution","data-message":"Feel free to remove the attribution or check out how you could support us: https://svelteflow.dev/support-us",children:(l,c)=>{var d=Vl();W(l,d)},$$slots:{default:!0}})};he(s,r=>{e.proOptions?.hideAttribution||r(i)})}W(t,n),oe()}var jl=se("<div><!></div>");function Bl(t,e){ne(e,!0);let o=Z(e,"domNode",15),n=Z(e,"clientWidth",15),s=Z(e,"clientHeight",15),i=k(()=>e.rest.class),r=k(()=>ki(e.rest,["id","class","nodeTypes","edgeTypes","colorMode","isValidConnection","onmove","onmovestart","onmoveend","onflowerror","ondelete","onbeforedelete","onbeforeconnect","onconnect","onconnectstart","onconnectend","onbeforereconnect","onreconnect","onreconnectstart","onreconnectend","onclickconnectstart","onclickconnectend","oninit","onselectionchange","onselectiondragstart","onselectiondrag","onselectiondragstop","onselectionstart","onselectionend","clickConnect","fitView","fitViewOptions","nodeOrigin","nodeDragThreshold","connectionDragThreshold","minZoom","maxZoom","initialViewport","connectionRadius","connectionMode","selectionMode","selectNodesOnDrag","snapGrid","defaultMarkerColor","translateExtent","nodeExtent","onlyRenderVisibleElements","autoPanOnConnect","autoPanOnNodeDrag","colorModeSSR","defaultEdgeOptions","elevateNodesOnSelect","elevateEdgesOnSelect","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","elementsSelectable","nodesFocusable","edgesFocusable","disableKeyboardA11y","noDragClass","noPanClass","noWheelClass","ariaLabelConfig","autoPanSpeed","panOnScrollSpeed"]));function l(a){a.currentTarget.scrollTo({top:0,left:0,behavior:"auto"}),e.rest.onscroll&&e.rest.onscroll(a)}var c=jl();He(c,a=>({class:["svelte-flow","svelte-flow__container",h(i),e.colorMode],"data-testid":"svelte-flow__wrapper",role:"application",onscroll:l,...h(r),[At]:a}),[()=>({width:De(e.width),height:De(e.height)})],void 0,"svelte-1e4fism");var d=J(c);Ce(d,()=>e.children??st),U(c),pt(c,a=>o(a),()=>o()),ho(c,"clientHeight",s),ho(c,"clientWidth",n),W(t,c),oe()}var ql=se('<div class="svelte-flow__viewport-back svelte-flow__container"></div> <!> <div class="svelte-flow__edge-labels svelte-flow__container"></div> <!> <!> <!> <div class="svelte-flow__viewport-front svelte-flow__container"></div>',1),Fl=se("<!> <!>",1),Kl=se("<!> <!> <!> <!> <!>",1);function Yl(t,e){ne(e,!0);let o=Z(e,"paneClickDistance",3,1),n=Z(e,"nodeClickDistance",3,1),s=Z(e,"panOnScrollMode",19,()=>$e.Free),i=Z(e,"preventScrolling",3,!0),r=Z(e,"zoomOnScroll",3,!0),l=Z(e,"zoomOnDoubleClick",3,!0),c=Z(e,"zoomOnPinch",3,!0),d=Z(e,"panOnScroll",3,!1),a=Z(e,"panOnScrollSpeed",3,.5),u=Z(e,"panOnDrag",3,!0),f=Z(e,"selectionOnDrag",3,!0),g=Z(e,"connectionLineType",19,()=>Le.Bezier),b=Z(e,"nodes",31,()=>fo([])),_=Z(e,"edges",31,()=>fo([])),y=Z(e,"viewport",15,void 0),w=Ke(e,["$$slots","$$events","$$legacy","width","height","proOptions","selectionKey","deleteKey","panActivationKey","multiSelectionKey","zoomActivationKey","paneClickDistance","nodeClickDistance","onmovestart","onmoveend","onmove","oninit","onnodeclick","onnodecontextmenu","onnodedrag","onnodedragstart","onnodedragstop","onnodepointerenter","onnodepointermove","onnodepointerleave","onselectionclick","onselectioncontextmenu","onselectionstart","onselectionend","onedgeclick","onedgecontextmenu","onedgepointerenter","onedgepointerleave","onpaneclick","onpanecontextmenu","panOnScrollMode","preventScrolling","zoomOnScroll","zoomOnDoubleClick","zoomOnPinch","panOnScroll","panOnScrollSpeed","panOnDrag","selectionOnDrag","connectionLineComponent","connectionLineStyle","connectionLineContainerStyle","connectionLineType","attributionPosition","children","nodes","edges","viewport"]),p=el({props:w,width:e.width,height:e.height,get nodes(){return b()},set nodes(x){b(x)},get edges(){return _()},set edges(x){_(x)},get viewport(){return y()},set viewport(x){y(x)}});const O=ut(Qn);O&&O.setStore&&O.setStore(p),Pt(Qn,{provider:!1,getStore(){return p}}),Be(()=>{const x={nodes:p.selectedNodes,edges:p.selectedEdges};ct(()=>e.onselectionchange)?.(x);for(const T of p.selectionChangeHandlers.values())T(x)}),Jn(()=>{p.reset()}),Bl(t,{get colorMode(){return p.colorMode},get width(){return e.width},get height(){return e.height},get rest(){return w},get domNode(){return p.domNode},set domNode(x){p.domNode=x},get clientWidth(){return p.width},set clientWidth(x){p.width=x},get clientHeight(){return p.height},set clientHeight(x){p.height=x},children:(x,T)=>{var S=Kl(),M=ce(S);Tl(M,{get selectionKey(){return e.selectionKey},get deleteKey(){return e.deleteKey},get panActivationKey(){return e.panActivationKey},get multiSelectionKey(){return e.multiSelectionKey},get zoomActivationKey(){return e.zoomActivationKey},get store(){return p},set store(m){p=m}});var E=ee(M,2);ol(E,{get panOnScrollMode(){return s()},get preventScrolling(){return i()},get zoomOnScroll(){return r()},get zoomOnDoubleClick(){return l()},get zoomOnPinch(){return c()},get panOnScroll(){return d()},get panOnScrollSpeed(){return a()},get panOnDrag(){return u()},get paneClickDistance(){return o()},get onmovestart(){return e.onmovestart},get onmove(){return e.onmove},get onmoveend(){return e.onmoveend},get oninit(){return e.oninit},get store(){return p},set store(m){p=m},children:(m,N)=>{il(m,{get onpaneclick(){return e.onpaneclick},get onpanecontextmenu(){return e.onpanecontextmenu},get onselectionstart(){return e.onselectionstart},get onselectionend(){return e.onselectionend},get panOnDrag(){return u()},get selectionOnDrag(){return f()},get store(){return p},set store(v){p=v},children:(v,I)=>{var P=Fl(),V=ce(P);al(V,{get store(){return p},set store(j){p=j},children:(j,q)=>{var Y=ql(),X=ee(ce(Y),2);Cl(X,{get onedgeclick(){return e.onedgeclick},get onedgecontextmenu(){return e.onedgecontextmenu},get onedgepointerenter(){return e.onedgepointerenter},get onedgepointerleave(){return e.onedgepointerleave},get store(){return p},set store(H){p=H}});var D=ee(X,4);Rl(D,{get type(){return g()},get LineComponent(){return e.connectionLineComponent},get containerStyle(){return e.connectionLineContainerStyle},get style(){return e.connectionLineStyle},get store(){return p},set store(H){p=H}});var A=ee(D,2);ml(A,{get nodeClickDistance(){return n()},get onnodeclick(){return e.onnodeclick},get onnodecontextmenu(){return e.onnodecontextmenu},get onnodepointerenter(){return e.onnodepointerenter},get onnodepointermove(){return e.onnodepointermove},get onnodepointerleave(){return e.onnodepointerleave},get onnodedrag(){return e.onnodedrag},get onnodedragstart(){return e.onnodedragstart},get onnodedragstop(){return e.onnodedragstop},get store(){return p},set store(H){p=H}});var L=ee(A,2);Ml(L,{get onselectionclick(){return e.onselectionclick},get onselectioncontextmenu(){return e.onselectioncontextmenu},get onnodedrag(){return e.onnodedrag},get onnodedragstart(){return e.onnodedragstart},get onnodedragstop(){return e.onnodedragstop},get store(){return p},set store(H){p=H}}),et(2),W(j,Y)},$$slots:{default:!0}});var B=ee(V,2);{let j=k(()=>!!(p.selectionRect&&p.selectionRectMode==="user")),q=k(()=>p.selectionRect?.width),Y=k(()=>p.selectionRect?.height),X=k(()=>p.selectionRect?.x),D=k(()=>p.selectionRect?.y);pi(B,{get isVisible(){return h(j)},get width(){return h(q)},get height(){return h(Y)},get x(){return h(X)},get y(){return h(D)}})}W(v,P)},$$slots:{default:!0}})},$$slots:{default:!0}});var C=ee(E,2);Hl(C,{get proOptions(){return e.proOptions},get position(){return e.attributionPosition}});var z=ee(C,2);cl(z,{get store(){return p}});var R=ee(z,2);Ce(R,()=>e.children??st),W(x,S)},$$slots:{default:!0}}),oe()}var Gl=se("<button><!></button>");function kt(t,e){let o=Ke(e,["$$slots","$$events","$$legacy","class","bgColor","bgColorHover","color","colorHover","borderColor","onclick","children"]);var n=Gl();He(n,i=>({type:"button",onclick:e.onclick,class:["svelte-flow__controls-button",e.class],...o,[At]:i}),[()=>({"--xy-controls-button-background-color-props":e.bgColor,"--xy-controls-button-background-color-hover-props":e.bgColorHover,"--xy-controls-button-color-props":e.color,"--xy-controls-button-color-hover-props":e.colorHover,"--xy-controls-button-border-color-props":e.borderColor})]);var s=J(n);Ce(s,()=>e.children??st),U(n),W(t,n)}var Zl=ve('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"></path></svg>');function Wl(t){var e=Zl();W(t,e)}var Xl=ve('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 5"><path d="M0 0h32v4.2H0z"></path></svg>');function Ul(t){var e=Xl();W(t,e)}var Ql=ve('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 30"><path d="M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"></path></svg>');function Jl(t){var e=Ql();W(t,e)}var $l=ve('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 32"><path d="M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"></path></svg>');function ed(t){var e=$l();W(t,e)}var td=ve('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 32"><path d="M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"></path></svg>');function nd(t){var e=td();W(t,e)}var od=se("<!> <!>",1),rd=se("<!> <!> <!> <!> <!> <!>",1);function id(t,e){ne(e,!0);let o=Z(e,"position",3,"bottom-left"),n=Z(e,"orientation",3,"vertical"),s=Z(e,"showZoom",3,!0),i=Z(e,"showFitView",3,!0),r=Z(e,"showLock",3,!0),l=Ke(e,["$$slots","$$events","$$legacy","position","orientation","showZoom","showFitView","showLock","style","class","buttonBgColor","buttonBgColorHover","buttonColor","buttonColorHover","buttonBorderColor","fitViewOptions","children","before","after"]),c=k(Ge);const d={bgColor:e.buttonBgColor,bgColorHover:e.buttonBgColorHover,color:e.buttonColor,colorHover:e.buttonColorHover,borderColor:e.buttonBorderColor};let a=k(()=>h(c).nodesDraggable||h(c).nodesConnectable||h(c).elementsSelectable),u=k(()=>h(c).viewport.zoom<=h(c).minZoom),f=k(()=>h(c).viewport.zoom>=h(c).maxZoom),g=k(()=>h(c).ariaLabelConfig),b=k(()=>n()==="horizontal"?"horizontal":"vertical");const _=()=>{h(c).zoomIn()},y=()=>{h(c).zoomOut()},w=()=>{h(c).fitView(e.fitViewOptions)},p=()=>{let O=!h(a);h(c).nodesDraggable=O,h(c).nodesConnectable=O,h(c).elementsSelectable=O};{let O=k(()=>["svelte-flow__controls",h(b),e.class]);yi(t,Ue({get class(){return h(O)},get position(){return o()},"data-testid":"svelte-flow__controls",get"aria-label"(){return h(g)["controls.ariaLabel"]},get style(){return e.style}},()=>l,{children:(x,T)=>{var S=rd(),M=ce(S);{var E=j=>{var q=ke(),Y=ce(q);Ce(Y,()=>e.before),W(j,q)};he(M,j=>{e.before&&j(E)})}var C=ee(M,2);{var z=j=>{var q=od(),Y=ce(q);kt(Y,Ue({onclick:_,class:"svelte-flow__controls-zoomin",get title(){return h(g)["controls.zoomIn.ariaLabel"]},get"aria-label"(){return h(g)["controls.zoomIn.ariaLabel"]},get disabled(){return h(f)}},()=>d,{children:(D,A)=>{Wl(D)},$$slots:{default:!0}}));var X=ee(Y,2);kt(X,Ue({onclick:y,class:"svelte-flow__controls-zoomout",get title(){return h(g)["controls.zoomOut.ariaLabel"]},get"aria-label"(){return h(g)["controls.zoomOut.ariaLabel"]},get disabled(){return h(u)}},()=>d,{children:(D,A)=>{Ul(D)},$$slots:{default:!0}})),W(j,q)};he(C,j=>{s()&&j(z)})}var R=ee(C,2);{var m=j=>{kt(j,Ue({class:"svelte-flow__controls-fitview",onclick:w,get title(){return h(g)["controls.fitView.ariaLabel"]},get"aria-label"(){return h(g)["controls.fitView.ariaLabel"]}},()=>d,{children:(q,Y)=>{Jl(q)},$$slots:{default:!0}}))};he(R,j=>{i()&&j(m)})}var N=ee(R,2);{var v=j=>{kt(j,Ue({class:"svelte-flow__controls-interactive",onclick:p,get title(){return h(g)["controls.interactive.ariaLabel"]},get"aria-label"(){return h(g)["controls.interactive.ariaLabel"]}},()=>d,{children:(q,Y)=>{var X=ke(),D=ce(X);{var A=H=>{nd(H)},L=H=>{ed(H)};he(D,H=>{h(a)?H(A):H(L,!1)})}W(q,X)},$$slots:{default:!0}}))};he(N,j=>{r()&&j(v)})}var I=ee(N,2);{var P=j=>{var q=ke(),Y=ce(q);Ce(Y,()=>e.children),W(j,q)};he(I,j=>{e.children&&j(P)})}var V=ee(I,2);{var B=j=>{var q=ke(),Y=ce(q);Ce(Y,()=>e.after),W(j,q)};he(V,j=>{e.after&&j(B)})}W(x,S)},$$slots:{default:!0}}))}oe()}var Ve;(function(t){t.Lines="lines",t.Dots="dots",t.Cross="cross"})(Ve||(Ve={}));var sd=ve("<circle></circle>");function ad(t,e){var o=sd();ue(()=>{ie(o,"cx",e.radius),ie(o,"cy",e.radius),ie(o,"r",e.radius),je(o,0,at(["svelte-flow__background-pattern","dots",e.class]))}),W(t,o)}var ld=ve("<path></path>");function dd(t,e){ne(e,!0);var o=ld();ue(()=>{ie(o,"stroke-width",e.lineWidth),ie(o,"d",`M${e.dimensions[0]/2} 0 V${e.dimensions[1]} M0 ${e.dimensions[1]/2} H${e.dimensions[0]}`),je(o,0,at(["svelte-flow__background-pattern",e.variant,e.class]))}),W(t,o),oe()}const cd={[Ve.Dots]:1,[Ve.Lines]:1,[Ve.Cross]:6};var ud=ve('<svg data-testid="svelte-flow__background"><pattern patternUnits="userSpaceOnUse"><!></pattern><rect x="0" y="0" width="100%" height="100%"></rect></svg>');function fd(t,e){ne(e,!0);let o=Z(e,"variant",19,()=>Ve.Dots),n=Z(e,"gap",3,20),s=Z(e,"lineWidth",3,1),i=k(Ge),r=k(()=>o()===Ve.Dots),l=k(()=>o()===Ve.Cross),c=k(()=>Array.isArray(n())?n():[n(),n()]),d=k(()=>`background-pattern-${h(i).flowId}-${e.id??""}`),a=k(()=>[h(c)[0]*h(i).viewport.zoom||1,h(c)[1]*h(i).viewport.zoom||1]),u=k(()=>(e.size??cd[o()])*h(i).viewport.zoom),f=k(()=>h(l)?[h(u),h(u)]:h(a)),g=k(()=>h(r)?[h(u)/2,h(u)/2]:[h(f)[0]/2,h(f)[1]/2]);var b=ud();let _;var y=J(b),w=J(y);{var p=T=>{{let S=k(()=>h(u)/2);ad(T,{get radius(){return h(S)},get class(){return e.patternClass}})}},O=T=>{dd(T,{get dimensions(){return h(f)},get variant(){return o()},get lineWidth(){return s()},get class(){return e.patternClass}})};he(w,T=>{h(r)?T(p):T(O,!1)})}U(y);var x=ee(y);U(b),ue(T=>{je(b,0,at(["svelte-flow__background","svelte-flow__container",e.class])),_=Ie(b,"",_,T),ie(y,"id",h(d)),ie(y,"x",h(i).viewport.x%h(a)[0]),ie(y,"y",h(i).viewport.y%h(a)[1]),ie(y,"width",h(a)[0]),ie(y,"height",h(a)[1]),ie(y,"patternTransform",`translate(-${h(g)[0]},-${h(g)[1]})`),ie(x,"fill",`url(#${h(d)})`)},[()=>({"--xy-background-color-props":e.bgColor,"--xy-background-pattern-color-props":e.patternColor})]),W(t,b),oe()}var hd=se('<div><div class="flex flex-col"><div class="flex items-center gap-3 border-b p-6 pb-4"><div class="flex flex-col gap-1"><div class="text-lg font-semibold leading-none tracking-tight"> </div> <div class="text-muted-foreground text-xs"> </div></div></div> <div class="p-6 pt-4"><div class="mb-3 flex items-center gap-2 text-sm"><span class="text-muted-foreground font-medium">Model:</span> <span class="bg-muted rounded px-2 py-1 font-mono text-xs"> </span></div> <div class="mt-3 flex gap-4"><div class="bg-muted/50 flex flex-1 flex-col items-center rounded-lg px-3 py-3"><span class="text-2xl font-bold leading-none"> </span> <span class="text-muted-foreground mt-1 text-[11px] uppercase tracking-wider">Tools</span></div> <div class="bg-muted/50 flex flex-1 flex-col items-center rounded-lg px-3 py-3"><span class="text-2xl font-bold leading-none"> </span> <span class="text-muted-foreground mt-1 text-[11px] uppercase tracking-wider">Sub-agents</span></div></div></div></div></div> <!> <!>',1);function gd(t,e){ne(e,!0);const o=e.data.level??0,n=["border-primary/30 border-2","border-purple-500 border-2","border-pink-500 border-2","border-green-500 border-2"],s=["bg-card","bg-purple-950/30","bg-pink-950/30","bg-green-950/30"],i=n[o]||n[n.length-1],r=s[o]||s[s.length-1],l=o===0?"Root Agent":`Sub-Agent (L${o})`;var c=hd(),d=ce(c),a=J(d),u=J(a),f=J(u),g=J(f),b=J(g,!0);U(g);var _=ee(g,2),y=J(_,!0);U(_),U(f),U(u);var w=ee(u,2),p=J(w),O=ee(J(p),2),x=J(O,!0);U(O),U(p);var T=ee(p,2),S=J(T),M=J(S),E=J(M,!0);U(M),et(2),U(S);var C=ee(S,2),z=J(C),R=J(z,!0);U(z),et(2),U(C),U(T),U(w),U(a),U(d);var m=ee(d,2);Fe(m,{type:"source",get position(){return $.Bottom},get isConnectable(){return e.isConnectable}});var N=ee(m,2);Fe(N,{type:"target",get position(){return $.Top},get isConnectable(){return e.isConnectable}}),ue(()=>{je(d,1,`text-card-foreground ${r??""} h-full w-full rounded-lg ${i??""} shadow-sm`),pe(b,e.data.label),pe(y,l),pe(x,e.data.model),pe(E,e.data.toolCount),pe(R,e.data.subAgentCount)}),W(t,c),oe()}var md=se('<div class="text-muted-foreground mb-3 border-b pb-3 text-xs leading-relaxed"> </div>'),vd=se('<span class="bg-muted rounded px-2 py-0.5 font-mono text-xs"> </span>'),pd=se('<div class="flex flex-col gap-1 text-sm"><span class="text-muted-foreground font-medium">Required:</span> <div class="flex flex-wrap gap-1"></div></div>'),yd=se('<div class="flex items-center justify-between text-sm"><span class="text-muted-foreground font-medium">Required:</span> <span class="bg-muted rounded px-2 py-0.5 font-mono text-xs">None</span></div>'),bd=se('<div class="bg-card text-card-foreground h-full w-[280px] rounded-lg border border-orange-500/50 shadow-sm"><div class="flex flex-col"><div class="flex items-center gap-3 border-b p-4 pb-3"><div class="text-xl">🔧</div> <div class="flex-1"><div class="text-base font-semibold leading-none tracking-tight"> </div></div></div> <div class="p-4 pt-3"><!> <div class="flex flex-col gap-2"><div class="flex items-center justify-between text-sm"><span class="text-muted-foreground font-medium">Parameters:</span> <span class="bg-primary text-primary-foreground rounded-full px-2.5 py-0.5 text-xs font-bold"> </span></div> <!></div></div></div></div> <!>',1);function wd(t,e){ne(e,!0);const o=e.data.requiredParams||[];o.length>0&&o.join(", ");const n=e.data.description||"",s=n.trim().length>0;var i=bd(),r=ce(i),l=J(r),c=J(l),d=ee(J(c),2),a=J(d),u=J(a,!0);U(a),U(d),U(c);var f=ee(c,2),g=J(f);{var b=M=>{var E=md(),C=J(E,!0);U(E),ue(()=>pe(C,n)),W(M,E)};he(g,M=>{s&&M(b)})}var _=ee(g,2),y=J(_),w=ee(J(y),2),p=J(w,!0);U(w),U(y);var O=ee(y,2);{var x=M=>{var E=pd(),C=ee(J(E),2);Rt(C,21,()=>o,Pi,(z,R)=>{var m=vd(),N=J(m,!0);U(m),ue(()=>pe(N,h(R))),W(z,m)}),U(C),U(E),W(M,E)},T=M=>{var E=yd();W(M,E)};he(O,M=>{o.length>0?M(x):M(T,!1)})}U(_),U(f),U(l),U(r);var S=ee(r,2);Fe(S,{type:"target",get position(){return $.Top},get isConnectable(){return e.isConnectable}}),ue(()=>{pe(u,e.data.label),pe(p,e.data.paramCount)}),W(t,i),oe()}var xd=se("<!> <!>",1);function Md(t,e){ne(e,!0);let o=fe([]),n=fe([]),s="dark",i=fe(null),r=0,l=0;const c=320,d=200,a=280,u=180;function f(w){return w?.required||[]}function g(w){return Object.keys(w?.properties||{}).length}const b={agent:gd,tool:wd};function _(w,p,O=0,x=null){const T=[],S=[],M={id:p,position:{x:0,y:0},data:{label:w.name,model:w.model,toolCount:w.tools.length,subAgentCount:w.sub_agents.length,level:O},type:"agent"};return T.push(M),x&&S.push({id:`e-${x}-${p}`,source:x,target:p,animated:!0,type:"smoothstep",style:"stroke-width: 2px; stroke: #8b5cf6",markerEnd:{type:nt.ArrowClosed,width:20,height:20,color:"#8b5cf6"}}),w.tools.forEach(E=>{const C=`tool-${p}-${r++}`,z=g(E.function.parameters),R=f(E.function.parameters),m={id:C,position:{x:0,y:0},data:{label:E.function.name,description:E.function.description,paramCount:z,requiredParams:R,parameters:E.function.parameters},type:"tool"};T.push(m),S.push({id:`e-${p}-${C}`,source:p,target:C,animated:!0,type:"smoothstep",style:"stroke-width: 1.5px; stroke: #6b7280",markerEnd:{type:nt.ArrowClosed,width:20,height:20,color:"#FF4000"}})}),w.sub_agents.forEach(E=>{const C=`agent-${l++}`,z=_(E,C,O+1,p);T.push(...z.nodes),S.push(...z.edges)}),{nodes:T,edges:S}}function y(w,p,O="TB"){const x=new ar.graphlib.Graph;return x.setDefaultEdgeLabel(()=>({})),x.setGraph({rankdir:O,nodesep:100,ranksep:200}),w.forEach(S=>{const M=S.type==="agent"?c:a,E=S.type==="agent"?d:u;x.setNode(S.id,{width:M,height:E})}),p.forEach(S=>{x.setEdge(S.source,S.target)}),ar.layout(x),{nodes:w.map(S=>{const M=x.node(S.id),E=S.type==="agent"?c:a,C=S.type==="agent"?d:u;return S.targetPosition=$.Top,S.sourcePosition=$.Bottom,{...S,position:{x:M.x-E/2,y:M.y-C/2}}}),edges:p}}Ci(async()=>{try{const w=await fetch("/api/agent/info");if(!w.ok)throw new Error("Failed to fetch agent info");const p=await w.json();r=0,l=0;const{nodes:O,edges:x}=_(p,"root-agent",0,null),{nodes:T,edges:S}=y(O,x);K(o,T),K(n,S)}catch(w){K(i,w instanceof Error?w.message:"An error occurred",!0)}}),Yl(t,{get nodeTypes(){return b},colorMode:s,fitView:!0,get nodes(){return h(o)},set nodes(w){K(o,w)},get edges(){return h(n)},set edges(w){K(n,w)},children:(w,p)=>{var O=xd(),x=ce(O);fd(x,{});var T=ee(x,2);id(T,{}),W(w,O)},$$slots:{default:!0}}),oe()}export{Md as component};
